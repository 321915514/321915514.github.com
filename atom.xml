<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>philxling</title>
  <icon>https://www.gravatar.com/avatar/295a5284129a41f836e900ffd2bcd96b</icon>
  <subtitle>Sometimes,Nowhere means &quot;Now&quot;&quot;Here&quot;</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://philxling.club/"/>
  <updated>2023-04-06T06:32:57.685Z</updated>
  <id>http://philxling.club/</id>
  
  <author>
    <name>philxling</name>
    <email>321915514wx@gmail.com</email>
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>TypeScript面向对象</title>
    <link href="http://philxling.club/2023/04/06/%E5%89%8D%E7%AB%AF/ts%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/"/>
    <id>http://philxling.club/2023/04/06/%E5%89%8D%E7%AB%AF/ts%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/</id>
    <published>2023-04-06T04:05:25.000Z</published>
    <updated>2023-04-06T06:32:57.685Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="第二章：面向对象"><a href="#第二章：面向对象" class="headerlink" title="第二章：面向对象"></a>第二章：面向对象</h1><p>面向对象是程序中一个非常重要的思想，它被很多同学理解成了一个比较难，比较深奥的问题，其实不然。面向对象很简单，简而言之就是程序之中所有的操作都需要通过对象来完成。</p><a id="more"></a><ul><li>举例来说：<ul><li>操作浏览器要使用window对象</li><li>操作网页要使用document对象</li><li>操作控制台要使用console对象</li></ul></li></ul><p>一切操作都要通过对象，也就是所谓的面向对象，那么对象到底是什么呢？这就要先说到程序是什么，计算机程序的本质就是对现实事物的抽象，抽象的反义词是具体，比如：照片是对一个具体的人的抽象，汽车模型是对具体汽车的抽象等等。程序也是对事物的抽象，在程序中我们可以表示一个人、一条狗、一把枪、一颗子弹等等所有的事物。一个事物到了程序中就变成了一个对象。</p><p>在程序中所有的对象都被分成了两个部分数据和功能，以人为例，人的姓名、性别、年龄、身高、体重等属于数据，人可以说话、走路、吃饭、睡觉这些属于人的功能。数据在对象中被成为属性，而功能就被称为方法。所以简而言之，在程序中一切皆是对象。</p><h2 id="1、类（class）"><a href="#1、类（class）" class="headerlink" title="1、类（class）"></a>1、类（class）</h2><p>要想面向对象，操作对象，首先便要拥有对象，那么下一个问题就是如何创建对象。要创建对象，必须要先定义类，所谓的类可以理解为对象的模型，程序中可以根据类创建指定类型的对象，举例来说：可以通过Person类来创建人的对象，通过Dog类创建狗的对象，通过Car类来创建汽车的对象，不同的类可以用来创建不同的对象。</p><ul><li><p>定义类：</p><ul><li><pre><code class="typescript"><span class="keyword">class</span> 类名 {    属性名: 类型;    <span class="keyword">constructor</span>(<span class="params">参数: 类型</span>){        <span class="keyword">this</span>.属性名 = 参数;    }    方法名(){        ....    }}<!--￼<span class="number">0</span>--></code></pre></li></ul></li><li><p>使用类：</p><ul><li><pre><code class="typescript"><span class="keyword">const</span> p = <span class="keyword">new</span> Person(<span class="string">'孙悟空'</span>, <span class="number">18</span>);p.sayHello();<!--￼<span class="number">1</span>-->- <span class="keyword">protected</span>  - <span class="string">``</span><span class="string">`typescript</span><span class="string">    class Person{</span><span class="string">        protected name: string;</span><span class="string">        protected age: number;</span><span class="string"></span><span class="string">        constructor(name: string, age: number){</span><span class="string">            this.name = name; // 可以修改</span><span class="string">            this.age = age;</span><span class="string">        }</span><span class="string"></span><span class="string">        sayHello(){</span><span class="string">            console.log(`</span>大家好，我是${<span class="keyword">this</span>.name}<span class="string">`);</span><span class="string">        }</span><span class="string">    }</span><span class="string"></span><span class="string">    class Employee extends Person{</span><span class="string"></span><span class="string">        constructor(name: string, age: number){</span><span class="string">            super(name, age);</span><span class="string">            this.name = name; //子类中可以修改</span><span class="string">        }</span><span class="string">    }</span><span class="string"></span><span class="string">    const p = new Person('孙悟空', 18);</span><span class="string">    p.name = '猪八戒';// 不能修改</span><span class="string">    <figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- private</span><br><span class="line"></span><br><span class="line">  - ```typescript</span><br><span class="line">    class Person{</span><br><span class="line">        private name: string;</span><br><span class="line">        private age: number;</span><br><span class="line">    </span><br><span class="line">        constructor(name: string, age: number){</span><br><span class="line">            this.name = name; // 可以修改</span><br><span class="line">            this.age = age;</span><br><span class="line">        }</span><br><span class="line">    </span><br><span class="line">        sayHello(){</span><br><span class="line">            console.log(`大家好，我是${this.name}`);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    class Employee extends Person{</span><br><span class="line">    </span><br><span class="line">        constructor(name: string, age: number){</span><br><span class="line">            super(name, age);</span><br><span class="line">            this.name = name; //子类中不能修改</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    const p = new Person('孙悟空', 18);</span><br><span class="line">    p.name = '猪八戒';// 不能修改</span><br></pre></td></tr></tbody></table></figure></span></code></pre></li><li><p>属性存取器</p><ul><li><p>对于一些不希望被任意修改的属性，可以将其设置为private</p></li><li><p>直接将其设置为private将导致无法再通过对象修改其中的属性</p></li><li><p>我们可以在类中定义一组读取、设置属性的方法，这种对属性读取或设置的属性被称为属性的存取器</p></li><li><p>读取属性的方法叫做setter方法，设置属性的方法叫做getter方法</p></li><li><p>示例：</p><ul><li><pre><code class="typescript"><span class="keyword">class</span> Person{    <span class="keyword">private</span> _name: <span class="built_in">string</span>;    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span></span>){        <span class="keyword">this</span>._name = name;    }    <span class="keyword">get</span> name(){        <span class="keyword">return</span> <span class="keyword">this</span>._name;    }    <span class="keyword">set</span> name(name: <span class="built_in">string</span>){        <span class="keyword">this</span>._name = name;    }}<span class="keyword">const</span> p1 = <span class="keyword">new</span> Person(<span class="string">'孙悟空'</span>);<span class="built_in">console</span>.log(p1.name); <span class="comment">// 通过getter读取name属性</span>p1.name = <span class="string">'猪八戒'</span>; <span class="comment">// 通过setter修改name属性</span><!--￼<span class="number">3</span>--></code></pre></li></ul></li></ul></li><li><p>this</p><ul><li>在类中，使用this表示当前对象</li></ul></li></ul></li><li><p>继承</p><ul><li><p>继承时面向对象中的又一个特性</p></li><li><p>通过继承可以将其他类中的属性和方法引入到当前类中</p><ul><li><p>示例：</p><ul><li><pre><code class="typescript"><span class="keyword">class</span> Animal{    name: <span class="built_in">string</span>;    age: <span class="built_in">number</span>;    <span class="keyword">constructor</span>(<span class="params">name: <span class="built_in">string</span>, age: <span class="built_in">number</span></span>){        <span class="keyword">this</span>.name = name;        <span class="keyword">this</span>.age = age;    }}<span class="keyword">class</span> Dog <span class="keyword">extends</span> Animal{    bark(){        <span class="built_in">console</span>.log(<span class="string">`<span class="subst">${<span class="keyword">this</span>.name}</span>在汪汪叫！`</span>);    }}<span class="keyword">const</span> dog = <span class="keyword">new</span> Dog(<span class="string">'旺财'</span>, <span class="number">4</span>);dog.bark();<!--￼<span class="number">4</span>--></code></pre></li><li><p>在子类中可以使用super来完成对父类的引用</p></li></ul></li></ul></li><li><p>抽象类（abstract class）</p><ul><li><p>抽象类是专门用来被其他类所继承的类，它只能被其他类所继承不能用来创建实例</p></li><li><pre><code class="typescript"><span class="keyword">abstract</span> <span class="keyword">class</span> Animal{    <span class="keyword">abstract</span> run(): <span class="built_in">void</span>;    bark(){        <span class="built_in">console</span>.log(<span class="string">'动物在叫~'</span>);    }}<span class="keyword">class</span> Dog <span class="keyword">extends</span> Animals{    run(){        <span class="built_in">console</span>.log(<span class="string">'狗在跑~'</span>);    }}<!--￼<span class="number">5</span>--></code></pre></li></ul></li></ul></li><li><p>示例（实现）</p><ul><li><pre><code class="typescript"><span class="keyword">interface</span> Person{    name: <span class="built_in">string</span>;    sayHello():<span class="built_in">void</span>;}<span class="keyword">class</span> Student <span class="keyword">implements</span> Person{    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> name: <span class="built_in">string</span></span>) {    }    sayHello() {        <span class="built_in">console</span>.log(<span class="string">'大家好，我是'</span>+<span class="keyword">this</span>.name);    }}<!--￼<span class="number">6</span>--></code></pre></li><li><p>上例中，test函数有一个参数类型不确定，但是能确定的时其返回值的类型和参数的类型是相同的，由于类型不确定所以参数和返回值均使用了any，但是很明显这样做是不合适的，首先使用any会关闭TS的类型检查，其次这样设置也不能体现出参数和返回值是相同的类型</p></li><li><p>使用泛型：</p></li><li><pre><code class="typescript"><span class="function"><span class="keyword">function</span> <span class="title">test</span><<span class="title">T</span>>(<span class="params">arg: T</span>): <span class="title">T</span></span>{    <span class="keyword">return</span> arg;}<!--￼<span class="number">7</span>-->  - 使用时可以直接传递参数使用，类型会由TS自动推断出来，但有时编译器无法自动推断时还需要使用下面的方式- 方式二（指定类型）：  - <span class="string">``</span><span class="string">`typescript</span><span class="string">    test<number>(10)</span><span class="string">    <figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    - 也可以在函数后手动指定泛型</span><br><span class="line"></span><br><span class="line">- 可以同时指定多个泛型，泛型间使用逗号隔开：</span><br><span class="line"></span><br><span class="line">  - ```typescript</span><br><span class="line">    function test<T, K>(a: T, b: K): K{</span><br><span class="line">        return b;</span><br><span class="line">    }</span><br><span class="line">    </span><br><span class="line">    test<number, string>(10, "hello");</span><br></pre></td></tr></tbody></table></figure></span><span class="string"></span><span class="string">- 使用泛型时，完全可以将泛型当成是一个普通的类去使用</span></code></pre></li><li><p>类中同样可以使用泛型：</p><ul><li><pre><code class="typescript"><span class="keyword">class</span> MyClass<T>{    prop: T;    <span class="keyword">constructor</span>(<span class="params">prop: T</span>){        <span class="keyword">this</span>.prop = prop;    }}<!--￼<span class="number">9</span>--></code></pre></li><li><p>使用T extends MyInter表示泛型T必须是MyInter的子类，不一定非要使用接口类和抽象类同样适用。</p></li></ul></li></ul></li></ul></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;第二章：面向对象&quot;&gt;&lt;a href=&quot;#第二章：面向对象&quot; class=&quot;headerlink&quot; title=&quot;第二章：面向对象&quot;&gt;&lt;/a&gt;第二章：面向对象&lt;/h1&gt;&lt;p&gt;面向对象是程序中一个非常重要的思想，它被很多同学理解成了一个比较难，比较深奥的问题，其实不然。面向对象很简单，简而言之就是程序之中所有的操作都需要通过对象来完成。&lt;/p&gt;
    
    </summary>
    
    
      <category term="TypeScript" scheme="http://philxling.club/categories/TypeScript/"/>
    
    
      <category term="TypeScript" scheme="http://philxling.club/tags/TypeScript/"/>
    
  </entry>
  
  <entry>
    <title>TypeScript入门</title>
    <link href="http://philxling.club/2023/04/06/%E5%89%8D%E7%AB%AF/ts%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
    <id>http://philxling.club/2023/04/06/%E5%89%8D%E7%AB%AF/ts%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/</id>
    <published>2023-04-06T04:00:25.000Z</published>
    <updated>2023-04-06T06:32:37.426Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="第一章-快速入门"><a href="#第一章-快速入门" class="headerlink" title="第一章 快速入门"></a>第一章 快速入门</h1><h2 id="0、TypeScript简介"><a href="#0、TypeScript简介" class="headerlink" title="0、TypeScript简介"></a>0、TypeScript简介</h2><ol><li><p>TypeScript是JavaScript的超集。</p></li><li><p>它对JS进行了扩展，向JS中引入了类型的概念，并添加了许多新的特性。</p></li><li><p>TS代码需要通过编译器编译为JS，然后再交由JS解析器执行。</p></li></ol><a id="more"></a><ol start="4"><li><p>TS完全兼容JS，换言之，任何的JS代码都可以直接当成JS使用。</p></li><li><p>相较于JS而言，TS拥有了静态类型，更加严格的语法，更强大的功能；TS可以在代码执行前就完成代码的检查，减小了运行时异常的出现的几率；TS代码可以编译为任意版本的JS代码，可有效解决不同JS运行环境的兼容问题；同样的功能，TS的代码量要大于JS，但由于TS的代码结构更加清晰，变量类型更加明确，在后期代码的维护中TS却远远胜于JS。</p></li></ol><h2 id="1、TypeScript-开发环境搭建"><a href="#1、TypeScript-开发环境搭建" class="headerlink" title="1、TypeScript 开发环境搭建"></a>1、TypeScript 开发环境搭建</h2><ol><li><p>下载Node.js</p><ul><li>64位：<a href="https://nodejs.org/dist/v14.15.1/node-v14.15.1-x64.msi" target="_blank" rel="noopener">https://nodejs.org/dist/v14.15.1/node-v14.15.1-x64.msi</a></li><li>32位：<a href="https://nodejs.org/dist/v14.15.1/node-v14.15.1-x86.msi" target="_blank" rel="noopener">https://nodejs.org/dist/v14.15.1/node-v14.15.1-x86.msi</a></li></ul></li><li><p>安装Node.js</p></li><li><p>使用npm全局安装typescript</p><ul><li>进入命令行</li><li>输入：npm i -g typescript</li></ul></li><li><p>创建一个ts文件</p></li><li><p>使用tsc对ts文件进行编译</p><ul><li><p>进入命令行</p></li><li><p>进入ts文件所在目录</p></li><li><p>执行命令：tsc xxx.ts</p></li></ul></li></ol><h2 id="2、基本类型"><a href="#2、基本类型" class="headerlink" title="2、基本类型"></a>2、基本类型</h2><ul><li><p>类型声明</p><ul><li><p>类型声明是TS非常重要的一个特点</p></li><li><p>通过类型声明可以指定TS中变量（参数、形参）的类型</p></li><li><p>指定类型后，当为变量赋值时，TS编译器会自动检查值是否符合类型声明，符合则赋值，否则报错</p></li><li><p>简而言之，类型声明给变量设置了类型，使得变量只能存储某种类型的值</p></li><li><p>语法：</p><ul><li><pre><code class="typescript"><span class="keyword">let</span> 变量: 类型;<span class="keyword">let</span> 变量: 类型 = 值;<span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">参数: 类型, 参数: 类型</span>): 类型</span>{    ...}<!--￼<span class="number">0</span>--></code></pre></li></ul></li></ul></li><li><p>boolean</p><ul><li><pre><code class="typescript"><span class="keyword">let</span> isDone: <span class="built_in">boolean</span> = <span class="literal">false</span>;<!--￼<span class="number">1</span>--></code></pre></li></ul></li><li><p>字面量</p><ul><li><p>也可以使用字面量去指定变量的类型，通过字面量可以确定变量的取值范围</p></li><li><pre><code class="typescript"><span class="keyword">let</span> color: <span class="string">'red'</span> | <span class="string">'blue'</span> | <span class="string">'black'</span>;<span class="keyword">let</span> num: <span class="number">1</span> | <span class="number">2</span> | <span class="number">3</span> | <span class="number">4</span> | <span class="number">5</span>;<!--￼<span class="number">2</span>--></code></pre></li></ul></li><li><p>unknown</p><ul><li><pre><code class="typescript"><span class="keyword">let</span> notSure: unknown = <span class="number">4</span>;notSure = <span class="string">'hello'</span>;<!--￼<span class="number">3</span>--></code></pre></li></ul></li><li><p>never</p><ul><li><pre><code class="typescript"><span class="function"><span class="keyword">function</span> <span class="title">error</span>(<span class="params">message: <span class="built_in">string</span></span>): <span class="title">never</span> </span>{  <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(message);}<!--￼<span class="number">4</span>--></code></pre></li></ul></li><li><p>array</p><ul><li><pre><code class="typescript"><span class="keyword">let</span> list: <span class="built_in">number</span>[] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];<span class="keyword">let</span> list: <span class="built_in">Array</span><<span class="built_in">number</span>> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];<!--￼<span class="number">5</span>--></code></pre></li></ul></li><li><p>enum</p><ul><li><pre><code class="typescript"><span class="keyword">enum</span> Color {  Red,  Green,  Blue,}<span class="keyword">let</span> c: Color = Color.Green;<span class="keyword">enum</span> Color {  Red = <span class="number">1</span>,  Green,  Blue,}<span class="keyword">let</span> c: Color = Color.Green;<span class="keyword">enum</span> Color {  Red = <span class="number">1</span>,  Green = <span class="number">2</span>,  Blue = <span class="number">4</span>,}<span class="keyword">let</span> c: Color = Color.Green;<!--￼<span class="number">6</span>-->- 第二种  - <span class="string">``</span><span class="string">`typescript</span><span class="string">    let someValue: unknown = "this is a string";</span><span class="string">    let strLength: number = (<string>someValue).length;</span><span class="string">    <figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">## 3、编译选项</span><br><span class="line"></span><br><span class="line">- 自动编译文件</span><br><span class="line"></span><br><span class="line">  - 编译文件时，使用 -w 指令后，TS编译器会自动监视文件的变化，并在文件发生变化时对文件进行重新编译。</span><br><span class="line"></span><br><span class="line">  - 示例：</span><br><span class="line"></span><br><span class="line">    - ```powershell</span><br><span class="line">      tsc xxx.ts -w</span><br></pre></td></tr></tbody></table></figure></span></code></pre></li></ul></li><li><p>自动编译整个项目</p><ul><li><p>如果直接使用tsc指令，则可以自动将当前项目下的所有ts文件编译为js文件。</p></li><li><p>但是能直接使用tsc命令的前提时，要先在项目根目录下创建一个ts的配置文件 tsconfig.json</p></li><li><p>tsconfig.json是一个JSON文件，添加配置文件后，只需只需 tsc 命令即可完成对整个项目的编译</p></li><li><p>配置选项：</p><ul><li><p>include</p><ul><li><p>定义希望被编译文件所在的目录</p></li><li><p>默认值：[“**/*“]</p></li><li><p>示例：</p><ul><li><pre><code class="json">"include":["src/**/*", "tests/**/*"]<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    - 上述示例中，所有src目录和tests目录下的文件都会被编译</span><br><span class="line"></span><br><span class="line">- exclude</span><br><span class="line"></span><br><span class="line">  - 定义需要排除在外的目录</span><br><span class="line"></span><br><span class="line">  - 默认值：["node_modules", "bower_components", "jspm_packages"]</span><br><span class="line"></span><br><span class="line">  - 示例：</span><br><span class="line"></span><br><span class="line">    - ```json</span><br><span class="line">      "exclude": ["./src/hello/**/*"]</span><br></pre></td></tr></tbody></table></figure></code></pre></li><li><p>上述示例中，src下hello目录下的文件都不会被编译</p></li></ul></li></ul></li><li><p>extends</p><ul><li><p>定义被继承的配置文件</p></li><li><p>示例：</p><ul><li><pre><code class="json">"extends": "./configs/base"<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    - 上述示例中，当前配置文件中会自动包含config目录下base.json中的所有配置信息</span><br><span class="line"></span><br><span class="line">- files</span><br><span class="line"></span><br><span class="line">  - 指定被编译文件的列表，只有需要编译的文件少时才会用到</span><br><span class="line"></span><br><span class="line">  - 示例：</span><br><span class="line"></span><br><span class="line">    - ```json</span><br><span class="line">      "files": [</span><br><span class="line">          "core.ts",</span><br><span class="line">          "sys.ts",</span><br><span class="line">          "types.ts",</span><br><span class="line">          "scanner.ts",</span><br><span class="line">          "parser.ts",</span><br><span class="line">          "utilities.ts",</span><br><span class="line">          "binder.ts",</span><br><span class="line">          "checker.ts",</span><br><span class="line">          "tsc.ts"</span><br><span class="line">        ]</span><br></pre></td></tr></tbody></table></figure></code></pre></li><li><p>列表中的文件都会被TS编译器所编译</p></li></ul></li><li><p>compilerOptions</p><ul><li><p>编译选项是配置文件中非常重要也比较复杂的配置选项</p></li><li><p>在compilerOptions中包含多个子选项，用来完成对编译的配置</p><ul><li><p>项目选项</p><ul><li><p>target</p><ul><li><p>设置ts代码编译的目标版本</p></li><li><p>可选值：</p><ul><li>ES3（默认）、ES5、ES6/ES2015、ES7/ES2016、ES2017、ES2018、ES2019、ES2020、ESNext</li></ul></li><li><p>示例：</p><ul><li><pre><code class="json">"compilerOptions": {    "target": "ES6"}<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    - 如上设置，我们所编写的ts代码将会被编译为ES6版本的js代码</span><br><span class="line"></span><br><span class="line">- lib</span><br><span class="line"></span><br><span class="line">  - 指定代码运行时所包含的库（宿主环境）</span><br><span class="line"></span><br><span class="line">  - 可选值：</span><br><span class="line"></span><br><span class="line">    - ES5、ES6/ES2015、ES7/ES2016、ES2017、ES2018、ES2019、ES2020、ESNext、DOM、WebWorker、ScriptHost ......</span><br><span class="line"></span><br><span class="line">  - 示例：</span><br><span class="line"></span><br><span class="line">    - ```json</span><br><span class="line">      "compilerOptions": {</span><br><span class="line">          "target": "ES6",</span><br><span class="line">          "lib": ["ES6", "DOM"],</span><br><span class="line">          "outDir": "dist",</span><br><span class="line">          "outFile": "dist/aa.js"</span><br><span class="line">      }</span><br></pre></td></tr></tbody></table></figure></code></pre></li></ul></li></ul></li><li><p>module</p><ul><li><p>设置编译后代码使用的模块化系统</p></li><li><p>可选值：</p><ul><li>CommonJS、UMD、AMD、System、ES2020、ESNext、None</li></ul></li><li><p>示例：</p><ul><li><pre><code class="typescript"><span class="string">"compilerOptions"</span>: {    <span class="string">"module"</span>: <span class="string">"CommonJS"</span>}<!--￼<span class="number">11</span>--></code></pre></li><li><p>设置后编译后的js文件将会生成到dist目录</p></li></ul></li></ul></li><li><p>outFile</p><ul><li><p>将所有的文件编译为一个js文件</p></li><li><p>默认会将所有的编写在全局作用域中的代码合并为一个js文件，如果module制定了None、System或AMD则会将模块一起合并到文件之中</p></li><li><p>示例：</p><ul><li><pre><code class="json">"compilerOptions": {    "outFile": "dist/app.js"}<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- rootDir</span><br><span class="line"></span><br><span class="line">  - 指定代码的根目录，默认情况下编译后文件的目录结构会以最长的公共目录为根目录，通过rootDir可以手动指定根目录</span><br><span class="line"></span><br><span class="line">  - 示例：</span><br><span class="line"></span><br><span class="line">    - ```json</span><br><span class="line">      "compilerOptions": {</span><br><span class="line">          "rootDir": "./src"</span><br><span class="line">      }</span><br></pre></td></tr></tbody></table></figure></code></pre></li></ul></li></ul></li><li><p>allowJs</p><ul><li>是否对js文件编译</li></ul></li><li><p>checkJs</p><ul><li><p>是否对js文件进行检查</p></li><li><p>示例：</p><ul><li>```json<br>“compilerOptions”: {<pre><code>"allowJs": true,"checkJs": true</code></pre>}<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">            - removeComments</span><br><span class="line"></span><br><span class="line">              - 是否删除注释</span><br><span class="line">              - 默认值：false</span><br><span class="line"></span><br><span class="line">            - noEmit</span><br><span class="line"></span><br><span class="line">              - 不对代码进行编译</span><br><span class="line">              - 默认值：false</span><br><span class="line"></span><br><span class="line">            - sourceMap</span><br><span class="line"></span><br><span class="line">              - 是否生成sourceMap</span><br><span class="line">              - 默认值：false</span><br><span class="line"></span><br><span class="line">              </span><br><span class="line"></span><br><span class="line">          - 严格检查</span><br><span class="line"></span><br><span class="line">            - strict</span><br><span class="line">              - 启用所有的严格检查，默认值为true，设置后相当于开启了所有的严格检查</span><br><span class="line">            - alwaysStrict</span><br><span class="line">              - 总是以严格模式对代码进行编译</span><br><span class="line">            - noImplicitAny</span><br><span class="line">              - 禁止隐式的any类型</span><br><span class="line">            - noImplicitThis</span><br><span class="line">              - 禁止类型不明确的this</span><br><span class="line">            - strictBindCallApply</span><br><span class="line">              - 严格检查bind、call和apply的参数列表</span><br><span class="line">            - strictFunctionTypes</span><br><span class="line">              - 严格检查函数的类型</span><br><span class="line">            - strictNullChecks</span><br><span class="line">              - 严格的空值检查</span><br><span class="line">            - strictPropertyInitialization</span><br><span class="line">              - 严格检查属性是否初始化</span><br><span class="line"></span><br><span class="line">          - 额外检查</span><br><span class="line"></span><br><span class="line">            - noFallthroughCasesInSwitch</span><br><span class="line">              - 检查switch语句包含正确的break</span><br><span class="line">            - noImplicitReturns</span><br><span class="line">              - 检查函数没有隐式的返回值</span><br><span class="line">            - noUnusedLocals</span><br><span class="line">              - 检查未使用的局部变量</span><br><span class="line">            - noUnusedParameters</span><br><span class="line">              - 检查未使用的参数</span><br><span class="line"></span><br><span class="line">          - 高级</span><br><span class="line"></span><br><span class="line">            - allowUnreachableCode</span><br><span class="line">              - 检查不可达代码</span><br><span class="line">              - 可选值：</span><br><span class="line">                - true，忽略不可达代码</span><br><span class="line">                - false，不可达代码将引起错误</span><br><span class="line">            - noEmitOnError</span><br><span class="line">              - 有错误的情况下不进行编译</span><br><span class="line">              - 默认值：false</span><br><span class="line"></span><br><span class="line">## 4、webpack</span><br><span class="line"></span><br><span class="line">- 通常情况下，实际开发中我们都需要使用构建工具对代码进行打包，TS同样也可以结合构建工具一起使用，下边以webpack为例介绍一下如何结合构建工具使用TS。</span><br><span class="line"></span><br><span class="line">- 步骤：</span><br><span class="line"></span><br><span class="line">  1. 初始化项目</span><br><span class="line"></span><br><span class="line">     - 进入项目根目录，执行命令 ``` npm init -y</span><br></pre></td></tr></tbody></table></figure></li></ul></li></ul></li></ul></li></ul></li><li><p>主要作用：创建package.json文件</p></li></ul></li></ul></li></ul></li></ul><ol start="2"><li><p>下载构建工具</p><ul><li><code>npm i -D webpack webpack-cli webpack-dev-server typescript ts-loader clean-webpack-plugin</code><ul><li>共安装了7个包<ul><li>webpack<ul><li>构建工具webpack</li></ul></li><li>webpack-cli<ul><li>webpack的命令行工具</li></ul></li><li>webpack-dev-server<ul><li>webpack的开发服务器</li></ul></li><li>typescript<ul><li>ts编译器</li></ul></li><li>ts-loader<ul><li>ts加载器，用于在webpack中编译ts文件</li></ul></li><li>html-webpack-plugin<ul><li>webpack中html插件，用来自动创建html文件</li></ul></li><li>clean-webpack-plugin<ul><li>webpack中的清除插件，每次构建都会先清除目录</li></ul></li></ul></li></ul></li></ul></li><li><p>根目录下创建webpack的配置文件webpack.config.js</p><ul><li><pre><code class="javascript"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);<span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">"html-webpack-plugin"</span>);<span class="keyword">const</span> { CleanWebpackPlugin } = <span class="built_in">require</span>(<span class="string">"clean-webpack-plugin"</span>);<span class="built_in">module</span>.exports = {    optimization:{        minimize: <span class="literal">false</span> <span class="comment">// 关闭代码压缩，可选</span>    },    entry: <span class="string">"./src/index.ts"</span>,    devtool: <span class="string">"inline-source-map"</span>,    devServer: {        contentBase: <span class="string">'./dist'</span>    },    output: {        path: path.resolve(__dirname, <span class="string">"dist"</span>),        filename: <span class="string">"bundle.js"</span>,        environment: {            arrowFunction: <span class="literal">false</span> <span class="comment">// 关闭webpack的箭头函数，可选</span>        }    },    resolve: {        extensions: [<span class="string">".ts"</span>, <span class="string">".js"</span>]    },    <span class="built_in">module</span>: {        rules: [            {                test: <span class="regexp">/\.ts$/</span>,                use: {                   loader: <span class="string">"ts-loader"</span>                     },                exclude: <span class="regexp">/node_modules/</span>            }        ]    },    plugins: [        <span class="keyword">new</span> CleanWebpackPlugin(),        <span class="keyword">new</span> HtmlWebpackPlugin({            title:<span class="string">'TS测试'</span>        }),    ]}<!--￼<span class="number">14</span>--></code></pre></li></ul></li><li><p>修改package.json添加如下配置</p><ul><li>```json<br>{<br>  …略…<br>  “scripts”: {<pre><code>"test": "echo \"Error: no test specified\" && exit 1","build": "webpack","start": "webpack serve --open chrome.exe"</code></pre>  },<br>  …略…<br>}<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  6. 在src下创建ts文件，并在并命令行执行```npm run build```对代码进行编译，或者执行```npm start```来启动开发服务器</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line"></span><br><span class="line">## 5、Babel</span><br><span class="line"></span><br><span class="line">- 经过一系列的配置，使得TS和webpack已经结合到了一起，除了webpack，开发中还经常需要结合babel来对代码进行转换以使其可以兼容到更多的浏览器，在上述步骤的基础上，通过以下步骤再将babel引入到项目中。</span><br><span class="line"></span><br><span class="line">  1. 安装依赖包：</span><br><span class="line">     - ```npm i -D @babel/core @babel/preset-env babel-loader core-js</span><br></pre></td></tr></tbody></table></figure></li><li>共安装了4个包，分别是：<ul><li>@babel/core<ul><li>babel的核心工具</li></ul></li><li>@babel/preset-env<ul><li>babel的预定义环境</li></ul></li><li>@babel-loader<ul><li>babel在webpack中的加载器</li></ul></li><li>core-js<ul><li>core-js用来使老版本的浏览器支持新版ES语法</li></ul></li></ul></li></ul></li><li><p>修改webpack.config.js配置文件</p><ul><li><pre><code class="javascript">...略...<span class="built_in">module</span>: {    rules: [        {            test: <span class="regexp">/\.ts$/</span>,            use: [                {                    loader: <span class="string">"babel-loader"</span>,                    options:{                        presets: [                            [                                <span class="string">"@babel/preset-env"</span>,                                {                                    <span class="string">"targets"</span>:{                                        <span class="string">"chrome"</span>: <span class="string">"58"</span>,                                        <span class="string">"ie"</span>: <span class="string">"11"</span>                                    },                                    <span class="string">"corejs"</span>:<span class="string">"3"</span>,                                    <span class="string">"useBuiltIns"</span>: <span class="string">"usage"</span>                                }                            ]                        ]                    }                },                {                    loader: <span class="string">"ts-loader"</span>,                }            ],            exclude: <span class="regexp">/node_modules/</span>        }    ]}...略...</code></pre></li><li><p>如此一来，使用ts编译后的文件将会再次被babel处理，使得代码可以在大部分浏览器中直接使用，可以在配置选项的targets中指定要兼容的浏览器版本。</p></li></ul></li></ol></li></ul></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;第一章-快速入门&quot;&gt;&lt;a href=&quot;#第一章-快速入门&quot; class=&quot;headerlink&quot; title=&quot;第一章 快速入门&quot;&gt;&lt;/a&gt;第一章 快速入门&lt;/h1&gt;&lt;h2 id=&quot;0、TypeScript简介&quot;&gt;&lt;a href=&quot;#0、TypeScript简介&quot; class=&quot;headerlink&quot; title=&quot;0、TypeScript简介&quot;&gt;&lt;/a&gt;0、TypeScript简介&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;TypeScript是JavaScript的超集。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;它对JS进行了扩展，向JS中引入了类型的概念，并添加了许多新的特性。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;TS代码需要通过编译器编译为JS，然后再交由JS解析器执行。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
    
    </summary>
    
    
      <category term="TypeScript" scheme="http://philxling.club/categories/TypeScript/"/>
    
    
      <category term="TypeScript" scheme="http://philxling.club/tags/TypeScript/"/>
    
  </entry>
  
  <entry>
    <title>蒙特卡洛树搜索MCTS实现五子棋</title>
    <link href="http://philxling.club/2022/10/10/%E5%8D%9A%E5%BC%88/%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E6%A0%91%E6%90%9C%E7%B4%A2MCTS/"/>
    <id>http://philxling.club/2022/10/10/%E5%8D%9A%E5%BC%88/%E8%92%99%E7%89%B9%E5%8D%A1%E6%B4%9B%E6%A0%91%E6%90%9C%E7%B4%A2MCTS/</id>
    <published>2022-10-10T08:48:54.000Z</published>
    <updated>2022-11-18T11:03:07.685Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="蒙特卡洛树"><a href="#蒙特卡洛树" class="headerlink" title="蒙特卡洛树"></a>蒙特卡洛树</h1><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>1 蒙特卡洛树搜索是一类树搜索算法的统称,称为MCTS,是一种启发式搜索算法,在搜索空间极大的游戏中比较有效,它的目标是给定一个游戏状态,选择最佳的一步,如Alpha Go.</p><a id="more"></a><h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>1 选择: 选择能够最大化UCB值的节点</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UCB = Vi+c*sqot(lnN/ni) c=2</span><br></pre></td></tr></tbody></table></figure><p>2 扩展: 创建一个或多个子节点</p><p>3 仿真: 在某一结点用随机策略进行游戏</p><p>4 反向传播: 使用随机搜索的结果更新整个搜索树</p><p>5 在棋类游戏中应用mcts，本例将用五子棋应用mcts实现，实现五子棋的文件目录如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---gomoku</span><br><span class="line">--board.py</span><br><span class="line">--mcts.py</span><br><span class="line">--node.py</span><br><span class="line">--play.py</span><br></pre></td></tr></tbody></table></figure><p> 然后就可以一个一个实现了，首先是board，我们需要首先实现board类其需要一些属性</p><figure class="highlight plain"><figcaption><span>```表示棋盘大小</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```board ```传入一个board，若为空，则用numpy初始化一个</span><br><span class="line"></span><br><span class="line">```cur_player``` 当前游戏玩家</span><br><span class="line"></span><br><span class="line">其代码如下：</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">class Board():</span><br><span class="line">    def __init__(self, board=None, size=8, cur_player=-1):</span><br><span class="line">        self.size = size</span><br><span class="line">        self.board = np.zeros((self.size, self.size), int) if board is None else board</span><br><span class="line">        self.cur_player = cur_player</span><br></pre></td></tr></tbody></table></figure><p>然后需要实现几个函数：</p><figure class="highlight plain"><figcaption><span>判断棋子是否合法</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```get_legal_pos``` 返回列表，得到棋盘位置为0点返回</span><br><span class="line"></span><br><span class="line">```move```  落子操作，先判断棋子是否合法，则新生成一个Board对象，并将当前的move位置添加到棋盘上返回</span><br><span class="line"></span><br><span class="line">```board_result``` 判断哪方赢。</span><br><span class="line"></span><br><span class="line">```game_over``` 判定游戏是否结束</span><br><span class="line"></span><br><span class="line">接下来一一实现，其代码如下：</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">    def is_move_legal(self, move_pos):</span><br><span class="line">        """</span><br><span class="line">        :param move_pos: 元组得到位置</span><br><span class="line">        :return: true or false</span><br><span class="line">        """</span><br><span class="line">        x, y = -100, -100</span><br><span class="line">        if move_pos is not None:</span><br><span class="line">            x, y = move_pos[0], move_pos[1]</span><br><span class="line">        if x < 0 or x > self.size or y < 0 or y > self.size:  # 判断是否溢出棋盘边界</span><br><span class="line">            return False</span><br><span class="line">        if self.board[x, y] != 0:  # 判断是否下在已经有棋子的位置上</span><br><span class="line">            return False</span><br><span class="line">        return True</span><br><span class="line"></span><br><span class="line">    def get_legal_pos(self):</span><br><span class="line">        """</span><br><span class="line">        :return: 返回列表</span><br><span class="line">        """</span><br><span class="line">        pos_list = []</span><br><span class="line">        for i in range(0, self.size):</span><br><span class="line">            for j in range(0, self.size):</span><br><span class="line">                if self.board[i][j] == 0:</span><br><span class="line">                    pos_list.append((i, j))</span><br><span class="line">        return pos_list</span><br><span class="line"></span><br><span class="line">    def move(self, move_pos):</span><br><span class="line">        """</span><br><span class="line">        走子</span><br><span class="line">        :param move_pos:</span><br><span class="line">        :return: board</span><br><span class="line">        """</span><br><span class="line">        if not self.is_move_legal(move_pos):  # 不合法</span><br><span class="line">            return '棋子不合法'</span><br><span class="line">        new_board = Board(np.copy(self.board), cur_player=-self.cur_player)</span><br><span class="line">        new_board.board[move_pos[0]][move_pos[1]] = self.cur_player</span><br><span class="line">        return new_board</span><br><span class="line"></span><br><span class="line">    def board_result(self, move_pos):</span><br><span class="line">        """</span><br><span class="line">        :param move_pos:</span><br><span class="line">        :return: 判断哪方赢</span><br><span class="line">        """</span><br><span class="line"></span><br><span class="line">        x, y = move_pos[0], move_pos[1]</span><br><span class="line">        # print(x,y)</span><br><span class="line">        player = self.board[x,y]</span><br><span class="line">        direction = list([[self.board[i][y] for i in range(self.size)]])  # 纵向是否有五颗连子</span><br><span class="line">        direction.append([self.board[x][j] for j in range(self.size)])  # 横向是否有五颗连子</span><br><span class="line">        direction.append(self.board.diagonal(y - x))  # 该点正对角是否有五颗连子</span><br><span class="line">        direction.append(np.fliplr(self.board).diagonal(self.size - 1 - y - x))  # 该点反对角是否有五颗连子</span><br><span class="line">        for i in direction:</span><br><span class="line">            count = 0</span><br><span class="line">            for v in i:</span><br><span class="line">                if v == player:</span><br><span class="line">                    count += 1</span><br><span class="line">                    if count == 5:</span><br><span class="line">                        return True</span><br><span class="line">                else:</span><br><span class="line">                    count = 0</span><br><span class="line">        return False</span><br><span class="line"></span><br><span class="line">    def game_over(self, move_pos):</span><br><span class="line">        """</span><br><span class="line">        判断游戏是否结束，</span><br><span class="line">        :param move_pos:</span><br><span class="line">        :return:</span><br><span class="line">        """</span><br><span class="line">        if self.board_result(move_pos):</span><br><span class="line">            return "win"</span><br><span class="line">        elif len(self.get_legal_pos()) == 0:</span><br><span class="line">            return 'tie'</span><br><span class="line">        else:</span><br><span class="line">            return None</span><br></pre></td></tr></tbody></table></figure><p>实现完棋盘后，还需要实现游戏树节点，也就是<code>node</code>文件，其包含判定游戏树节点的一些操作，定义<code>Node</code>其属性具体如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, board=None, parent=None, pre_pos=None)</span>:</span></span><br><span class="line">    self.pre_pos = pre_pos <span class="comment"># 最后一次落子位置</span></span><br><span class="line">    self.board = board  <span class="comment"># 棋盘</span></span><br><span class="line">    self.parent = parent  <span class="comment"># 父节点</span></span><br><span class="line">    self.children = list()</span><br><span class="line">    self.not_visit_pos = <span class="literal">None</span>  <span class="comment"># 未访问节点</span></span><br><span class="line">    self.num_of_visit = <span class="number">0</span>  <span class="comment"># 该节点访问次数</span></span><br><span class="line">    self.num_of_wins = defaultdict(int)  <span class="comment"># 该节点胜利次数</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><figcaption><span>判断节点是否完全展开</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```non_terminal```   是否为终端节点，即该节点对应的格局是否已分出胜负</span><br><span class="line"></span><br><span class="line">```pick_unvisited```  选择一个未访问的节点并加入当前节点的孩子中</span><br><span class="line"></span><br><span class="line">```pick_random```  随机选择该节点的一个孩子扩展</span><br><span class="line"></span><br><span class="line">```num_of_win ```  判断该节点的胜负情况，利用一个实数即可代表黑白二子的胜负差值</span><br><span class="line"></span><br><span class="line">```best_uct```  根据uct公式计算最优的孩子节点</span><br><span class="line"></span><br><span class="line">具体实现如下：</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">    def fully_expended(self):</span><br><span class="line">        """</span><br><span class="line">        判断节点是否完全展开</span><br><span class="line">        :return: TRUE FALSE</span><br><span class="line">        """</span><br><span class="line">        if self.not_visit_pos is None:</span><br><span class="line">            self.not_visit_pos = self.board.get_legal_pos()</span><br><span class="line">        return True if len(self.not_visit_pos) == 0 and len(self.children) != 0 else False</span><br><span class="line"></span><br><span class="line">    def non_terminal(self):</span><br><span class="line">        """</span><br><span class="line">        是否为终端节点，即该节点对应的格局是否已分出胜负</span><br><span class="line">        :return:</span><br><span class="line">        """</span><br><span class="line">        game_result = self.board.game_over(self.pre_pos)</span><br><span class="line">        return game_result</span><br><span class="line"></span><br><span class="line">    def pick_unvisited(self):</span><br><span class="line">        """</span><br><span class="line">        选择一个未访问的节点并加入当前节点的孩子中</span><br><span class="line">        :return:</span><br><span class="line">        """</span><br><span class="line">        random_index = random.randint(0, len(self.not_visit_pos) - 1)</span><br><span class="line">        move_pos = self.not_visit_pos.pop(random_index)</span><br><span class="line">        new_board = self.board.move(move_pos)</span><br><span class="line">        new_node = Node(new_board, self, move_pos)</span><br><span class="line">        self.children.append(new_node)</span><br><span class="line">        return new_node</span><br><span class="line"></span><br><span class="line">    def pick_random(self):</span><br><span class="line">        """</span><br><span class="line">        随即选择该节点的一个孩子扩展</span><br><span class="line">        :return:</span><br><span class="line">        """</span><br><span class="line">        possible_moves = self.board.get_legal_pos()</span><br><span class="line">        random_index = random.randint(0,len(possible_moves) - 1)</span><br><span class="line">        new_board = self.board.move(possible_moves[random_index])</span><br><span class="line">        new_node = Node(new_board, self, possible_moves[random_index])</span><br><span class="line">        return new_node</span><br><span class="line"></span><br><span class="line">    def num_of_win(self):</span><br><span class="line">        """</span><br><span class="line">        判断该节点的胜负情况，利用一个实数即可代表黑白二子的胜负差值</span><br><span class="line">        :return:</span><br><span class="line">        """</span><br><span class="line">        win = self.num_of_wins[-self.board.cur_player]</span><br><span class="line">        lose = self.num_of_wins[self.board.cur_player]</span><br><span class="line"></span><br><span class="line">        return win - lose</span><br><span class="line"></span><br><span class="line">    def best_uct(self, c_param=1.98):</span><br><span class="line">        uct_of_child = np.array(list(</span><br><span class="line">            [child.num_of_win() / child.num_of_visit + c_param * np.sqrt(self.num_of_visit) / child.num_of_visit for</span><br><span class="line">             child in self.children]))</span><br><span class="line">        best_index = np.argmax(uct_of_child)</span><br><span class="line">        return self.children[best_index]</span><br></pre></td></tr></tbody></table></figure><p>接下来是mcts实现，mcts其具体包含四个步骤，开篇已经提到了，接下来我们将具体实现</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 到达叶结点</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">traverse</span><span class="params">(node)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> node.fully_expended():</span><br><span class="line">        node = node.best_uct()</span><br><span class="line">    <span class="keyword">if</span> node.non_terminal() <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>: <span class="comment">#</span></span><br><span class="line">        <span class="keyword">return</span> node</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> node.pick_unvisited()</span><br><span class="line">  </span><br><span class="line"><span class="comment"># 然后进行随机模拟</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rollout</span><span class="params">(node)</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        game_result = node.non_terminal()</span><br><span class="line">        <span class="keyword">if</span> game_result <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            node = node.pick_random()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> game_result == <span class="string">'win'</span> <span class="keyword">and</span> -node.board.cur_player == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">elif</span> game_result == <span class="string">'win'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"> <span class="comment"># 回溯，将模拟的值依次回溯至父节点</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">backpropagate</span><span class="params">(node, result)</span>:</span></span><br><span class="line">    node.num_of_visit += <span class="number">1</span></span><br><span class="line">    node.num_of_wins[result] += <span class="number">1</span></span><br><span class="line">    <span class="comment"># print("backpropagate run")</span></span><br><span class="line">    <span class="keyword">if</span> node.parent:</span><br><span class="line">        backpropagate(node.parent, result)</span><br><span class="line">        <span class="comment"># print("backpropagate run")</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"> <span class="comment"># 根据uct公式选择最好的下一步</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">best_child</span><span class="params">(node)</span>:</span></span><br><span class="line">    visit_num_of_children = np.array(list([child.num_of_visit <span class="keyword">for</span> child <span class="keyword">in</span> node.children]))</span><br><span class="line">    <span class="comment"># print(visit_num_of_children)</span></span><br><span class="line">    best_index = np.argmax(visit_num_of_children)</span><br><span class="line">    node = node.children[best_index]</span><br><span class="line">    <span class="keyword">return</span> node</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># mcts 可以循环很多次，进而促进多的模拟对局，才能选出更好的下一步</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">mcts</span><span class="params">(board, pre_pos)</span>:</span></span><br><span class="line">    root = Node(board=board, pre_pos=pre_pos)  <span class="comment"># 根节点作为第一个node</span></span><br><span class="line">    <span class="comment"># print('mcts pre_pos:{}'.format(root.pre_pos))</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, mcts_times): <span class="comment"># 循环 mcts_times为你要模拟多少次</span></span><br><span class="line">        leaf = traverse(root)  <span class="comment"># 到达叶结点</span></span><br><span class="line">        <span class="comment"># print("----------traverse run")</span></span><br><span class="line">        simulation_result = rollout(leaf) <span class="comment"># 随机模拟</span></span><br><span class="line">        <span class="comment"># print(simulation_result)</span></span><br><span class="line">        backpropagate(leaf, simulation_result) <span class="comment"># 回溯</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> best_child(root).pre_pos <span class="comment"># 返回最好的下一步</span></span><br></pre></td></tr></tbody></table></figure><p>定义完成之后接下来就可以进行对局了，也就是<code>play</code>文件，其具体实现如下：</p><p>定义<code>play</code>,其属性包含<code>board</code>,然后实现<code>print_board</code>打印棋盘,<code>startplay</code> 开始对局，依次实现，代码如下</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> board <span class="keyword">import</span> Board</span><br><span class="line"><span class="keyword">from</span> board <span class="keyword">import</span> Human</span><br><span class="line"><span class="keyword">from</span> board <span class="keyword">import</span> AI</span><br><span class="line">ALPHABET = <span class="string">'A B C D E F G H I J K L M N O'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">play</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.board = Board()</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">print_board</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="comment"># width, height = self.board.size, self.board.size  # 棋盘大小</span></span><br><span class="line"></span><br><span class="line">        print(<span class="string">"黑子(-1) 用 X 表示\t白子(1) 用 O 表示"</span>)</span><br><span class="line">        <span class="comment">#</span></span><br><span class="line">        <span class="comment"># for x in range(width):  # 打印行坐标</span></span><br><span class="line">        <span class="comment">#     print("{0:8}".format(x), end='')</span></span><br><span class="line">        board_str = <span class="string">'\n   '</span> + ALPHABET[:self.board.size * <span class="number">2</span> - <span class="number">1</span>] + <span class="string">'\n'</span></span><br><span class="line">        board = self.board</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.board.size):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(self.board.size):</span><br><span class="line">                <span class="keyword">if</span> j == <span class="number">0</span>:</span><br><span class="line">                    board_str += <span class="string">'{:2}'</span>.format(i + <span class="number">1</span>)</span><br><span class="line">                <span class="keyword">if</span> board.board[i, j] == <span class="number">-1</span>:</span><br><span class="line">                    board_str += <span class="string">' X'</span></span><br><span class="line">                <span class="keyword">elif</span> board.board[i, j] == <span class="number">1</span>:</span><br><span class="line">                    board_str += <span class="string">' O'</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    board_str += <span class="string">' .'</span></span><br><span class="line">                <span class="keyword">if</span> j == self.board.size - <span class="number">1</span>:</span><br><span class="line">                    board_str += <span class="string">'\n'</span></span><br><span class="line">        <span class="comment"># board_str += '  '</span></span><br><span class="line">        print(board_str)</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">startplay</span><span class="params">(self)</span>:</span></span><br><span class="line">        human,ai = Human(),AI()</span><br><span class="line">        self.print_board()</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            self.board,move_pos = human.action(self.board)</span><br><span class="line">            game_result = self.board.game_over(move_pos)</span><br><span class="line">            self.print_board()</span><br><span class="line">            <span class="keyword">if</span> game_result == <span class="string">'win'</span> <span class="keyword">or</span> game_result==<span class="string">'tie'</span>:</span><br><span class="line">                print(<span class="string">'黑子落棋:{},(-1)胜利，game over\n'</span>.format(move_pos)) <span class="keyword">if</span> game_result == <span class="string">'win'</span> <span class="keyword">else</span> print(<span class="string">'黑子落棋:{}, 平局\n'</span>.format(move_pos))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'黑子落棋:{},未分胜利\n'</span>.format(move_pos))</span><br><span class="line">            start = time.time()</span><br><span class="line">            self.board, move_pos = ai.action(self.board,move_pos)</span><br><span class="line">            finish = time.time()-start</span><br><span class="line">            <span class="comment"># print('ai')</span></span><br><span class="line">            <span class="comment"># print(move_pos)</span></span><br><span class="line">            game_result = self.board.game_over(move_pos)</span><br><span class="line">            self.print_board()</span><br><span class="line">            <span class="keyword">if</span> game_result == <span class="string">'win'</span> <span class="keyword">or</span> game_result==<span class="string">'tie'</span>:</span><br><span class="line">                print(<span class="string">'白子落棋:{},(1)胜利，time:{:0.0f}s game over\n'</span>.format(move_pos,finish)) <span class="keyword">if</span> game_result == <span class="string">'win'</span> <span class="keyword">else</span> print(<span class="string">'白子落棋:{}, time:{:0.0f}s 平局\n'</span>.format(move_pos,finish))</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">'白子落棋:{}, time:{:0.0f}s 未分胜利\n'</span>.format(move_pos,finish))</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><figcaption><span>中包含两个角色，所以在```board```中定义两个角色，分别实现```action```的动作，也就是先通过```mcts```找到最好的```move```  ,然后走子，返回棋盘和当前的走子位置。</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">定义```human```类:</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">class Human():</span><br><span class="line">    def __init__(self, player=-1):</span><br><span class="line">        self.player = player</span><br><span class="line"></span><br><span class="line">    def get_action_pos(self, board):</span><br><span class="line">        """</span><br><span class="line">        读取用户输入的数据</span><br><span class="line">        :param board:</span><br><span class="line">        :return:</span><br><span class="line">        """</span><br><span class="line">        try:</span><br><span class="line">            location = input("输入坐标x,y:")</span><br><span class="line">            if isinstance(location, str) and len(location.split(",")) == 2:</span><br><span class="line">                move_pos = tuple([int(i) for i in location.split(',')])</span><br><span class="line">            else:</span><br><span class="line">                move_pos = -1</span><br><span class="line">        except:</span><br><span class="line">            move_pos = -1</span><br><span class="line"></span><br><span class="line">        if move_pos == -1 or move_pos not in board.get_legal_pos():</span><br><span class="line">            print('落子位置错误')</span><br><span class="line">            move_pos = self.get_action_pos(board)</span><br><span class="line"></span><br><span class="line">        # print('get_action_pos----{}'.format(move_pos))</span><br><span class="line">        return move_pos</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    def action(self, board):</span><br><span class="line">        """</span><br><span class="line">        获得用户落子后的棋盘格局</span><br><span class="line">        :param board:</span><br><span class="line">        :return:board,move_pos</span><br><span class="line">        """</span><br><span class="line">        move_pos = self.get_action_pos(board)</span><br><span class="line">        board = board.move(move_pos)</span><br><span class="line">        return board, move_pos</span><br></pre></td></tr></tbody></table></figure><p>定义<code>AI</code>：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AI</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, player=<span class="number">1</span>)</span>:</span></span><br><span class="line">        self.player = player</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">action</span><span class="params">(self,board,pre_pos)</span>:</span></span><br><span class="line">        move_pos = mcts(board,pre_pos)</span><br><span class="line">        board = board.move(move_pos)</span><br><span class="line">        <span class="keyword">return</span> board,move_pos</span><br></pre></td></tr></tbody></table></figure><p>至此，一个以mcts实现的五子棋实现完毕！！！。</p></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;蒙特卡洛树&quot;&gt;&lt;a href=&quot;#蒙特卡洛树&quot; class=&quot;headerlink&quot; title=&quot;蒙特卡洛树&quot;&gt;&lt;/a&gt;蒙特卡洛树&lt;/h1&gt;&lt;h3 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h3&gt;&lt;p&gt;1 蒙特卡洛树搜索是一类树搜索算法的统称,称为MCTS,是一种启发式搜索算法,在搜索空间极大的游戏中比较有效,它的目标是给定一个游戏状态,选择最佳的一步,如Alpha Go.&lt;/p&gt;
    
    </summary>
    
    
      <category term="博弈" scheme="http://philxling.club/categories/%E5%8D%9A%E5%BC%88/"/>
    
    
      <category term="算法" scheme="http://philxling.club/tags/%E7%AE%97%E6%B3%95/"/>
    
      <category term="博弈" scheme="http://philxling.club/tags/%E5%8D%9A%E5%BC%88/"/>
    
  </entry>
  
  <entry>
    <title>Scrapy-Redis组件介绍</title>
    <link href="http://philxling.club/2022/06/15/python%E7%88%AC%E8%99%AB/26-Scrapy-Redis%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D/"/>
    <id>http://philxling.club/2022/06/15/python%E7%88%AC%E8%99%AB/26-Scrapy-Redis%E7%BB%84%E4%BB%B6%E4%BB%8B%E7%BB%8D/</id>
    <published>2022-06-14T17:22:23.000Z</published>
    <updated>2023-04-06T06:21:59.120Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="2-Scrapy-Redis组件介绍"><a href="#2-Scrapy-Redis组件介绍" class="headerlink" title="2-Scrapy-Redis组件介绍"></a>2-Scrapy-Redis组件介绍</h1><a id="more"></a><p><code>Scrapy</code>是一个框架，他本身是不支持分布式的。如果我们想要做分布式的爬虫，就需要借助一个组件叫做<code>Scrapy-Redis</code>，这个组件正是利用了<code>Redis</code>可以分布式的功能，集成到<code>Scrapy</code>框架中，使得爬虫可以进行分布式。可以充分的利用资源（多个ip、更多带宽、同步爬取）来提高爬虫的爬行效率。</p><h2 id="分布式爬虫的优点："><a href="#分布式爬虫的优点：" class="headerlink" title="分布式爬虫的优点："></a>分布式爬虫的优点：</h2><ol><li>可以充分利用多台机器的带宽。</li><li>可以充分利用多台机器的ip地址。</li><li>多台机器做，爬取效率更高。</li></ol><h2 id="分布式爬虫必须要解决的问题："><a href="#分布式爬虫必须要解决的问题：" class="headerlink" title="分布式爬虫必须要解决的问题："></a>分布式爬虫必须要解决的问题：</h2><ol><li>分布式爬虫是好几台机器在同时运行，如何保证不同的机器爬取页面的时候不会出现重复爬取的问题。</li><li>同样，分布式爬虫在不同的机器上运行，在把数据爬完后如何保证保存在同一个地方。</li></ol><h2 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h2><p>通过<code>pip install scrapy-redis</code>即可安装。</p><h2 id="编写Scrapy-Redis分布式爬虫："><a href="#编写Scrapy-Redis分布式爬虫：" class="headerlink" title="编写Scrapy-Redis分布式爬虫："></a>编写Scrapy-Redis分布式爬虫：</h2><p>要将一个<code>Scrapy</code>项目变成一个<code>Scrapy-redis</code>项目只需修改以下三点就可以了：</p><ol><li>将爬虫的类从<code>scrapy.Spider</code>变成<code>scrapy_redis.spiders.RedisSpider</code>；或者是从<code>scrapy.CrawlSpider</code>变成<code>scrapy_redis.spiders.RedisCrawlSpider</code>。</li><li>将爬虫中的<code>start_urls</code>删掉。增加一个<code>redis_key="xxx"</code>。这个<code>redis_key</code>是为了以后在<code>redis</code>中控制爬虫启动的。爬虫的第一个url，就是在redis中通过这个发送出去的。</li><li>在配置文件中增加如下配置：</li></ol><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Scrapy-Redis相关配置</span></span><br><span class="line"><span class="comment"># 确保request存储到redis中</span></span><br><span class="line">SCHEDULER = <span class="string">"scrapy_redis.scheduler.Scheduler"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 确保所有爬虫共享相同的去重指纹</span></span><br><span class="line">DUPEFILTER_CLASS = <span class="string">"scrapy_redis.dupefilter.RFPDupeFilter"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置redis为item pipeline</span></span><br><span class="line">ITEM_PIPELINES = {</span><br><span class="line">    <span class="string">'scrapy_redis.pipelines.RedisPipeline'</span>: <span class="number">300</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在redis中保持scrapy-redis用到的队列，不会清理redis中的队列，从而可以实现暂停和恢复的功能。</span></span><br><span class="line">SCHEDULER_PERSIST = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置连接redis信息</span></span><br><span class="line">REDIS_HOST = <span class="string">'127.0.0.1'</span></span><br><span class="line">REDIS_PORT = <span class="number">6379</span></span><br></pre></td></tr></tbody></table></figure><ol><li>运行爬虫：<ol><li>在爬虫服务器上。进入爬虫文件所在的路径，然后输入命令：<code>scrapy runspider [爬虫名字]</code>。</li><li>在<code>Redis</code>服务器上，推入一个开始的url</li></ol></li></ol></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;2-Scrapy-Redis组件介绍&quot;&gt;&lt;a href=&quot;#2-Scrapy-Redis组件介绍&quot; class=&quot;headerlink&quot; title=&quot;2-Scrapy-Redis组件介绍&quot;&gt;&lt;/a&gt;2-Scrapy-Redis组件介绍&lt;/h1&gt;
    
    </summary>
    
    
      <category term="python爬虫" scheme="http://philxling.club/categories/python%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="python" scheme="http://philxling.club/tags/python/"/>
    
      <category term="python爬虫" scheme="http://philxling.club/tags/python%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>ScrapyShell</title>
    <link href="http://philxling.club/2022/04/12/python%E7%88%AC%E8%99%AB/19-ScrapyShell/"/>
    <id>http://philxling.club/2022/04/12/python%E7%88%AC%E8%99%AB/19-ScrapyShell/</id>
    <published>2022-04-11T17:22:23.000Z</published>
    <updated>2023-04-06T06:16:58.212Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="4-ScrapyShell"><a href="#4-ScrapyShell" class="headerlink" title="4-ScrapyShell"></a>4-ScrapyShell</h1><a id="more"></a><p>我们想要在爬虫中使用xpath、beautifulsoup、正则表达式、css选择器等来提取想要的数据。但是因为<code>scrapy</code>是一个比较重的框架。每次运行起来都要等待一段时间。因此要去验证我们写的提取规则是否正确，是一个比较麻烦的事情。因此<code>Scrapy</code>提供了一个shell，用来方便的测试规则。当然也不仅仅局限于这一个功能。</p><h2 id="打开Scrapy-Shell："><a href="#打开Scrapy-Shell：" class="headerlink" title="打开Scrapy Shell："></a>打开Scrapy Shell：</h2><p>打开cmd终端，进入到<code>Scrapy</code>项目所在的目录，然后进入到<code>scrapy</code>框架所在的虚拟环境中，输入命令<code>scrapy shell [链接]</code>。就会进入到scrapy的shell环境中。在这个环境中，你可以跟在爬虫的<code>parse</code>方法中一样使用了。 </p></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;4-ScrapyShell&quot;&gt;&lt;a href=&quot;#4-ScrapyShell&quot; class=&quot;headerlink&quot; title=&quot;4-ScrapyShell&quot;&gt;&lt;/a&gt;4-ScrapyShell&lt;/h1&gt;
    
    </summary>
    
    
      <category term="python爬虫" scheme="http://philxling.club/categories/python%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="python" scheme="http://philxling.club/tags/python/"/>
    
      <category term="python爬虫" scheme="http://philxling.club/tags/python%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>redis数据库介绍</title>
    <link href="http://philxling.club/2022/04/12/python%E7%88%AC%E8%99%AB/25-redis%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D/"/>
    <id>http://philxling.club/2022/04/12/python%E7%88%AC%E8%99%AB/25-redis%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8B%E7%BB%8D/</id>
    <published>2022-04-11T17:22:23.000Z</published>
    <updated>2023-04-06T06:22:19.749Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="1-redis数据库介绍"><a href="#1-redis数据库介绍" class="headerlink" title="1-redis数据库介绍"></a>1-redis数据库介绍</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><a id="more"></a><p><code>redis</code>是一种支持分布式的<code>nosql</code>数据库,他的数据是保存在内存中，同时<code>redis</code>可以定时把内存数据同步到磁盘，即可以将数据持久化，并且他比<code>memcached</code>支持更多的数据结构(<code>string</code>,<code>list列表[队列和栈]</code>,<code>set[集合]</code>,<code>sorted set[有序集合]</code>,<code>hash(hash表)</code>)。相关参考文档：<a href="http://redisdoc.com/index.html" target="_blank" rel="noopener">http://redisdoc.com/index.html</a></p><h2 id="redis使用场景："><a href="#redis使用场景：" class="headerlink" title="redis使用场景："></a>redis使用场景：</h2><ol><li>登录会话存储：存储在<code>redis</code>中，与<code>memcached</code>相比，数据不会丢失。</li><li>排行版/计数器：比如一些秀场类的项目，经常会有一些前多少名的主播排名。还有一些文章阅读量的技术，或者新浪微博的点赞数等。</li><li>作为消息队列：比如<code>celery</code>就是使用<code>redis</code>作为中间人。</li><li>当前在线人数：还是之前的秀场例子，会显示当前系统有多少在线人数。</li><li>一些常用的数据缓存：比如我们的<code>BBS</code>论坛，板块不会经常变化的，但是每次访问首页都要从<code>mysql</code>中获取，可以在<code>redis</code>中缓存起来，不用每次请求数据库。</li><li>把前200篇文章缓存或者评论缓存：一般用户浏览网站，只会浏览前面一部分文章或者评论，那么可以把前面200篇文章和对应的评论缓存起来。用户访问超过的，就访问数据库，并且以后文章超过200篇，则把之前的文章删除。</li><li>好友关系：微博的好友关系使用<code>redis</code>实现。</li><li>发布和订阅功能：可以用来做聊天软件。</li></ol><h2 id="redis和memcached的比较："><a href="#redis和memcached的比较：" class="headerlink" title="redis和memcached的比较："></a><code>redis</code>和<code>memcached</code>的比较：</h2><table><thead><tr><th></th><th>memcached</th><th>redis</th></tr></thead><tbody><tr><td>类型</td><td>纯内存数据库</td><td>内存磁盘同步数据库</td></tr><tr><td>数据类型</td><td>在定义value时就要固定数据类型</td><td>不需要</td></tr><tr><td>虚拟内存</td><td>不支持</td><td>支持</td></tr><tr><td>过期策略</td><td>支持</td><td>支持</td></tr><tr><td>存储数据安全</td><td>不支持</td><td>可以将数据同步到dump.db中</td></tr><tr><td>灾难恢复</td><td>不支持</td><td>可以将磁盘中的数据恢复到内存中</td></tr><tr><td>分布式</td><td>支持</td><td>主从同步</td></tr><tr><td>订阅与发布</td><td>不支持</td><td>支持</td></tr></tbody></table><h2 id="redis在ubuntu系统中的安装与启动"><a href="#redis在ubuntu系统中的安装与启动" class="headerlink" title="redis在ubuntu系统中的安装与启动"></a><code>redis</code>在<code>ubuntu</code>系统中的安装与启动</h2><ol><li><p>安装：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install redis-server</span><br></pre></td></tr></tbody></table></figure></li><li><p>卸载：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get purge --auto-remove redis-server</span><br></pre></td></tr></tbody></table></figure></li><li><p>启动：<code>redis</code>安装后，默认会自动启动，可以通过以下命令查看：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps aux|grep redis</span><br></pre></td></tr></tbody></table></figure><p>如果想自己手动启动，可以通过以下命令进行启动：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service redis-server start</span><br></pre></td></tr></tbody></table></figure></li><li><p>停止：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service redis-server stop</span><br></pre></td></tr></tbody></table></figure></li></ol><h2 id="redis在windows系统中的安装与启动："><a href="#redis在windows系统中的安装与启动：" class="headerlink" title="redis在windows系统中的安装与启动："></a>redis在windows系统中的安装与启动：</h2><ol><li>下载：redis官方是不支持windows操作系统的。但是微软的开源部门将redis移植到了windows上。因此下载地址不是在redis官网上。而是在github上：<a href="https://github.com/MicrosoftArchive/redis/releases。" target="_blank" rel="noopener">https://github.com/MicrosoftArchive/redis/releases。</a></li><li>安装：点击一顿下一步安装就可以了。</li><li>运行：进入到<code>redis</code>安装所在的路径然后执行<code>redis-server.exe redis.windows.conf</code>就可以运行了。</li><li>连接：<code>redis</code>和<code>mysql</code>以及<code>mongo</code>是一样的，都提供了一个客户端进行连接。输入命令<code>redis-cli</code>（前提是redis安装路径已经加入到环境变量中了）就可以连接到<code>redis</code>服务器了。</li></ol><h2 id="其他机器访问本机redis服务器："><a href="#其他机器访问本机redis服务器：" class="headerlink" title="其他机器访问本机redis服务器："></a>其他机器访问本机redis服务器：</h2><p>想要让其他机器访问本机的redis服务器。那么要修改redis.conf的配置文件，将bind改成<code>bind [自己的ip地址或者0.0.0.0]</code>，其他机器才能访问。<br><strong>注意：bind绑定的是本机网卡的ip地址，而不是想让其他机器连接的ip地址。如果有多块网卡，那么可以绑定多个网卡的ip地址。如果绑定到额是0.0.0.0，那么意味着其他机器可以通过本机所有的ip地址进行访问。</strong></p><h2 id="对redis的操作"><a href="#对redis的操作" class="headerlink" title="对redis的操作"></a>对<code>redis</code>的操作</h2><p>对<code>redis</code>的操作可以用两种方式，第一种方式采用<code>redis-cli</code>，第二种方式采用编程语言，比如<code>Python</code>、<code>PHP</code>和<code>JAVA</code>等。</p><ol><li><p>使用<code>redis-cli</code>对<code>redis</code>进行字符串操作：</p></li><li><p>启动<code>redis</code>：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo service redis-server start</span><br></pre></td></tr></tbody></table></figure></li><li><p>连接上</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-server</span><br></pre></td></tr></tbody></table></figure><p>：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h [ip] -p [端口]</span><br></pre></td></tr></tbody></table></figure></li><li><p>添加：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set key value</span><br><span class="line">如：</span><br><span class="line">set username xiaotuo</span><br></pre></td></tr></tbody></table></figure><p>将字符串值<code>value</code>关联到<code>key</code>。如果<code>key</code>已经持有其他值，<code>set</code>命令就覆写旧值，无视其类型。并且默认的过期时间是永久，即永远不会过期。</p></li><li><p>删除：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">del key</span><br><span class="line">如：</span><br><span class="line">del username</span><br></pre></td></tr></tbody></table></figure></li><li><p>设置过期时间：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expire key timeout(单位为秒)</span><br></pre></td></tr></tbody></table></figure><p>也可以在设置值的时候，一同指定过期时间：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set key value EX timeout</span><br><span class="line">或：</span><br><span class="line">setex key timeout value</span><br></pre></td></tr></tbody></table></figure></li><li><p>查看过期时间：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ttl key</span><br><span class="line">如：</span><br><span class="line">ttl username</span><br></pre></td></tr></tbody></table></figure></li><li><p>查看当前<code>redis</code>中的所有<code>key</code>：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keys *</span><br></pre></td></tr></tbody></table></figure></li><li><p>列表操作：</p><ul><li><p>在列表左边添加元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpush key value</span><br></pre></td></tr></tbody></table></figure><p>将值<code>value</code>插入到列表<code>key</code>的表头。如果<code>key</code>不存在，一个空列表会被创建并执行<code>lpush</code>操作。当<code>key</code>存在但不是列表类型时，将返回一个错误。</p></li><li><p>在列表右边添加元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpush key value</span><br></pre></td></tr></tbody></table></figure><p>将值value插入到列表key的表尾。如果key不存在，一个空列表会被创建并执行RPUSH操作。当key存在但不是列表类型时，返回一个错误。</p></li><li><p>查看列表中的元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lrange key start stop</span><br></pre></td></tr></tbody></table></figure><p>返回列表<code>key</code>中指定区间内的元素，区间以偏移量<code>start</code>和<code>stop</code>指定,如果要左边的第一个到最后的一个<code>lrange key 0 -1</code>。</p></li><li><p>移除列表中的元素：</p><ul><li><p>移除并返回列表</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key</span><br></pre></td></tr></tbody></table></figure><p>的头元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lpop key</span><br></pre></td></tr></tbody></table></figure></li><li><p>移除并返回列表的尾元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpop key</span><br></pre></td></tr></tbody></table></figure></li><li><p>移除并返回列表<code>key</code>的中间元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lrem key count value</span><br></pre></td></tr></tbody></table></figure><p>将删除<code>key</code>这个列表中，<code>count</code>个值为<code>value</code>的元素。</p></li></ul></li><li><p>指定返回第几个元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lindex key index</span><br></pre></td></tr></tbody></table></figure><p>将返回<code>key</code>这个列表中，索引为<code>index</code>的这个元素。</p></li><li><p>获取列表中的元素个数：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">llen key</span><br><span class="line">如：</span><br><span class="line">llen languages</span><br></pre></td></tr></tbody></table></figure></li><li><p>删除指定的元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lrem key count value</span><br><span class="line">如：</span><br><span class="line">lrem languages 0 php</span><br></pre></td></tr></tbody></table></figure><p>根据参数 count 的值，移除列表中与参数 value 相等的元素。<code>count</code>的值可以是以下几种：</p><ul><li>count > 0：从表头开始向表尾搜索，移除与<code>value</code>相等的元素，数量为<code>count</code>。</li><li>count < 0：从表尾开始向表头搜索，移除与 <code>value</code>相等的元素，数量为<code>count</code>的绝对值。</li><li>count = 0：移除表中所有与<code>value</code> 相等的值。</li></ul></li></ul></li><li><p><code>set</code>集合的操作：</p><ul><li><p>添加元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sadd set value1 value2....</span><br><span class="line">如：</span><br><span class="line">sadd team xiaotuo datuo</span><br></pre></td></tr></tbody></table></figure></li><li><p>查看元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">smembers set</span><br><span class="line">如：</span><br><span class="line">smembers team</span><br></pre></td></tr></tbody></table></figure></li><li><p>移除元素：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">srem set member...</span><br><span class="line">如：</span><br><span class="line">srem team xiaotuo datuo</span><br></pre></td></tr></tbody></table></figure></li><li><p>查看集合中的元素个数：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">scard set</span><br><span class="line">如：</span><br><span class="line">scard team1</span><br></pre></td></tr></tbody></table></figure></li><li><p>获取多个集合的交集：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sinter set1 set2</span><br><span class="line">如：</span><br><span class="line">sinter team1 team2</span><br></pre></td></tr></tbody></table></figure></li><li><p>获取多个集合的并集：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sunion set1 set2</span><br><span class="line">如：</span><br><span class="line">sunion team1 team2</span><br></pre></td></tr></tbody></table></figure></li><li><p>获取多个集合的差集：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sdiff set1 set2</span><br><span class="line">如：</span><br><span class="line">sdiff team1 team2</span><br></pre></td></tr></tbody></table></figure></li></ul></li><li><p><code>hash</code>哈希操作：</p><ul><li><p>添加一个新值：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hset key field value</span><br><span class="line">如：</span><br><span class="line">hset website baidu baidu.com</span><br></pre></td></tr></tbody></table></figure><p>将哈希表<code>key</code>中的域<code>field</code>的值设为<code>value</code>。<br>如果<code>key</code>不存在，一个新的哈希表被创建并进行 <code>HSET</code>操作。如果域 <code>field</code>已经存在于哈希表中，旧值将被覆盖。</p></li><li><p>获取哈希中的<code>field</code>对应的值：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hget key field</span><br><span class="line">如：</span><br><span class="line">hget website baidu</span><br></pre></td></tr></tbody></table></figure></li><li><p>删除<code>field</code>中的某个<code>field</code>：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hdel key field</span><br><span class="line">如：</span><br><span class="line">hdel website baidu</span><br></pre></td></tr></tbody></table></figure></li><li><p>获取某个哈希中所有的<code>field</code>和<code>value</code>：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hgetall key</span><br><span class="line">如：</span><br><span class="line">hgetall website</span><br></pre></td></tr></tbody></table></figure></li><li><p>获取某个哈希中所有的<code>field</code>：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hkeys key</span><br><span class="line">如：</span><br><span class="line">hkeys website</span><br></pre></td></tr></tbody></table></figure></li><li><p>获取某个哈希中所有的值：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hvals key</span><br><span class="line">如：</span><br><span class="line">hvals website</span><br></pre></td></tr></tbody></table></figure></li><li><p>判断哈希中是否存在某个<code>field</code>：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexists key field</span><br><span class="line">如：</span><br><span class="line">hexists website baidu</span><br></pre></td></tr></tbody></table></figure></li><li><p>获取哈希中总共的键值对：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hlen field</span><br><span class="line">如：</span><br><span class="line">hlen website</span><br></pre></td></tr></tbody></table></figure></li></ul></li><li><p>事务操作：Redis事务可以一次执行多个命令，事务具有以下特征：</p><ul><li><p>隔离操作：事务中的所有命令都会序列化、按顺序地执行，不会被其他命令打扰。</p></li><li><p>原子操作：事务中的命令要么全部被执行，要么全部都不执行。</p></li><li><p>开启一个事务：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">multi</span><br></pre></td></tr></tbody></table></figure><p>以后执行的所有命令，都在这个事务中执行的。</p></li><li><p>执行事务：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec</span><br></pre></td></tr></tbody></table></figure><p>会将在<code>multi</code>和<code>exec</code>中的操作一并提交。</p></li><li><p>取消事务：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">discard</span><br></pre></td></tr></tbody></table></figure><p>会将<code>multi</code>后的所有命令取消。</p></li><li><p>监视一个或者多个<code>key</code>：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch key...</span><br></pre></td></tr></tbody></table></figure><p>监视一个(或多个)key，如果在事务执行之前这个(或这些) key被其他命令所改动，那么事务将被打断。</p></li><li><p>取消所有<code>key</code>的监视：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unwatch</span><br></pre></td></tr></tbody></table></figure></li></ul></li><li><p>发布/订阅操作：</p><ul><li><p>给某个频道发布消息：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">publish channel message</span><br></pre></td></tr></tbody></table></figure></li><li><p>订阅某个频道的消息：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subscribe channel</span><br></pre></td></tr></tbody></table></figure></li></ul></li></ol></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;1-redis数据库介绍&quot;&gt;&lt;a href=&quot;#1-redis数据库介绍&quot; class=&quot;headerlink&quot; title=&quot;1-redis数据库介绍&quot;&gt;&lt;/a&gt;1-redis数据库介绍&lt;/h1&gt;&lt;h2 id=&quot;概述&quot;&gt;&lt;a href=&quot;#概述&quot; class=&quot;headerlink&quot; title=&quot;概述&quot;&gt;&lt;/a&gt;概述&lt;/h2&gt;
    
    </summary>
    
    
      <category term="python爬虫" scheme="http://philxling.club/categories/python%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="python" scheme="http://philxling.club/tags/python/"/>
    
      <category term="python爬虫" scheme="http://philxling.club/tags/python%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>CrawlSpider</title>
    <link href="http://philxling.club/2022/03/20/python%E7%88%AC%E8%99%AB/18-CrawlSpider/"/>
    <id>http://philxling.club/2022/03/20/python%E7%88%AC%E8%99%AB/18-CrawlSpider/</id>
    <published>2022-03-19T17:22:23.000Z</published>
    <updated>2023-04-06T06:30:22.403Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="3-CrawlSpider"><a href="#3-CrawlSpider" class="headerlink" title="3-CrawlSpider"></a>3-CrawlSpider</h1><p>在上一个糗事百科的爬虫案例中。我们是自己在解析完整个页面后获取下一页的url，然后重新发送一个请求。有时候我们想要这样做，只要满足某个条件的url，都给我进行爬取。那么这时候我们就可以通过<code>CrawlSpider</code>来帮我们完成了。<code>CrawlSpider</code>继承自<code>Spider</code>，只不过是在之前的基础之上增加了新的功能，可以定义爬取的url的规则，以后scrapy碰到满足条件的url都进行爬取，而不用手动的<code>yield Request</code>。</p><a id="more"></a><h2 id="CrawlSpider爬虫："><a href="#CrawlSpider爬虫：" class="headerlink" title="CrawlSpider爬虫："></a>CrawlSpider爬虫：</h2><h3 id="创建CrawlSpider爬虫："><a href="#创建CrawlSpider爬虫：" class="headerlink" title="创建CrawlSpider爬虫："></a>创建CrawlSpider爬虫：</h3><p>之前创建爬虫的方式是通过<code>scrapy genspider [爬虫名字] [域名]</code>的方式创建的。如果想要创建<code>CrawlSpider</code>爬虫，那么应该通过以下命令创建：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy genspider -c crawl [爬虫名字] [域名]</span><br></pre></td></tr></tbody></table></figure><h3 id="LinkExtractors链接提取器："><a href="#LinkExtractors链接提取器：" class="headerlink" title="LinkExtractors链接提取器："></a>LinkExtractors链接提取器：</h3><p>使用<code>LinkExtractors</code>可以不用程序员自己提取想要的url，然后发送请求。这些工作都可以交给<code>LinkExtractors</code>，他会在所有爬的页面中找到满足规则的<code>url</code>，实现自动的爬取。以下对<code>LinkExtractors</code>类做一个简单的介绍：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">scrapy</span>.<span class="title">linkextractors</span>.<span class="title">LinkExtractor</span><span class="params">(</span></span></span><br><span class="line"><span class="class"><span class="params">    allow = <span class="params">()</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    deny = <span class="params">()</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    allow_domains = <span class="params">()</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    deny_domains = <span class="params">()</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    deny_extensions = None,</span></span></span><br><span class="line"><span class="class"><span class="params">    restrict_xpaths = <span class="params">()</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    tags = <span class="params">(<span class="string">'a'</span>,<span class="string">'area'</span>)</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    attrs = <span class="params">(<span class="string">'href'</span>)</span>,</span></span></span><br><span class="line"><span class="class"><span class="params">    canonicalize = True,</span></span></span><br><span class="line"><span class="class"><span class="params">    unique = True,</span></span></span><br><span class="line"><span class="class"><span class="params">    process_value = None</span></span></span><br><span class="line"><span class="class"><span class="params">)</span></span></span><br></pre></td></tr></tbody></table></figure><p>主要参数讲解：</p><ul><li>allow：允许的url。所有满足这个正则表达式的url都会被提取。</li><li>deny：禁止的url。所有满足这个正则表达式的url都不会被提取。</li><li>allow_domains：允许的域名。只有在这个里面指定的域名的url才会被提取。</li><li>deny_domains：禁止的域名。所有在这个里面指定的域名的url都不会被提取。</li><li>restrict_xpaths：严格的xpath。和allow共同过滤链接。</li></ul><h3 id="Rule规则类："><a href="#Rule规则类：" class="headerlink" title="Rule规则类："></a>Rule规则类：</h3><p>定义爬虫的规则类。以下对这个类做一个简单的介绍：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">scrapy</span>.<span class="title">spiders</span>.<span class="title">Rule</span><span class="params">(</span></span></span><br><span class="line"><span class="class"><span class="params">    link_extractor, </span></span></span><br><span class="line"><span class="class"><span class="params">    callback = None, </span></span></span><br><span class="line"><span class="class"><span class="params">    cb_kwargs = None, </span></span></span><br><span class="line"><span class="class"><span class="params">    follow = None, </span></span></span><br><span class="line"><span class="class"><span class="params">    process_links = None, </span></span></span><br><span class="line"><span class="class"><span class="params">    process_request = None</span></span></span><br><span class="line"><span class="class"><span class="params">)</span></span></span><br></pre></td></tr></tbody></table></figure><p>主要参数讲解：</p><ul><li>link_extractor：一个<code>LinkExtractor</code>对象，用于定义爬取规则。</li><li>callback：满足这个规则的url，应该要执行哪个回调函数。因为<code>CrawlSpider</code>使用了<code>parse</code>作为回调函数，因此不要覆盖<code>parse</code>作为回调函数自己的回调函数。</li><li>follow：指定根据该规则从response中提取的链接是否需要跟进。</li><li>process_links：从link_extractor中获取到链接后会传递给这个函数，用来过滤不需要爬取的链接。</li></ul></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;3-CrawlSpider&quot;&gt;&lt;a href=&quot;#3-CrawlSpider&quot; class=&quot;headerlink&quot; title=&quot;3-CrawlSpider&quot;&gt;&lt;/a&gt;3-CrawlSpider&lt;/h1&gt;&lt;p&gt;在上一个糗事百科的爬虫案例中。我们是自己在解析完整个页面后获取下一页的url，然后重新发送一个请求。有时候我们想要这样做，只要满足某个条件的url，都给我进行爬取。那么这时候我们就可以通过&lt;code&gt;CrawlSpider&lt;/code&gt;来帮我们完成了。&lt;code&gt;CrawlSpider&lt;/code&gt;继承自&lt;code&gt;Spider&lt;/code&gt;，只不过是在之前的基础之上增加了新的功能，可以定义爬取的url的规则，以后scrapy碰到满足条件的url都进行爬取，而不用手动的&lt;code&gt;yield Request&lt;/code&gt;。&lt;/p&gt;
    
    </summary>
    
    
      <category term="python爬虫" scheme="http://philxling.club/categories/python%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="python" scheme="http://philxling.club/tags/python/"/>
    
      <category term="python爬虫" scheme="http://philxling.club/tags/python%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>链表</title>
    <link href="http://philxling.club/2020/10/15/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E9%93%BE%E8%A1%A8/"/>
    <id>http://philxling.club/2020/10/15/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E9%93%BE%E8%A1%A8/</id>
    <published>2020-10-15T05:45:10.000Z</published>
    <updated>2020-10-15T06:12:33.079Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><p>有头节点的单链表的增删查</p><a id="more"></a><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 链表</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><stdlib.h></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><stdio.h></span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">LNode</span>{</span></span><br><span class="line"><span class="keyword">int</span> data;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LNode</span> *<span class="title">next</span>;</span></span><br><span class="line">}LNode,*LinkList;</span><br><span class="line"></span><br><span class="line"><span class="function">LNode* <span class="title">initList</span><span class="params">()</span></span>{ <span class="comment">// 初始化</span></span><br><span class="line">LNode *L = (LNode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LNode));</span><br><span class="line"><span class="keyword">if</span>(L == <span class="literal">NULL</span>){</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">}</span><br><span class="line">L->next = <span class="literal">NULL</span>; <span class="comment">// 头节点没有数据</span></span><br><span class="line"><span class="keyword">return</span> L;</span><br><span class="line">}</span><br><span class="line"><span class="function">LNode* <span class="title">makeNode</span><span class="params">(<span class="keyword">int</span> data)</span></span>{ <span class="comment">// 生成节点</span></span><br><span class="line">LNode *Node = (LNode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LNode));</span><br><span class="line">Node->next = <span class="literal">NULL</span>;</span><br><span class="line">Node->data = data;</span><br><span class="line"><span class="keyword">return</span> Node;</span><br><span class="line">}</span><br><span class="line"><span class="function">LNode * <span class="title">createList</span><span class="params">(struct LNode *L)</span></span>{ <span class="comment">// 创建单链表</span></span><br><span class="line"><span class="keyword">int</span> a[] = {<span class="number">12</span>,<span class="number">32</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">54</span>,<span class="number">6</span>,<span class="number">34</span>};</span><br><span class="line"><span class="keyword">int</span> i =<span class="number">0</span>;</span><br><span class="line">LNode *tile = <span class="literal">NULL</span>;</span><br><span class="line">LNode *head = <span class="literal">NULL</span>;</span><br><span class="line">head = L;</span><br><span class="line"><span class="keyword">for</span>(i =<span class="number">0</span>;i<=<span class="keyword">sizeof</span>(a)/<span class="keyword">sizeof</span>(<span class="keyword">int</span>);i++){</span><br><span class="line">LNode * temp = makeNode(a[i]);</span><br><span class="line"><span class="keyword">if</span>(!head->next){</span><br><span class="line">head->next = temp;</span><br><span class="line">tile= temp;</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">tile->next = temp;</span><br><span class="line">tile = temp;</span><br><span class="line">}</span><br><span class="line">tile = temp;</span><br><span class="line">tile->next = <span class="literal">NULL</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">return</span> head;</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printList</span><span class="params">(LinkList L)</span></span>{ <span class="comment">// 打印链表</span></span><br><span class="line">LNode *p = L->next;</span><br><span class="line"><span class="keyword">while</span>(p->next != <span class="literal">NULL</span>){</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%10d"</span>,p->data);</span><br><span class="line">p = p->next;</span><br><span class="line">} </span><br><span class="line">}</span><br><span class="line"><span class="function">LNode* <span class="title">search</span><span class="params">(struct LNode *L,<span class="keyword">int</span> data)</span></span>{ <span class="comment">// 查找</span></span><br><span class="line">LNode *p = L->next;</span><br><span class="line"><span class="keyword">while</span>(p->next != <span class="literal">NULL</span>){</span><br><span class="line"><span class="keyword">if</span>(p && p->data == data){</span><br><span class="line"><span class="keyword">return</span> p;</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">p =p->next;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">getListLength</span><span class="params">(LinkList L)</span></span>{ <span class="comment">// 计算链表的长度</span></span><br><span class="line"><span class="keyword">int</span> length =<span class="number">0</span>,i;</span><br><span class="line">LNode *p =L->next; </span><br><span class="line"><span class="keyword">while</span>(p->next != <span class="literal">NULL</span>){</span><br><span class="line">p = p->next;</span><br><span class="line">length++; </span><br><span class="line">} </span><br><span class="line"><span class="keyword">return</span> length;</span><br><span class="line">} </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertList</span><span class="params">(LinkList L,<span class="keyword">int</span> data,<span class="keyword">int</span> index)</span></span>{ <span class="comment">// 插入链表</span></span><br><span class="line">LNode *p = L;</span><br><span class="line"><span class="keyword">if</span>(index<<span class="number">0</span> || index >getListLength(L)){</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"blunder\n"</span>);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">int</span> j =<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(p&& j<index){</span><br><span class="line">p =p->next;</span><br><span class="line">j++;</span><br><span class="line">}</span><br><span class="line">LNode *newNode = (LinkList)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(LNode));</span><br><span class="line">newNode->data = data;</span><br><span class="line">newNode->next = <span class="literal">NULL</span>;</span><br><span class="line">newNode->next = p->next;</span><br><span class="line">p->next = newNode;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span>   <span class="title">deleteList</span><span class="params">(LinkList L,<span class="keyword">int</span> data)</span></span>{　</span><br><span class="line">LNode *p = L->next; <span class="comment">// p 要删除元素的指针 </span></span><br><span class="line">LNode *temp = L->next; <span class="comment">//  删除元素的前一个位置 </span></span><br><span class="line"><span class="keyword">int</span> length=<span class="number">0</span>;　　　　　　　</span><br><span class="line"><span class="keyword">while</span>(p->next != <span class="literal">NULL</span>){　　　<span class="comment">// 查找元素位置</span></span><br><span class="line"><span class="keyword">if</span>(p && p->data == data){</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line">p =p->next;</span><br><span class="line">length++;</span><br><span class="line">}</span><br><span class="line">} </span><br><span class="line"><span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i<length<span class="number">-1</span>;i++){ <span class="comment">// 找到元素的前一个位置</span></span><br><span class="line">temp = temp->next;</span><br><span class="line">}</span><br><span class="line"><span class="comment">//printf(" length %d\n",length);</span></span><br><span class="line"><span class="comment">//printf("p 的位置 %d\n",p->data);</span></span><br><span class="line"><span class="comment">//printf("q 的位置 %d\n",q->data);</span></span><br><span class="line"><span class="comment">//printf("temp 的位置 %d\n",temp->data);</span></span><br><span class="line">temp->next = p->next; <span class="comment">// 将此元素的前一个位置的指针指向此元素的后一个元素</span></span><br><span class="line"><span class="built_in">free</span>(p);</span><br><span class="line">} </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">LNode *List;</span><br><span class="line">List = initList();</span><br><span class="line">List = createList(List); </span><br><span class="line">printList(List);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"search %d\n"</span>,search(List,<span class="number">1</span>)->data);</span><br><span class="line">printList(List);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">deleteList(List,<span class="number">34</span>);</span><br><span class="line">deleteList(List,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">InsertList(List,<span class="number">100</span>,<span class="number">0</span>);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"InsertList\n"</span>);</span><br><span class="line">printList(List);</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// 链表: 适合很多次插入删除操作</span><br></pre></td></tr></tbody></table></figure></body></html>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;有头节点的单链表的增删查&lt;/p&gt;
    
    </summary>
    
    
      <category term="c" scheme="http://philxling.club/categories/c/"/>
    
    
      <category term="c" scheme="http://philxling.club/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>Android布局属性</title>
    <link href="http://philxling.club/2020/08/10/Android/Android%E5%B8%83%E5%B1%80%E5%B1%9E%E6%80%A7/"/>
    <id>http://philxling.club/2020/08/10/Android/Android%E5%B8%83%E5%B1%80%E5%B1%9E%E6%80%A7/</id>
    <published>2020-08-10T09:28:00.000Z</published>
    <updated>2022-11-18T11:02:54.352Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><p>转载：<a href="http://blog.csdn.net/xiaole0313" target="_blank" rel="noopener">http://blog.csdn.net/xiaole0313</a><br>第一类:属性值为true或false<br>android:layout_centerHrizontal 水平居中 （Hrizontal表示水平）<br>android:layout_centerVertical 垂直居中 （Vertiacl表示垂直）<br>android:layout_centerInparent 相对于父元素完全居中android:layout_alignParentBottom 贴紧父元素的下边缘 （align 表示使什么成为一行）</p><a id="more"></a><p>android:layout_alignParentLeft 贴紧父元素的左边缘<br>android:layout_alignParentRight 贴紧父元素的右边缘<br>android:layout_alignParentTop 贴紧父元素的上边缘<br>android:layout_alignWithParentIfMissing 如果对应的兄弟元素找不到的话就以父元素做参照物<br>第二类：属性值必须为id的引用名”@id/id-name”<br>android:layout_below 在某元素的下方<br>android:layout_above 在某元素的的上方<br>android:layout_toLeftOf 在某元素的左边<br>android:layout_toRightOf 在某元素的右边<br>android:layout_alignTop 本元素的上边缘和某元素的的上边缘对齐<br>android:layout_alignLeft 本元素的左边缘和某元素的的左边缘对齐<br>android:layout_alignBottom 本元素的下边缘和某元素的的下边缘对齐<br>android:layout_alignRight 本元素的右边缘和某元素的的右边缘对齐<br>第三类：属性值为具体的像素值，如30dip，40px<br>android:layout_marginBottom 离某元素底边缘的距离 margin英文是边缘的意思<br>android:layout_marginLeft 离某元素左边缘的距离<br>android:layout_marginRight 离某元素右边缘的距离<br>android:layout_marginTop 离某元素上边缘的距离<br>EditText的属性<br>android:hint 设置EditText为空时输入框内的提示信息。<br>android:gravity属性是对该view 内容的限定．比如一个button 上面的text. 你可以设置该text 在view的靠左，靠右等位置．以button为例，android:gravity=”right”则button上面的文字靠右<br>android:layout_gravity<br>android:layout_gravity是用来设置该view相对与起父view 的位置．比如一个button 在linearlayout里，你想把该button放在靠左、靠右等位置就可以通过该属性设置．以button为例，android:layout_gravity=”right”则button靠右<br>android:scaleType：<br>android:scaleType是控制图片如何resized/moved来匹对ImageView的size。<br>ImageView.ScaleType / android:scaleType值的意义区别：<br>CENTER /center 按图片的原来size居中显示，当图片长/宽超过View的长/宽，则截取图片的居中部分显示<br>CENTER_CROP / centerCrop 按比例扩大图片的size居中显示，使得图片长(宽)等于或大于View的长(宽)<br>CENTER_INSIDE / centerInside 将图片的内容完整居中显示，通过按比例缩小或原来的size使得图片长/宽等于或小于View的长/宽<br>FIT_CENTER / fitCenter 把图片按比例扩大/缩小到View的宽度，居中显示<br>FIT_END / fitEnd 把图片按比例扩大/缩小到View的宽度，显示在View的下部分位置<br>FIT_START / fitStart 把图片按比例扩大/缩小到View的宽度，显示在View的上部分位置<br>FIT_XY / fitXY 把图片�不按比例扩大/缩小到View的大小显示<br>MATRIX / matrix 用矩阵来绘制，动态缩小放大图片来显示。<br>要注意一点，Drawable文件夹里面的图片命名是不能大写的。<br>android:id 为控件指定相应的ID<br>android:text 指定控件当中显示的文字，需要注意的是，这里尽量使用strings.xml文件当中的字符串<br>android:gravity 指定View组件的对齐方式，比如说居中，居右等位置 这里指的是控件中的文本位置并不是控件本身<br>android:layout_gravity 指定Container组件的对齐方式．比如一个button 在linearlayout里，你想把该button放在靠左、靠右等位置就可以通过该属性设置．以button为 例，android:layout_gravity=”right”则button靠右<br>android:textSize 指定控件当中字体的大小<br>android:background 指定该控件所使用的背景色，RGB命名法<br>android:width 指定控件的宽度 控件与组件<br>android:height 指定控件的高度<br>android:layout_width 指定Container组件的宽度<br>android:layout_height 指定Container组件的高度<br>android:layout_weight View中很重要的属性，按比例划分空间<br>android:padding* 指定控件的内边距，也就是说控件当中的内容<br>android:sigleLine 如果设置为真的话，则控件的内容在同一行中进行显示<br>android:scaleType 是控制图片如何resized/moved来匹对ImageView的siz<br>android:layout_centerHrizontal 水平居中<br>android:layout_centerVertical 垂直居中<br>android:layout_centerInparent 相对于父元素完全居中<br>android:layout_alignParentBottom 贴紧父元素的下边缘<br>android:layout_alignParentLeft 贴紧父元素的左边缘<br>android:layout_alignParentRight 贴紧父元素的右边缘<br>android:layout_alignParentTop 贴紧父元素的上边缘<br>android:layout_alignWithParentIfMissing 如果对应的兄弟元素找不到的话就以父元素做参照物<br>android:layout_below 在某元素的下方<br>android:layout_above 在某元素的的上方<br>android:layout_toLeftOf 在某元素的左边<br>android:layout_toRightOf 在某元素的右边<br>android:layout_alignTop 本元素的上边缘和某元素的的上边缘对齐<br>android:layout_alignLeft 本元素的左边缘和某元素的的左边缘对齐<br>android:layout_alignBottom 本元素的下边缘和某元素的的下边缘对齐<br>android:layout_alignRight 本元素的右边缘和某元素的的右边缘对齐<br>android:layout_marginBottom 离某元素底边缘的距离<br>android:layout_marginLeft 离某元素左边缘的距离<br>android:layout_marginRight 离某元素右边缘的距离<br>android:layout_marginTop 离某元素上边缘的距离<br>android:paddingLeft 本元素内容离本元素右边缘的距离<br>android:paddingRight 本元素内容离本元素上边缘的距离<br>android:hint 设置EditText为空时输入框内的提示信息<br>android:LinearLayout 它确定了LinearLayout的方向，其值可以为vertical， 表示垂直布局horizontal， 表示水平布局<br>android:interpolator 可能有很多人不理解它的用法，文档里说的也不太清楚，其实很简单，看下面：interpolator定义一个动画的变化率（the rate of change）。这使得基本的动画效果(alpha, scale, translate, rotate）得以加速，减速，重复等。用通俗的一点的话理解就是：动画的进度使用 Interpolator 控制。interpolator 定义了动画的变化速度，可以实现匀速、正加速、负加速、无规则变加速等。Interpolator 是基类，封装了所有 Interpolator 的共同方法，它只有一个方法，即 getInterpolation (float input)，该方法 maps a point on the timeline to a multiplier to be applied to the transformations of an animation。Android 提供了几个 Interpolator 子类，实现了不同的速度曲线，如下：<br>AccelerateDecelerateInterpolator 在动画开始与介绍的地方速率改变比较慢，在中间的时侯加速<br>AccelerateInterpolator 在动画开始的地方速率改变比较慢，然后开始加速<br>CycleInterpolator 动画循环播放特定的次数，速率改变沿着正弦曲线<br>DecelerateInterpolator 在动画开始的地方速率改变比较慢，然后开始减速<br>LinearInterpolator 在动画的以均匀的速率改变<br>对于 LinearInterpolator ，变化率是个常数，即 f (x) = x.</p><figure class="highlight plain"><figcaption><span>float getInterpolation(float input) {</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">return input;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>Interpolator其他的几个子类，也都是按照特定的算法，实现了对变化率。还可以定义自己的 Interpolator 子类，实现抛物线、自由落体等物理效果。<br><strong>TextView属性汇总</strong><br>android:autoLink 设置是否当文本为URL链接/email/电话号码/map时，文本显示为可点击的链接。可选值(none/web/email/phone/map/all)<br>android:autoText 如果设置，将自动执行输入值的拼写纠正。此处无效果，在显示输入法并输入的时候起作用。<br>android:bufferType 指定getText()方式取得的文本类别。选项editable 类似于StringBuilder可追加字符，也就是说getText后可调用append方法设置文本内容。spannable 则可在给定的字符区域使用样式，参见这里1、这里2。<br>android:capitalize 设置英文字母大写类型。此处无效果，需要弹出输入法才能看得到，参见EditView此属性说明。<br>android:cursorVisible 设定光标为显示/隐藏，默认显示。<br>android:digits 设置允许输入哪些字符。如”1234567890.+-*/% ()”<br>android:drawableBottom 在text的下方输出一个drawable，如图片。如果指定一个颜色的话会把text的背景设为该颜色，并且同时和background使用时覆盖后者。<br>android:drawableLeft 在text的左边输出一个drawable，如图片。<br>android:drawablePadding 设置text与drawable(图片)的间隔，与drawableLeft、 drawableRight、drawableTop、drawableBottom一起使用，可设置为负数，单独使用没有效果。<br>android:drawableRight 在text的右边输出一个drawable。<br>android:drawableTop 在text的正上方输出一个drawable。<br>android:editable 设置是否可编辑。<br>android:editorExtras 设置文本的额外的输入数据。<br>android:ellipsize 设置当文字过长时,该控件该如何显示。有如下值设置：”start”—-省略号显示在开头;”end” ——省略号显示在结尾;”middle”—-省略号显示在中间;”marquee” ——以跑马灯的方式显示(动画横向移动)<br>android:freezesText 设置保存文本的内容以及光标的位置。<br>android:gravity 设置文本位置，如设置成”center”，文本将居中显示。<br>android:hintText 为空时显示的文字提示信息，可通过textColorHint设置提示信息的颜色。此属性在 EditView中使用，但是这里也可以用。<br>android:imeOptions 附加功能，设置右下角IME动作与编辑框相关的动作，如actionDone右下角将显示一个”完成”，而不设置默认是一个回车符号。这个在EditView中再详细说明，此处无用。<br>android:imeActionId 设置IME动作ID。<br>android:imeActionLabel 设置IME动作标签。<br>android:includeFontPadding 设置文本是否包含顶部和底部额外空白，默认为true。<br>android:inputMethod 为文本指定输入法，需要完全限定名(完整的包名)。例如：com.google.android.inputmethod.pinyin，但是这里报错找不到。<br>android:inputType设置文本的类型，用于帮助输入法显示合适的键盘类型。在EditView中再详细说明，这里无效果。<br>android:linksClickable 设置链接是否点击连接，即使设置了autoLink。<br>android:marqueeRepeatLimit 在ellipsize指定marquee的情况下，设置重复滚动的次数，当设置为 marquee_forever时表示无限次。<br>android:ems 设置TextView的宽度为N个字符的宽度。这里测试为一个汉字字符宽度<br>android:maxEms 设置TextView的宽度为最长为N个字符的宽度。与ems同时使用时覆盖ems选项。<br>android:minEms 设置TextView的宽度为最短为N个字符的宽度。与ems同时使用时覆盖ems选项。<br>android:maxLength 限制显示的文本长度，超出部分不显示。<br>android:lines 设置文本的行数，设置两行就显示两行，即使第二行没有数据。<br>android:maxLines 设置文本的最大显示行数，与width或者layout_width结合使用，超出部分自动换行，超出行数将不显示。<br>android:minLines 设置文本的最小行数，与lines类似。<br>android:lineSpacingExtra 设置行间距。<br>android:lineSpacingMultiplier 设置行间距的倍数。如”1.2″<br>android:numeric 如果被设置，该TextView有一个数字输入法。此处无用，设置后唯一效果是TextView有点击效果，此属性在EdtiView将详细说明。<br>android:password 以小点”.”显示文本<br>android:phoneNumber 设置为电话号码的输入方式。<br>android:privateImeOptions 设置输入法选项，此处无用，在EditText将进一步讨论。<br>android:scrollHorizontally 设置文本超出TextView的宽度的情况下，是否出现横拉条。<br>android:selectAllOnFocus 如果文本是可选择的，让他获取焦点而不是将光标移动为文本的开始位置或者末尾位置。 TextView中设置后无效果。<br>android:shadowColor 指定文本阴影的颜色，需要与shadowRadius一起使用。<br>android:shadowDx 设置阴影横向坐标开始位置。<br>android:shadowDy 设置阴影纵向坐标开始位置。<br>android:shadowRadius 设置阴影的半径。设置为0.1就变成字体的颜色了，一般设置为3.0的效果比较好。<br>android:singleLine 设置单行显示。如果和layout_width一起使用，当文本不能全部显示时，后面用”…”来表示。如android:text=”test_ singleLine ”<br>android:singleLine=”true” android:layout_width=”20dp”将只显示”t…”。如果不设置singleLine或者设置为false，文本将自动换行<br>android:text 设置显示文本.<br>android:textAppearance 设置文字外观。如 “?android:attr/textAppearanceLargeInverse”这里引用的是系统自带的一个外观，?表示系统是否有这种外观，否则使用默认的外观。可    </p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><p>android:textColor 设置文本颜色<br>android:textColorHighlight 被选中文字的底色，默认为蓝色<br>android:textColorHint 设置提示信息文字的颜色，默认为灰色。与hint一起使用。<br>android:textColorLink 文字链接的颜色.<br>android:textScaleX 设置文字之间间隔，默认为1.0f。<br>android:textSize 设置文字大小，推荐度量单位”sp”，如”15sp”<br>android:textStyle 设置字形[bold(粗体) 0, italic(斜体) 1, bolditalic(又粗又斜) 2] 可以设置一个或多个，用”|”隔开<br>android:typeface 设置文本字体，必须是以下常量值之一：normal 0, sans 1, serif 2, monospace(等宽字体) 3]<br>android:height 设置文本区域的高度，支持度量单位：px(像素)/dp/sp/in/mm(毫米)<br>android:maxHeight 设置文本区域的最大高度<br>android:minHeight 设置文本区域的最小高度<br>android:width 设置文本区域的宽度，支持度量单位：px(像素)/dp/sp/in/mm(毫米)，与layout_width 的区别看这里。<br>android:maxWidth 设置文本区域的最大宽度<br>android:minWidth 设置文本区域的最小宽度<br>Android activity 属性汇总<br>android:allowTaskReparenting<br>是否允许activity更换从属的任务，比如从短信息任务切换到浏览器任务。<br>android:alwaysRetainTaskState<br>是否保留状态不变， 比如切换回home, 再从新打开， activity处于最后的状态<br>android:clearTaskOnLanunch<br>比如 P 是 activity, Q 是被P 触发的 activity, 然后返回Home, 从新启动 P，是否显示 Q<br>android:configChanges<br>当配置list发生修改时，是否调用 onConfigurationChanged() 方法 比如 “locale|navigation|orientation”.<br>android:enabled activity 是否可以被实例化,<br>android:excludeFromRecents 是否可被显示在最近打开的activity列表里<br>android:exported 是否允许activity被其它程序调用<br>android:finishOnTaskLaunch 是否关闭已打开的activity当用户重新启动这个任务的时候<br>android.icon<br>android:label<br>android:launchMode activity启动方式， “standard” “singleTop” “singleTask” “singleInstance”<br>其中前两个为一组， 后两个为一组<br>android:multiprocess 允许多进程<br>android:name activity的类名， 必须指定<br>androidnHistory 是否需要移除这个activity当用户切换到其他屏幕时。这个属性是 API level 3 中引入的<br>android:permission<br>android:process 一 个activity运行时所在的进程名，所有程序组件运行在应用程序默认的进程中，这个进程名跟应用程序的包名一致。中的元素process属性能够为所有组件设定一个新的默认值。但是任何组件都可以覆盖这个默认值，允许你将你的程序放在多进程中运行。 如果这个属性被分配的名字以:开头，当这个activity运行时, 一个新的专属于这个程序的进程将会被创建。如果这个进程名以小写字母开头，这个activity将会运行在全局的进程中，被它的许可所提供。<br>android:screenOrientation activity显示的模式, “unspecified” 默认值 “landscape” 风景画模式，宽度比高度大一些 “portrait” 肖像模式, 高度比宽度大。 “user” 用户的设置 “behind” “sensor” “nosensor”<br>android:stateNotNeeded 是否 activity被销毁和成功重启并不保存状态<br>android:taskAffinity activity的亲属关系， 默认情况同一个应用程序下的activity有相同的关系<br>android:theme activity的样式主题, 如果没有设置，则activity的主题样式从属于应用程序，参见元素的theme属性<br>android:windowSoftInputMode<br>activity主窗口与软键盘的交互模式, 自从API level 3 被引入<br>活动的主窗口如何与包含屏幕上的软键盘窗口交互。这个属性的设置将会影响两件事情:<br>1> 软键盘的状态——是否它是隐藏或显示——当活动(Activity)成为用户关注的焦点。<br>2> 活动的主窗口调整——是否减少活动主窗口大小以便腾出空间放软键盘或是否当活动窗口的部分被软键盘覆盖时它的内容的当前焦点是可见的。<br>它的设置必须是下面列表中的一个值，或一个”state…”值加一个”adjust…”值的组合。在任一组设置多个值——多个”state…”values，例如＆mdash有未定义的结果。各个值之间用|分开。例如:<br>在这设置的值(除”stateUnspecified”和”adjustUnspecified”以外)将覆盖在主题中设置的值<br>值 描述<br>“stateUnspecified” 软键盘的状态(是否它是隐藏或可见)没有被指定。系统将选择一个合适的状态或依赖于主题的设置。这个是为了软件盘行为默认的设置。<br>“stateUnchanged” 软键盘被保持无论它上次是什么状态，是否可见或隐藏，当主窗口出现在前面时。<br>“stateHidden” 当用户选择该Activity时，软键盘被隐藏——也就是，当用户确定导航到该Activity时，而不是返回到它由于离开另一个Activity。<br>“stateAlwaysHidden” 软键盘总是被隐藏的，当该Activity主窗口获取焦点时。<br>“stateVisible” 软键盘是可见的，当那个是正常合适的时(当用户导航到Activity主窗口时)。<br>“stateAlwaysVisible” 当用户选择这个Activity时，软键盘是可见的——也就是，也就是，当用户确定导航到该Activity时，而不是返回到它由于离开另一个Activity。<br>“adjustUnspecified” 它不被指定是否该Activity主窗口调整大小以便留出软键盘的空间，或是否窗口上的内容得到屏幕上当前的焦点是可见的。系统将自动选择这些模式中一种主要依赖于是否窗口的内容有任何布局视图能够滚动他们的内容。如果有这样的一个视图，这个窗口将调整大小，这样的假设可以使滚动窗口的内容在一个较小的区域中可见的。这个是主窗口默认的行为设置。<br>“adjustResize” 该Activity主窗口总是被调整屏幕的大小以便留出软键盘的空间。<br>“adjustPan” 该Activity主窗口并不调整屏幕的大小以便留出软键盘的空间。相反，当前窗口的内容将自动移动以便当前焦点从不被键盘覆盖和用户能总是看到输入内容的部分。这个通常是不期望比调整大小，因为用户可能关闭软键盘以便获得与被覆盖内容的交互操作。<br>Android EditText 属性汇总<br>android:layout_gravity=”center_vertical” 设置控件显示的位置：默认top，这里居中显示，还有bottom<br>android:hint=”请输入数字！” 设置显示在空间上的提示信息<br>android:numeric=”integer” 设置只能输入整数，如果是小数则是：decimal<br>android:singleLine=”true” 设置单行输入，一旦设置为true，则文字不会自动换行。<br>android:password=”true” 设置只能输入密码<br>android:textColor = “#ff8c00″ 字体颜色<br>android:textStyle=”bold” 字体，bold, italic, bolditalic<br>android:textSize=”20dip” 大小<br>android:capitalize = “characters” 以大写字母写<br>android:textAlign=”center” EditText没有这个属性，但TextView有<br>android:textColorHighlight=”#cccccc” 被选中文字的底色，默认为蓝色<br>android:textColorHint=”#ffff00″ 设置提示信息文字的颜色，默认为灰色<br>android:textScaleX=”1.5″ 控制字与字之间的间距<br>android:typeface=”monospace” 字型，normal, sans, serif, monospace<br>android:background=”@null” 空间背景，这里没有，指透明<br>android:layout_weight=”1″ 权重，控制控件之间的地位,在控制控件显示的大小时蛮有用的。<br>android:textAppearance=”?android:attr/textAppearanceLargeInverse”<br>文字外观，这里引用的是系统自带的一个外观，？表示系统是否有这种外观，否则使用默认的外观。不知道这样理解对不对？<br>通过EditText的layout xml文件中的相关属性来实现:</p><ol><li>密码框属性 android:password=”true” 这条可以让EditText显示的内容自动为星号，输入时内容会在1秒内变成*字样。</li><li>纯数字 android:numeric=”true” 这条可以让输入法自动变为数字输入键盘，同时仅允许0-9的数字输入</li><li>仅允许 android:capitalize=”cwj1987″ 这样仅允许接受输入cwj1987，一般用于密码验证<br>下面是一些扩展的风格属性<br>android:editable=”false” 设置EditText不可编辑<br>android:singleLine=”true” 强制输入的内容在单行<br>android:ellipsize=”end” 自动隐藏尾部溢出数据，一般用于文字内容过长一行无法全部显示时<br>RelativeLayout布局<br>android:layout_marginTop=”25dip” //顶部距离<br>android:gravity=”left” //空间布局位置<br>android:layout_marginLeft=”15dip //距离左边距<br>// 相对于给定ID控件<br>android:layout_above 将该控件的底部置于给定ID的控件之上;<br>android:layout_below 将该控件的底部置于给定ID的控件之下;<br>android:layout_toLeftOf 将该控件的右边缘与给定ID的控件左边缘对齐;<br>android:layout_toRightOf 将该控件的左边缘与给定ID的控件右边缘对齐;<br>android:layout_alignBaseline 将该控件的baseline与给定ID的baseline对齐;<br>android:layout_alignTop 将该控件的顶部边缘与给定ID的顶部边缘对齐;<br>android:layout_alignBottom 将该控件的底部边缘与给定ID的底部边缘对齐;<br>android:layout_alignLeft 将该控件的左边缘与给定ID的左边缘对齐;<br>android:layout_alignRight 将该控件的右边缘与给定ID的右边缘对齐;<br>// 相对于父组件<br>android:layout_alignParentTop 如果为true,将该控件的顶部与其父控件的顶部对齐;<br>android:layout_alignParentBottom 如果为true,将该控件的底部与其父控件的底部对齐;<br>android:layout_alignParentLeft 如果为true,将该控件的左部与其父控件的左部对齐;<br>android:layout_alignParentRight 如果为true,将该控件的右部与其父控件的右部对齐;<br>// 居中<br>android:layout_centerHorizontal 如果为true,将该控件的置于水平居中;<br>android:layout_centerVertical 如果为true,将该控件的置于垂直居中;<br>android:layout_centerInParent 如果为true,将该控件的置于父控件的中央;<br>// 指定移动像素<br>android:layout_marginTop 上偏移的值;<br>android:layout_marginBottom 下偏移的值;<br>android:layout_marginLeft 左偏移的值;<br>android:layout_marginRight 　 右偏移的值;<br>android:id — 为控件指定相应的ID<br>android:text — 指定控件当中显示的文字，需要注意的是，这里尽量使用strings.xml文件当中的字符串<br>android:grivity — 指定控件的基本位置，比如说居中，居右等位置这里指的是控件中的文本位置并不是控件本身。<br>android:textSize — 指定控件当中字体的大小<br>android:background — 指定该控件所使用的背景色，RGB命名法<br>android:width — 指定控件的宽度<br>android:height — 指定控件的高度<br>android:padding* — 指定控件的内边距，也就是说控件当中的内容<br>android:sigleLine — 如果设置为真的话，则控件的内容在同一行中进行显示<br>下边是相对布局属性的说明：RelativeLayout<br>android:layout_above 将该控件的底部至于给定ID控件之上<br>android:layout_below 将该控件的顶部至于给定ID的控件之下<br>android:layout_toLeftOf 将该控件的右边缘和给定ID的控件左边缘对齐<br>android:layout_toRightOf 将该控件的左边缘和给定ID的控件的右边缘对齐<br>android:layout_alignBaseline 该控件的baseline和给定ID的控件的baseline对齐<br>android:layout_alignBottom 将该控件的底部边缘与给定ID控件的底部边缘对齐<br>android:layout_alignLeft 将该控件的左边缘与给定ID控件的左边缘对齐<br>android:layout_alignRight 将该控件的右边缘与给定ID控件的右边缘对齐<br>android:layout_alignTop 将该控件的顶部边缘与给定ID控件的顶部对齐<br>android:alignParentBottom 如果该值为true,则将该控件的底部和父控件的底部对齐<br>android:layout_alignParentLeft 如果该值为true,则将该控件左边与父控件的左边对齐<br>android:layout_alignParentRight 如果该值为true,则将该控件的右边与父控件的右边对齐<br>android:layout_alignParentTop 如果该值为true,则将该控件的顶部与父控件的顶部对齐<br>android:layout_centerHorizontal 如果为真，该控件将被至于水平方向的中央<br>android:layout_centerInParent 如果为真，该控件将被至于父控件水平方向和垂直方向的中央<br>android:layout_centerVertical 如果为真，该控件将被至于垂直方向的中央<br>android:layout_marginLeft此属性用来设置控件之间的间隙（控件和控件之间和内边距不同）<br>android:padding=”3dip”说明了四边的内边距是3dip<br>TableLayout<br>android:orientation=”vertical”<br>android:layout_width=”fill_parent”<br>android:layout_height=”fill_parent”<br>android:stretchColumns=”0″<blockquote></blockquote>android:stretchColumns=”0″第一列作为拉伸列填满整行<br>Java中修饰符总结：<br>1、访问控制修饰符<br>public的访问级别是最高的，其次是protected、默认和private<br>成员变量和成员方法可以处于4个访问级别中的一个：公开、受保护、默认或私有<br>顶层类可以处于公开或默认级别，顶层类不能被protected和private修饰<br>局部变量不能被访问控制修饰符修饰<br>2、abstract修饰符<br>抽象类不能被实例化<br>抽象类中可以没有抽象方法，但包含了抽象方法的类必须被定义为抽象方法<br>如果子类没有实现父类中所有的抽象方法，子类也必须定义为抽象类<br>抽象类不能被定义为private、final、和static类型<br>没有抽象的构造方法<br>抽象方法没有方法体<br>3、final修饰符<br>用final修饰的类不能被继承<br>用final修饰的方法不能被子类的方法覆盖<br>private类型的方法都默认为是final方法，因而不能被子类的方法覆盖<br>final变量必须被显式初始化，并且只能被赋值一次值<br>4、static修饰符<br>静态变量在内存中只有一个拷贝，在类的所有实例中共享<br>在静态方法中不能直接访问实例方法和实例变量<br>在静态方法中不能使用this和super关键字<br>静态方法不能被abstract修饰<br>静态方法和静态变量都可以通过类名直接访问<br>当类被加载时，静态代码块只能被执行一次。类中不同的静态方法代码块按他们在类中出现的顺序被依次执行<br>当多个修饰符连用时，修饰符的顺序可以颠倒，不过作为普遍遵守的编程规范，通常把访问控制修饰符放在首位，其次是static或abstact修饰符，接着就是其他的修饰符<br>5、以下修饰符连用是无意义的，会导致编译错误：<br>abstract与private<br>abstract与final<br>abstract与static</li></ol></body></html>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;转载：&lt;a href=&quot;http://blog.csdn.net/xiaole0313&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://blog.csdn.net/xiaole0313&lt;/a&gt;&lt;br&gt;第一类:属性值为true或false&lt;br&gt;android:layout_centerHrizontal 水平居中 （Hrizontal表示水平）&lt;br&gt;android:layout_centerVertical 垂直居中 （Vertiacl表示垂直）&lt;br&gt;android:layout_centerInparent 相对于父元素完全居中android:layout_alignParentBottom 贴紧父元素的下边缘 （align 表示使什么成为一行）&lt;/p&gt;
    
    </summary>
    
    
      <category term="Android" scheme="http://philxling.club/categories/Android/"/>
    
    
      <category term="Android" scheme="http://philxling.club/tags/Android/"/>
    
  </entry>
  
  <entry>
    <title>Android开发</title>
    <link href="http://philxling.club/2020/07/06/Android/Android/"/>
    <id>http://philxling.club/2020/07/06/Android/Android/</id>
    <published>2020-07-05T16:00:00.000Z</published>
    <updated>2020-10-15T04:26:41.689Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><pre><code>Even miracle take a moment Do what feels right to you</code></pre><h3 id="安卓开发功能"><a href="#安卓开发功能" class="headerlink" title="安卓开发功能"></a>安卓开发功能</h3><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AlbumMainActivity(专辑主页面)，首先初始化页面，获取AlbumList，得到专辑id，onActivityResult用于页面传值。onResume和onPause调用友盟。</span><br></pre></td></tr></tbody></table></figure><a id="more"></a><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// NetHelper 解析，创建单例，用于调用，初始化检查设备在线的状态，如果是wifi，开始局域网扫描，扫描先shotdownNow()，然后通过广播地址（255.255.255.255）,通过定时执行0秒延时，隔3秒，执行线程池中执行发送信号（也就是url，DEVICE_DISCOVERY = "/discovery?param=xiaotingting&port=255.255.255.255";）线程执行sendBroadcast（数据，ip），通过DatagramPacket（就像通信的船），（DatagramSocket是两个港口），其中DatagramPacket会使用四个参数，字节，长度，广播地址（255...），端口号</span></span><br><span class="line"><span class="comment">// 发送广播</span></span><br><span class="line">        mSendSocket.setBroadcast(<span class="keyword">true</span>);</span><br><span class="line">            mSendSocket.setSoTimeout(<span class="number">5000</span>);</span><br><span class="line">            mSendSocket.send(sendPacket);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startVboxPoll</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (mPollExecutor != <span class="keyword">null</span> || mDeviceId == <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> period = isSendLAN ? <span class="number">1</span> : <span class="number">3</span>; <span class="comment">//局域网1秒轮询，远程3秒轮询</span></span><br><span class="line">        mDateCheckOnline = <span class="keyword">new</span> Date();</span><br><span class="line">        mPollExecutor = <span class="keyword">new</span> ScheduledThreadPoolExecutor(<span class="number">1</span>);</span><br><span class="line">        mPollExecutor.scheduleAtFixedRate(<span class="keyword">this</span>::doPollRunnable, <span class="number">0</span>, period, TimeUnit.SECONDS);</span><br><span class="line">    }</span><br><span class="line">    <span class="meta">@SuppressLint</span>(<span class="string">"CheckResult"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">doDiscoverRunnable</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="keyword">if</span> (isInWIFI && !isSendLAN) {</span><br><span class="line"></span><br><span class="line">            <span class="comment">//发送discovery命令</span></span><br><span class="line">            sendDeviceDiscovery();</span><br><span class="line">            <span class="comment">// 此方法用于轮询若是局域网，则1秒轮询，若是远程3秒执行轮询</span></span><br><span class="line">            startVboxPoll();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">        mPollExecutor = <span class="keyword">new</span> ScheduledThreadPoolExecutor(<span class="number">1</span>);</span><br><span class="line">        mPollExecutor.scheduleAtFixedRate(<span class="keyword">this</span>::doPollRunnable, <span class="number">0</span>, period, TimeUnit.SECONDS);</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">long</span> userId)</span> </span>{</span><br><span class="line">        LogUtils.d(<span class="string">"NetHelper 初始化 userId:"</span> + userId);</span><br><span class="line">        <span class="keyword">if</span> (userId == <span class="number">0</span>) {</span><br><span class="line">            closeConnect();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">if</span> (mLanBusiness == <span class="keyword">null</span>) mLanBusiness = <span class="keyword">new</span> LANBusiness();</span><br><span class="line">        <span class="keyword">if</span> (mNetDataHelper == <span class="keyword">null</span>) mNetDataHelper = <span class="keyword">new</span> NetDataHelper();</span><br><span class="line">        <span class="keyword">if</span> (mMQTTBusiness == <span class="keyword">null</span>) mMQTTBusiness = <span class="keyword">new</span> MQTTBusiness();</span><br><span class="line">        mDateRecData = <span class="keyword">null</span>;</span><br><span class="line">        mDateSendPoll = <span class="keyword">null</span>;</span><br><span class="line">        mDateCheckOnline = <span class="keyword">null</span>;</span><br><span class="line">        mNetDataHelper.init(userId);</span><br><span class="line">        mLanBusiness.startListen();</span><br><span class="line">        mMQTTBusiness.init(userId);</span><br><span class="line">        checkDeviceOnline();</span><br><span class="line"></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 设置设备Id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> deviceId</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDeviceId</span><span class="params">(<span class="keyword">long</span> deviceId)</span> </span>{</span><br><span class="line">        mDeviceId = deviceId;</span><br><span class="line">        <span class="keyword">if</span> (mLanBusiness != <span class="keyword">null</span>) mLanBusiness.setDeviceId(deviceId);</span><br><span class="line">        <span class="keyword">if</span> (mMQTTBusiness != <span class="keyword">null</span>) mMQTTBusiness.setDeviceId(deviceId);</span><br><span class="line">        checkDeviceOnline();<span class="comment">//重新切换局域网设备发现</span></span><br><span class="line">        <span class="comment">// 切换设备的话需要重新链接</span></span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">通过局域网的广播发送数据，同网段都能收到</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">play</span><br><span class="line"></span><br><span class="line"> 初始化</span><br><span class="line">     <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setVboxPoll</span><span class="params">(<span class="keyword">boolean</span> isVboxPoll)</span> </span>{</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.isVboxPoll = isVboxPoll;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.isVboxPoll) {</span><br><span class="line">            startVboxPoll();</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            stopVboxPoll();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="comment">//如果设备不是真待机的情况下就打开轮训开关</span></span><br><span class="line">    NetHelper.getInstance().setVboxPoll(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//处理子线程发送的信息</span></span><br><span class="line">    handleMessage() </span><br><span class="line">    <span class="comment">//其余是处理各种点击事件，但是真正的处理逻辑是在AppPlayControlManager里面</span></span><br><span class="line">    <span class="comment">//AppPlayControlManager用于处理真正的逻辑，创建单例，进度条监视器，播放监听，</span></span><br><span class="line"><span class="comment">// PlayManager.getInstance().setAppPlayState(state);设置播放状态为正常或者其他.</span></span><br><span class="line">    <span class="comment">// 初始化PhonePlayView()</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initPhonePlayView</span><span class="params">()</span> </span>{</span><br><span class="line">        <span class="comment">// 初始化界面信息</span></span><br><span class="line">        setAppPlayInfoAndUi(PlayManager.getInstance().getPhoneCurrentVoiceInfo());</span><br><span class="line">        <span class="comment">// 得到播放状态 播放状态可以分为normal playing，pause，error</span></span><br><span class="line">        setAppPlayStateAndUi(PlayManager.getInstance().getAppPlayState());</span><br><span class="line">        <span class="comment">// 得到播放顺序的模式</span></span><br><span class="line">        setAppPlayModeAndUi(PlayManager.getInstance().getPhonePlayMode());</span><br><span class="line">        <span class="comment">// 进度条</span></span><br><span class="line">        setAppUiPlayProgressUi(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">//        initPhonePlayKeyView();</span></span><br><span class="line">        <span class="comment">// </span></span><br><span class="line">        playGifControlTop();</span><br><span class="line">        <span class="comment">//mPlayCoverTopGif.setImageDrawable(mGifDrawable);</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(PlayManager.getInstance().getAppPlayState() == PlayData.APP_PLAY_STATE_PAUSE){</span><br><span class="line">            pauseGifControlTop();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"><span class="comment">// 其余为各种事件的处理</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">//高斯模糊</span></span><br><span class="line"><span class="comment">//        Glide.with(mContext).load(voiceInfo.getCoverUrl()).apply(RequestOptions.bitmapTransform(new BlurTransformation(25,5))).into(new CustomTarget<Drawable>() {</span></span><br><span class="line"><span class="comment">//            @Override</span></span><br><span class="line"><span class="comment">//            public void onResourceReady(@NonNull Drawable resource, @Nullable Transition<? super Drawable> transition) {</span></span><br><span class="line"><span class="comment">//                Drawable drawable = resource.getCurrent();</span></span><br><span class="line"><span class="comment">//                drawable = DrawableCompat.wrap(drawable);</span></span><br><span class="line"><span class="comment">//                drawable.setColorFilter(Color.GRAY, PorterDuff.Mode.MULTIPLY);</span></span><br><span class="line"><span class="comment">//                mPlayMainLayout.setBackground(drawable);</span></span><br><span class="line"><span class="comment">//            }</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            @Override</span></span><br><span class="line"><span class="comment">//            public void onLoadCleared(@Nullable Drawable placeholder) {</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//            }</span></span><br><span class="line"><span class="comment">//        });</span></span><br></pre></td></tr></tbody></table></figure><p>登陆接口采用jbush，采用rustful接口方式，对接后台比较方便，<br>绑定订阅到rxjava </p><p>rxjava的原理，被观察者产生一系列的事件，通过订阅者传递给观察者，观察者通过一些列的事件作出响应的模式（特点：链式调用）</p><p>Rxjava 的优雅实现</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Observable.create(<span class="keyword">new</span> ObservableOnSubscribe<Integer>() {</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(@NonNull ObservableEmitter<Integer> emitter)</span> </span>{</span><br><span class="line">        emitter.onNext(<span class="number">1</span>);</span><br><span class="line">        emitter.onNext(<span class="number">2</span>);</span><br><span class="line">        emitter.onNext(<span class="number">3</span>);</span><br><span class="line">        emitter.onComplete();</span><br><span class="line">    }</span><br><span class="line">}).subscribe(<span class="keyword">new</span> Observer<Integer>() {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(@NonNull Disposable d)</span> </span>{</span><br><span class="line">        Log.e(<span class="string">"TAG"</span>,<span class="string">"onSubscribe"</span>+d);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(@NonNull Integer integer)</span> </span>{</span><br><span class="line">        Log.e(<span class="string">"TAG"</span>,<span class="string">"onNext"</span>+integer);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(@NonNull Throwable e)</span> </span>{</span><br><span class="line">        Log.e(<span class="string">"TAG"</span>,<span class="string">"onError"</span>+e);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>{</span><br><span class="line">        Log.e(<span class="string">"TAG"</span>,<span class="string">"onComplete"</span>);</span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line"><span class="comment">// 基本形式，被观察者.subscribe(观察者)，subscribe 有多个重载版本</span></span><br><span class="line"></span><br><span class="line">Disposable disposable <span class="comment">// 可切断观察者和被观察者的链接</span></span><br></pre></td></tr></tbody></table></figure><img src="/2020/07/06/Android/Android/Rxjava1.png"><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> Observer<Integer>() {</span><br><span class="line">            <span class="keyword">private</span> Disposable disposable;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(@NonNull Disposable d)</span> </span>{</span><br><span class="line">                Log.e(<span class="string">"TAG"</span>,<span class="string">"onSubscribe"</span>+d);</span><br><span class="line">                <span class="keyword">this</span>.disposable = d;</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(@NonNull Integer integer)</span> </span>{</span><br><span class="line">                Log.e(<span class="string">"TAG"</span>,<span class="string">"onNext"</span>+integer);</span><br><span class="line">                <span class="keyword">if</span> (integer == <span class="number">2</span>){</span><br><span class="line">                    disposable.dispose();</span><br><span class="line">                    Log.e(<span class="string">"TAG"</span>,<span class="string">"断开链接"</span>);</span><br><span class="line">                }</span><br><span class="line"></span><br><span class="line">            }</span><br></pre></td></tr></tbody></table></figure><img src="/2020/07/06/Android/Android/Rxjava2.png"><h4 id="Rxjava创建操作符"><a href="#Rxjava创建操作符" class="headerlink" title="Rxjava创建操作符"></a>Rxjava创建操作符</h4><p>Rxjava 快速创建observable<code>just()</code>快速创建，最多发送10个参数</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Observable.just(<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">4</span>).subscribe(<span class="keyword">new</span> Observer<Integer>(){</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(@NonNull Disposable d)</span> </span>{</span><br><span class="line">        </span><br><span class="line">    }</span><br><span class="line">    ...</span><br></pre></td></tr></tbody></table></figure><p>​    <code>fromArray()</code>快速创建一个被观察者对象，发送10个以上事件数组形式</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Integer[] items = {<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>};</span><br><span class="line">Observable.fromArray(items).subscribe(...)</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">额外方法：</span><br><span class="line"></span><br><span class="line">![image-20200814151328887](/Users/philxling/Library/Application Support/typora-user-images/image-20200814151328887.png)</span><br><span class="line"></span><br><span class="line">延迟创建(经过x秒后，自动执行某操作或周期行任务)</span><br><span class="line"></span><br><span class="line">```defer```(直到有观察者时，才动态创建被观察者&发送事件)</span><br><span class="line"></span><br><span class="line">```timer``` 延迟后发送一个事件</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">        Observable.timer(2, TimeUnit.SECONDS).subscribe(new Observer<Long>() {</span><br><span class="line">            @Override</span><br><span class="line">            public void onSubscribe(@NonNull Disposable d) {</span><br><span class="line">                </span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onNext(@NonNull Long aLong) {</span><br><span class="line"></span><br><span class="line">            }</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```java</span><br><span class="line">//interval(第一次延迟时间，间隔时间数字，时间单位)</span><br><span class="line">Observable.interval(3,1,TimeUnit.SECONDS).subscribe(...)</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```java</span><br><span class="line">// 参数1 事件序列起始点没，参数2 事件数量，参数3 第一次事件延迟发送时间，参数4 时间间隔，参数5 时间单位</span><br><span class="line">Observable.interval(3,10,2,1,TimeUnit.SECONDS).subscribe(...)</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```java</span><br><span class="line">/**</span><br><span class="line">* 1 起始点</span><br><span class="line">* 2 事件数量</span><br><span class="line">*/</span><br><span class="line">Observable.range(3,10).subscribe(...)</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><figcaption><span>支持long数据类型</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Rxjava + Retrofit 轮询发送请求</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">implementation 'io.reactivex.rxjava3:rxjava:3.0.4'</span><br><span class="line">implementation 'io.reactivex.rxjava3:rxandroid:3.0.0'</span><br><span class="line"></span><br><span class="line">    // Android 支持 Retrofit</span><br><span class="line">implementation'com.squareup.retrofit2:retrofit:2.1.0'</span><br><span class="line"></span><br><span class="line">    // 支持Gson解析</span><br><span class="line">implementation 'com.squareup.retrofit2:converter-gson:2.1.0'</span><br><span class="line"></span><br><span class="line">implementation 'com.squareup.retrofit2:adapter-rxjava3:2.9.0'</span><br><span class="line">// 添加Rxjava+Retrofit+adapter</span><br></pre></td></tr></tbody></table></figure><p>创建请求接口</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">GetRequest_Interface</span> </span>{</span><br><span class="line">  <span class="meta">@GET</span>(<span class="string">"ajax.php?a=fy&f=auto&t=auto&w=hei%20world"</span>)</span><br><span class="line">  <span class="function">Observable<Translation> <span class="title">getCall</span><span class="params">()</span></span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 会自动封装url</span></span><br><span class="line">提供model</span><br><span class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Translation</span> </span>{</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> status;</span><br><span class="line">    <span class="keyword">private</span> content content;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">content</span></span>{</span><br><span class="line">      <span class="keyword">private</span> String from;</span><br><span class="line">      <span class="keyword">private</span> String to;</span><br><span class="line">      <span class="keyword">private</span> String vendor;</span><br><span class="line">      <span class="keyword">private</span> String out;</span><br><span class="line">      <span class="keyword">private</span> <span class="keyword">int</span> errNo;     </span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">show</span><span class="params">()</span></span>{</span><br><span class="line">      Log.e(<span class="string">"Rxjava"</span>,content.out);</span><br><span class="line">    }</span><br><span class="line">  }</span><br><span class="line"><span class="comment">// 执行请求 2 秒后执行吗，每隔一秒执行请求</span></span><br><span class="line">Observable.interval(<span class="number">2</span>,<span class="number">1</span>,TimeUnit.SECONDS).doOnNext(<span class="keyword">new</span> Consumer<Long>() {</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Long aLong)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">    Log.e(<span class="string">"TAG"</span>,<span class="string">"第"</span> + aLong + <span class="string">"次轮询"</span>);</span><br><span class="line"></span><br><span class="line">    Retrofit retrofit = <span class="keyword">new</span> Retrofit.Builder().baseUrl(<span class="string">"https://fy.iciba.com/"</span>).addConverterFactory(GsonConverterFactory.create()).addCallAdapterFactory(RxJava3CallAdapterFactory.create()).build();</span><br><span class="line">    <span class="comment">// 创建网络请求接口</span></span><br><span class="line">    GetRequest_Interface request_interface = retrofit.create(GetRequest_Interface<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">    <span class="comment">// 封装</span></span><br><span class="line">    Observable<Translation> observable = request_interface.getCall();</span><br><span class="line">    <span class="comment">// 先在io线程执行，在mainThread处理结果</span></span><br><span class="line">    observable.subscribeOn(Schedulers.io()).observeOn(AndroidSchedulers.mainThread()).subscribe(<span class="keyword">new</span> Observer<Translation>() {</span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(@NonNull Disposable d)</span> </span>{</span><br><span class="line"></span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(@NonNull Translation translation)</span> </span>{</span><br><span class="line">        translation.show();</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(@NonNull Throwable e)</span> </span>{</span><br><span class="line">        Log.e(<span class="string">"TAG"</span>,<span class="string">"请求失败"</span>+e);</span><br><span class="line">      }</span><br><span class="line"></span><br><span class="line">      <span class="meta">@Override</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">      }</span><br><span class="line">    });</span><br><span class="line">  }</span><br><span class="line">}).subscribe(<span class="keyword">new</span> Observer<Long>() {</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(@NonNull Disposable d)</span> </span>{</span><br><span class="line"></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(@NonNull Long aLong)</span> </span>{</span><br><span class="line"></span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(@NonNull Throwable e)</span> </span>{</span><br><span class="line">    Log.e(<span class="string">"error"</span>,<span class="string">"处理error"</span>+e);</span><br><span class="line">  }</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>{</span><br><span class="line"></span><br><span class="line">  }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><p><img src="https://upload-images.jianshu.io/upload_images/944365-71eb569b296c1f18.png" alt></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![](https://upload-images.jianshu.io/upload_images/944365-a6f852c071db2f15.png)</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">// 采用RxJava基于事件流的链式操作</span><br><span class="line">        Observable.create(new ObservableOnSubscribe<Integer>() {</span><br><span class="line">            @Override</span><br><span class="line">            public void subscribe(ObservableEmitter<Integer> emitter) throws Exception {</span><br><span class="line">                emitter.onNext(1);</span><br><span class="line">                emitter.onNext(2);</span><br><span class="line">                emitter.onNext(3);</span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            // 采用flatMap（）变换操作符</span><br><span class="line">        }).flatMap(new Function<Integer, ObservableSource<String>>() {</span><br><span class="line">            @Override</span><br><span class="line">            public ObservableSource<String> apply(Integer integer) throws Exception {</span><br><span class="line">                final List<String> list = new ArrayList<>();</span><br><span class="line">                for (int i = 0; i < 3; i++) {</span><br><span class="line">                    list.add("我是事件 " + integer + "拆分后的子事件" + i);</span><br><span class="line">                    // 通过flatMap中将被观察者生产的事件序列先进行拆分，再将每个事件转换为一个新的发送三个String事件</span><br><span class="line">                    // 最终合并，再发送给被观察者</span><br><span class="line">                }</span><br><span class="line">                return Observable.fromIterable(list);</span><br><span class="line">            }</span><br><span class="line">        }).subscribe(new Consumer<String>() {</span><br><span class="line">            @Override</span><br><span class="line">            public void accept(String s) throws Exception {</span><br><span class="line">                Log.d(TAG, s);</span><br><span class="line">            }</span><br><span class="line">        });</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![](https://upload-images.jianshu.io/upload_images/944365-f4340f283e5a954d.png)</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">.concatMap(new Function<Integer, ObservableSource<String>>() {</span><br><span class="line">            @Override</span><br><span class="line">            public ObservableSource<String> apply(Integer integer) throws Exception {</span><br><span class="line">                final List<String> list = new ArrayList<>();</span><br><span class="line">                for (int i = 0; i < 3; i++) {</span><br><span class="line">                    list.add("我是事件 " + integer + "拆分后的子事件" + i);</span><br><span class="line">                    // 通过concatMap中将被观察者生产的事件序列先进行拆分，再将每个事件转换为一个新的发送三个String事件</span><br><span class="line">                    // 最终合并，再发送给被观察者</span><br><span class="line">                }</span><br><span class="line">                return Observable.fromIterable(list);</span><br><span class="line">            }</span><br><span class="line">        }).</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">![](https://upload-images.jianshu.io/upload_images/944365-5278a339e4337494.png)</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">        Observable.just(1,2,3,4,5).buffer(3,1).subscribe(new Observer<List<Integer>>() {</span><br><span class="line">            @Override</span><br><span class="line">            public void onSubscribe(@NonNull Disposable d) {</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onNext(@NonNull List<Integer> integers) {</span><br><span class="line">                Log.e("TAG","buffer"+integers);</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onError(@NonNull Throwable e) {</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void onComplete() {</span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        });</span><br></pre></td></tr></tbody></table></figure><p><img src="/2020/07/06/Android/Android/philxling/blog/source/_posts/Android/image-20200817110844146.png" alt="image-20200817110844146"></p><p>原理：一次接收3个事件，并且步长为一，所以每次指针向后移动一个。</p><p><img src="https://upload-images.jianshu.io/upload_images/944365-33a49ffd2ec60794.png" alt></p><p><img src="https://upload-images.jianshu.io/upload_images/944365-dc0a7df673324e21.png" alt></p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//组合多个观察者</span></span><br><span class="line">concat()/concatArray()<span class="comment">// 组合多个Observable对象 串行发送，concat组合被观察者数量<=4,而concatArray()则可>4</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">        Observable.concat(Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>),</span><br><span class="line">                           Observable.just(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>),</span><br><span class="line">                           Observable.just(<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>),</span><br><span class="line">                           Observable.just(<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>))</span><br><span class="line">          <span class="comment">// 注：串行执行</span></span><br><span class="line">        Observable.concatArray(Observable.just(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>),</span><br><span class="line">                           Observable.just(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>),</span><br><span class="line">                           Observable.just(<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>),</span><br><span class="line">                           Observable.just(<span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>),</span><br><span class="line">                           Observable.just(<span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>))</span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// marge</span></span><br><span class="line">  merge()<span class="comment">// 数量< = 4</span></span><br><span class="line">  mergeArray() <span class="comment">//数量>4 组合被观察者并行执行</span></span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  <span class="comment">// merge（）：组合多个被观察者（＜4个）一起发送数据</span></span><br><span class="line">        <span class="comment">// 注：合并后按照时间线并行执行</span></span><br><span class="line">        Observable.merge(</span><br><span class="line">                Observable.intervalRange(<span class="number">0</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, TimeUnit.SECONDS), <span class="comment">// 从0开始发送、共发送3个数据、第1次事件延迟发送时间 = 1s、间隔时间 = 1s</span></span><br><span class="line">                Observable.intervalRange(<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, TimeUnit.SECONDS)) <span class="comment">// 从2开始发送、共发送3个数据、第1次事件延迟发送时间 = 1s、间隔时间 = 1s</span></span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><figcaption><span>mergeDelayError()```</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"> ```java</span><br><span class="line">// 如果第一个事件发生error则会在后面的事发送完事件后再继续发送。</span><br><span class="line">Observable.concatArrayDelayError(</span><br><span class="line">                Observable.create(new ObservableOnSubscribe<Integer>() {</span><br><span class="line">                    @Override</span><br><span class="line">                    public void subscribe(ObservableEmitter<Integer> emitter) throws Exception {</span><br><span class="line"></span><br><span class="line">                        emitter.onNext(1);</span><br><span class="line">                        emitter.onNext(2);</span><br><span class="line">                        emitter.onNext(3);</span><br><span class="line">                        emitter.onError(new NullPointerException()); // 发送Error事件，因为使用了concatDelayError，所以第2个Observable将会发送事件，等发送完毕后，再发送错误事件</span><br><span class="line">                        emitter.onComplete();</span><br><span class="line">                    }</span><br><span class="line">                }),</span><br><span class="line">                Observable.just(4, 5, 6))</span><br></pre></td></tr></tbody></table></figure><p>Zip()合并多个事件</p><img src="https://upload-images.jianshu.io/upload_images/944365-3fa4b1fd4f561820.png" style="zoom:67%;"><p>组合方式严格按照原先事件序列，进行对位合并，最终合并的事件数量等于多个被观察者中数量最少的数量。</p><p><img src="/2020/07/06/Android/Android/philxling/blog/source/_posts/Android/image-20200817121034116.png" alt="image-20200817121034116"></p><p>在rxjava3中，不会发送没有合并的事件。</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">Observable.zip(Observable.create(<span class="keyword">new</span> ObservableOnSubscribe<Integer>() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(@NonNull ObservableEmitter<Integer> emitter)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">                emitter.onNext(<span class="number">1</span>);</span><br><span class="line">                emitter.onNext(<span class="number">2</span>);</span><br><span class="line">                emitter.onNext(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        }), Observable.create(<span class="keyword">new</span> ObservableOnSubscribe<String>() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(@NonNull ObservableEmitter<String> emitter)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">                emitter.onNext(<span class="string">"A"</span>);</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                emitter.onNext(<span class="string">"B"</span>);</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                emitter.onNext(<span class="string">"C"</span>);</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                emitter.onNext(<span class="string">"D"</span>);</span><br><span class="line">                Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">                emitter.onComplete();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            }</span><br><span class="line">        }).subscribeOn(Schedulers.newThread()), <span class="keyword">new</span> BiFunction<Integer, String, String>() {</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">apply</span><span class="params">(Integer integer, String s)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">                <span class="keyword">return</span> integer+s;</span><br><span class="line">            }</span><br><span class="line">        }).subscribe(<span class="keyword">new</span> Consumer<String>() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(String s)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">                Log.e(<span class="string">"TAG"</span>,s);</span><br><span class="line">            }</span><br><span class="line">        });</span><br></pre></td></tr></tbody></table></figure><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```combineLatestDelayError（）```错误处理</span><br><span class="line"></span><br><span class="line">```reduce()```把被观察者发送的事件聚合成一个事件，聚合的逻辑自己写</span><br><span class="line"></span><br><span class="line">```java</span><br><span class="line">        // reduce()</span><br><span class="line">        Observable.just(1,2,3,4).reduce(new BiFunction<Integer, Integer, Integer>() {</span><br><span class="line">            @Override</span><br><span class="line">            public Integer apply(Integer integer, Integer integer2) throws Throwable {</span><br><span class="line">                return integer * integer2;</span><br><span class="line">            }</span><br><span class="line">        }).subscribe(new Consumer<Integer>() {</span><br><span class="line">            @Override</span><br><span class="line">            public void accept(Integer integer) throws Throwable {</span><br><span class="line">                Log.e("TAG","reduce"+"------------"+integer);</span><br><span class="line">            }</span><br><span class="line">        });</span><br><span class="line">// E/TAG: reduce------------24</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">collect()  <span class="comment">//事件收集到一个数据结构中</span></span><br><span class="line"></span><br><span class="line">startWith() <span class="comment">//  发送事件前追加单个数据</span></span><br><span class="line"></span><br><span class="line">startWithArray() <span class="comment">// 追加多个数据</span></span><br><span class="line"></span><br><span class="line">count() <span class="comment">// 统计被观察者发送事件的数量</span></span><br></pre></td></tr></tbody></table></figure><p>常见的合并/组合操作符</p><p><img src="https://upload-images.jianshu.io/upload_images/944365-214478680237ffb8.png" alt></p><p>例：获取数据，若缓存中有则取缓存，否则取磁盘，否则在请求网络获取数据。</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">String memoryCache = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">String diskCache = <span class="string">"磁盘缓存"</span>;</span><br><span class="line"></span><br><span class="line">Observable memory = Observable.create(<span class="keyword">new</span> ObservableOnSubscribe<String>() {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(@NonNull ObservableEmitter<String> emitter)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">        <span class="keyword">if</span>(memoryCache != <span class="keyword">null</span>){</span><br><span class="line">            emitter.onNext(memoryCache);</span><br><span class="line">        }<span class="keyword">else</span> {</span><br><span class="line">            emitter.onComplete();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line">Observable disk = Observable.create(<span class="keyword">new</span> ObservableOnSubscribe<String>() {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">subscribe</span><span class="params">(@NonNull ObservableEmitter<String> emitter)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">        <span class="keyword">if</span>(diskCache != <span class="keyword">null</span>){</span><br><span class="line">            emitter.onNext(diskCache);</span><br><span class="line">        }<span class="keyword">else</span> {</span><br><span class="line">            emitter.onComplete();</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">});</span><br><span class="line"></span><br><span class="line">Observable network = Observable.just(<span class="string">"从网络获取"</span>);</span><br><span class="line"></span><br><span class="line">Observable.concat(memory,disk,network).firstElement().subscribe(<span class="keyword">new</span> Consumer<String>() {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(String s)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">        Log.e(<span class="string">"TAG"</span>,s);</span><br><span class="line">    }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><p>网络获取多个数据进行合并输出</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建retrofit</span></span><br><span class="line">Retrofit retrofit = <span class="keyword">new</span> Retrofit.Builder().baseUrl(<span class="string">"https://fy.iciba.com/"</span>).addConverterFactory(GsonConverterFactory.create()).addCallAdapterFactory(RxJava3CallAdapterFactory.create()).build();</span><br><span class="line"><span class="comment">// 请求接口</span></span><br><span class="line">        GetRequest_Interface getRequest_interface = retrofit.create(GetRequest_Interface<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">// 新建线程调用</span></span><br><span class="line">        Observable<Translation>  observable = getRequest_interface.getCall().subscribeOn(Schedulers.io());</span><br><span class="line">        Observable<Translation1>  observable1 = getRequest_interface.getCall_2().subscribeOn(Schedulers.io());</span><br><span class="line"><span class="comment">// 合并输出</span></span><br><span class="line">        Observable.zip(observable1, observable, <span class="keyword">new</span> BiFunction<Translation1, Translation, String>() {</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> String <span class="title">apply</span><span class="params">(Translation1 translation1, Translation translation)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">                <span class="keyword">return</span> translation1.show()+translation.show();</span><br><span class="line">            }</span><br><span class="line">        }).subscribe(<span class="keyword">new</span> Consumer<String>() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(String s)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">                Log.e(<span class="string">"TAG"</span>, <span class="string">"最终返回的数据"</span> + s);</span><br><span class="line">            }</span><br><span class="line">        }, <span class="keyword">new</span> Consumer<Throwable>() {</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Throwable throwable)</span> <span class="keyword">throws</span> Throwable </span>{</span><br><span class="line">                Log.e(<span class="string">"TAG"</span>,<span class="string">"登陆失败"</span>);</span><br><span class="line">            }</span><br><span class="line">        });</span><br></pre></td></tr></tbody></table></figure><p><img src="/2020/07/06/Android/Android/philxling/blog/source/_posts/Android/image-20200817171213846.png" alt="image-20200817171213846"></p><p> 利用<code>conbineLatest()</code>进行空值判断：</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 步骤1：设置控件变量 & 绑定</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">EditText name,age,job;</span><br><span class="line">Button list;</span><br><span class="line"></span><br><span class="line">name = (EditText) findViewById(R.id.name);</span><br><span class="line">age = (EditText) findViewById(R.id.age);</span><br><span class="line">job = (EditText) findViewById(R.id.job);</span><br><span class="line">list = (Button) findViewById(R.id.list);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 步骤2：为每个EditText设置被观察者，用于发送监听事件</span></span><br><span class="line"><span class="comment"> * 说明：</span></span><br><span class="line"><span class="comment"> * 1. 此处采用了RxBinding：RxTextView.textChanges(name) = 对对控件数据变更进行监听（功能类似TextWatcher），需要引入依赖：compile 'com.jakewharton.rxbinding2:rxbinding:2.0.0'</span></span><br><span class="line"><span class="comment"> * 2. 传入EditText控件，点击任1个EditText撰写时，都会发送数据事件 = Function3（）的返回值（下面会详细说明）</span></span><br><span class="line"><span class="comment"> * 3. 采用skip(1)原因：跳过 一开始EditText无任何输入时的空值</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">Observable<CharSequence> nameObservable = RxTextView.textChanges(name).skip(<span class="number">1</span>);</span><br><span class="line">Observable<CharSequence> ageObservable = RxTextView.textChanges(age).skip(<span class="number">1</span>);</span><br><span class="line">Observable<CharSequence> jobObservable = RxTextView.textChanges(job).skip(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 步骤3：通过combineLatest（）合并事件 & 联合判断</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line">Observable.combineLatest(nameObservable,ageObservable,jobObservable,<span class="keyword">new</span> Function3<CharSequence, CharSequence, CharSequence,Boolean>() {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Boolean <span class="title">apply</span><span class="params">(@NonNull CharSequence charSequence, @NonNull CharSequence charSequence2, @NonNull CharSequence charSequence3)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * 步骤4：规定表单信息输入不能为空</span></span><br><span class="line"><span class="comment">         **/</span></span><br><span class="line">        <span class="comment">// 1. 姓名信息</span></span><br><span class="line">        <span class="keyword">boolean</span> isUserNameValid = !TextUtils.isEmpty(name.getText()) ;</span><br><span class="line">        <span class="comment">// 除了设置为空，也可设置长度限制</span></span><br><span class="line">        <span class="comment">// boolean isUserNameValid = !TextUtils.isEmpty(name.getText()) && (name.getText().toString().length() > 2 && name.getText().toString().length() < 9);</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 2. 年龄信息</span></span><br><span class="line">        <span class="keyword">boolean</span> isUserAgeValid = !TextUtils.isEmpty(age.getText());</span><br><span class="line">        <span class="comment">// 3. 职业信息</span></span><br><span class="line">        <span class="keyword">boolean</span> isUserJobValid = !TextUtils.isEmpty(job.getText()) ;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * 步骤5：返回信息 = 联合判断，即3个信息同时已填写，"提交按钮"才可点击</span></span><br><span class="line"><span class="comment">         **/</span></span><br><span class="line">        <span class="keyword">return</span> isUserNameValid && isUserAgeValid && isUserJobValid;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">        }).subscribe(<span class="keyword">new</span> Consumer<Boolean>() {</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">accept</span><span class="params">(Boolean s)</span> <span class="keyword">throws</span> Exception </span>{</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * 步骤6：返回结果 & 设置按钮可点击样式</span></span><br><span class="line"><span class="comment">         **/</span></span><br><span class="line">        Log.e(TAG, <span class="string">"提交按钮是否可点击： "</span>+s);</span><br><span class="line">        list.setEnabled(s);</span><br><span class="line">    }</span><br><span class="line">});</span><br></pre></td></tr></tbody></table></figure><p>Rxjava 线程工作原理</p><p><img src="https://upload-images.jianshu.io/upload_images/944365-3997d7540acda975.png" alt></p><table><thead><tr><th>类型</th><th>含义</th><th>应用</th></tr></thead><tbody><tr><td>Schedulers.immediate()</td><td>当前线程=不指定线程</td><td>默认</td></tr><tr><td>AndroidSchedulers.mainThread()</td><td>Android主线程</td><td>main</td></tr><tr><td>Schedulers.newThread()</td><td>常规新线程</td><td>耗时的操作</td></tr><tr><td>Schedulers.io()</td><td>io操作线程</td><td>网络请求，读写文件等io密集型操作</td></tr><tr><td>Schedulers.compution()</td><td>cpu计算线程</td><td>大量计算</td></tr></tbody></table><p>使用：</p><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Observable.subscribeOn()指定</span><br></pre></td></tr></tbody></table></figure><figure class="highlight java"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 整体方法调用顺序：观察者.onSubscribe（）> 被观察者.subscribe（）> 观察者.doOnNext（）>观察者.onNext（）>观察者.onComplete() </span></span><br><span class="line"><span class="comment">// 2. 观察者.onSubscribe（）固定在主线程进行</span></span><br></pre></td></tr></tbody></table></figure></body></html>]]></content>
    
    <summary type="html">
    
      &lt;pre&gt;&lt;code&gt;Even miracle take a moment 
Do what feels right to you&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&quot;安卓开发功能&quot;&gt;&lt;a href=&quot;#安卓开发功能&quot; class=&quot;headerlink&quot; title=&quot;安卓开发功能&quot;&gt;&lt;/a&gt;安卓开发功能&lt;/h3&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&quot;code&quot;&gt;&lt;pre&gt;&lt;span class=&quot;line&quot;&gt;AlbumMainActivity(专辑主页面)，首先初始化页面，获取AlbumList，得到专辑id，onActivityResult用于页面传值。onResume和onPause调用友盟。&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
    
    </summary>
    
    
      <category term="Android" scheme="http://philxling.club/categories/Android/"/>
    
    
  </entry>
  
  <entry>
    <title>UML类图</title>
    <link href="http://philxling.club/2020/06/24/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/UML%E7%B1%BB%E5%9B%BE/"/>
    <id>http://philxling.club/2020/06/24/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/UML%E7%B1%BB%E5%9B%BE/</id>
    <published>2020-06-24T09:31:33.000Z</published>
    <updated>2022-11-18T11:14:37.933Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><p>UML类图用来表示类之间的关系: 采用starUML软件,下载安装,安装node.js,配置环境变量,配置 npm的镜像:<code>npm config set registry https://registry.npm.taobao.org</code>安装asar,<code>npm install -g asar</code>解压程序目录下的resources的app.asar,需要管理员权限<code>copy app.asar app.asar.bak;mkdir TMP; asar extract app.asar TMP;cd TMP/src/engin;修改license-manager.js文件;注释掉UnregisteredDialog.showDialog();修改setStatus(this,true);打包替换app.asar;asar pack TMP app.asar;破解成功</code></p><a id="more"></a><p><img src="/2020/06/24/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/UML%E7%B1%BB%E5%9B%BE/image-20200624174307086.png" alt="image-20200624174307086"></p><p><img src="/2020/06/24/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/UML%E7%B1%BB%E5%9B%BE/image-20200624174510124.png" alt="image-20200624174510124"></p><p>访问权限: + 表示public; - 表示 private; # 表示 protected; ~ 表示package 下划线表示static,斜体表示abstract; : 表示变量类型或方法的返回值;= 表示默认值.</p><p>接口: </p><p><img src="/2020/06/24/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/UML%E7%B1%BB%E5%9B%BE/image-20200624175352787.png" alt="image-20200624175352787"></p><p>关系:</p><p><img src="/2020/06/24/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/UML%E7%B1%BB%E5%9B%BE/image-20200624184945180.png" alt="image-20200624184945180"></p><p> <img src="/2020/06/24/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/UML%E7%B1%BB%E5%9B%BE/image-20200624183403664.png" alt="image-20200624183403664"></p></body></html>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;UML类图用来表示类之间的关系: 采用starUML软件,下载安装,安装node.js,配置环境变量,配置 npm的镜像:&lt;code&gt;npm config set registry https://registry.npm.taobao.org&lt;/code&gt;安装asar,&lt;code&gt;npm install -g asar&lt;/code&gt;解压程序目录下的resources的app.asar,需要管理员权限&lt;code&gt;copy app.asar app.asar.bak;mkdir TMP; asar extract app.asar TMP;cd TMP/src/engin;修改license-manager.js文件;注释掉UnregisteredDialog.showDialog();修改setStatus(this,true);打包替换app.asar;asar pack TMP app.asar;破解成功&lt;/code&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="设计模式" scheme="http://philxling.club/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
      <category term="设计模式" scheme="http://philxling.club/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>linux库函数</title>
    <link href="http://philxling.club/2020/05/26/linux/linuxday2/"/>
    <id>http://philxling.club/2020/05/26/linux/linuxday2/</id>
    <published>2020-05-26T11:02:16.000Z</published>
    <updated>2022-11-18T11:15:14.142Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h1><figure class="highlight plain"><figcaption><span>man```用于查看linux文档，第1章shell命令，第二章库函数，等</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```alias ls```查看ls命令是否被封装</span><br><span class="line"><!--more--></span><br><span class="line">```echo```输出如：```echo $PATH```输出path变量的值</span><br><span class="line"></span><br><span class="line">vim编辑器：命令模式，编辑模式，末行模式；</span><br><span class="line"></span><br><span class="line">![image-20200526193729409](assets/image-20200526193729409.png)</span><br><span class="line"></span><br><span class="line">![image-20200526194253885](assets/image-20200526194253885.png)</span><br><span class="line"></span><br><span class="line">查找```/字符;?字符;#;```/从光标向下查找，？从光标向上查找，#标注这个单词。遍历的快捷键```n/N</span><br></pre></td></tr></tbody></table></figure><p>缩进：向右>>；向左<<。</p><p><img src="/2020/05/26/linux/linuxday2/image-20200526201257734.png" alt="image-20200526201257734"></p><p>gcc编译器：</p><p>​        将文件编译为可执行程序：<code>gcc -E Test.c -o Test.i;gcc -S Test.i -o Test.s;gcc -c Test.s -o Test.o;gcc Test.o -o app;./app</code>也可以直接链接生成可执行程序：<code>gcc test.c -o app</code></p><p><img src="/2020/05/26/linux/linuxday2/image-20200526205940376.png" alt="image-20200526205940376"></p><p>包含头文件：-I  头文件的路径如：<code>gcc sum.c -I /include -o app</code>-D 定义宏；-g gdb调试；-Wail 警告信息</p><p>静态库：</p><p>​        命名：lib+名称+.a 制作步骤：生成.o文件，将.o文件打包。打包用<code>ar rcs 静态库的名字+*.o</code>；用户执行：<code>gcc main.c /lib/libtest.a -o app -Iinclude</code>(头文件)第二种：<code>gcc main.c -L ./lib(库所在的目录) -l test(库的名字，去掉头lib和后缀.a) -o app -Iinclude</code></p><figure class="highlight plain"><figcaption><span>+可执行程序```查看可执行程序。</span></figcaption><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">共享库：</span><br><span class="line"></span><br><span class="line">​lib+名字+.so;生成与位置无关的代码如：```gcc -fPIC -c *.c -I +头文件```;打包：```gcc -shared  -o lib+名字.so *.o -I +头文件```;将so文件和include打包给用户。用户执行：```gcc main.c(测试) /lib/libtest.so(打包共享库) -o app -Iinclude(头文件)</span><br></pre></td></tr></tbody></table></figure><p>用户执行会产生：error while loading shared libraries: libtest.so: cannot open shared object file: No such file or directory；设置环境变量：1 将共享库的目录导入LD_LIBARY_PATH;如：<code>export LD_LIBARY_PATH=./lib</code>是暂时的，关闭终端就会失效2 永久设置：修改配置文件/etc/ld.so.conf 将动态库的目录添加进去(绝对路径)。更新：<code>sudo ldconfig -v</code></p><p>ldd 查看可执行程序在执行的所依赖的所有库。</p><p>gdb调试：</p><p>​        开始运行（r,start）,l 查看代码 l+行号或文件名 设置断点（b +行号或函数名）或者b filename：行号(函数名)n单步，s（stap）单步可以进入函数内部，c直接停在断点。设置条件断点：b +行号 if value=10；删除断点; d+断点编号（info b获取）；从函数体内部跳出：finish，退出当前循环：u；查看变量的值：p；查看变量的类型：ptype+变量名称；设置变量的值：set var+变量名=赋值；设置追踪变量：dispaly；取消追踪变量：undisplay +编号（info display); 退出gdb：quit。</p><p>mkfile的编写：</p><p>​        创建makefile，格式：目标：依赖文件</p><p>​                                                       (前必须有tab空格)命令</p><p>​        执行<code>make</code>,makefile中的变量：</p><p><img src="/2020/05/26/linux/linuxday2/image-20200527042758106.png" alt="image-20200527042758106"></p><p><img src="/2020/05/26/linux/linuxday2/image-20200528200215674.png" alt="image-20200528200215674"></p><p><img src="/2020/05/26/linux/linuxday2/image-20200528204843533.png" alt="image-20200528204843533"></p><p>c系统函数:</p><p>1.文件描述符: int 类型,</p><p>2.pcd: 进程控制块.其中有文件描述符(数组(1024)).</p><p>3.虚拟地址空间: 用户区(0-3G)分布(代码段,未初始化的全局变量,已初始化的全局变量,堆,共享库,栈,环境变量,内核区),内核区(3G-4G)(不允许用户操作)</p><p>open函数: <code>open(文件描述符,什么方式(Q_RDWR));open(文件描述符,什么方式并且创建(Q_RDWR | Q_CREAT),权限)</code></p><p>read函数,write函数:</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> <span class="number">2</span> <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><stdio.h></span></span></span><br><span class="line"> <span class="number">1</span> <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><sys/types.h></span></span></span><br><span class="line"> <span class="number">2</span> <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><stdio.h></span></span></span><br><span class="line"> <span class="number">3</span> <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><stdlib.h></span></span></span><br><span class="line"> <span class="number">4</span> <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><sys/stat.h></span></span></span><br><span class="line"> <span class="number">5</span> <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><unistd.h></span></span></span><br><span class="line"> <span class="number">6</span> <span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><fcntl.h></span></span></span><br><span class="line"> <span class="number">7</span> </span><br><span class="line"> <span class="number">8</span> <span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"> <span class="number">9</span>         <span class="keyword">int</span> fp = <span class="built_in">open</span>(<span class="string">"english.txt"</span>,O_RDONLY);</span><br><span class="line"><span class="number">10</span>         <span class="keyword">if</span>(fp == <span class="number">-1</span>){</span><br><span class="line"><span class="number">11</span>                 perror(<span class="string">"open file"</span>);</span><br><span class="line"><span class="number">12</span>                 <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line"><span class="number">13</span>         }</span><br><span class="line"><span class="number">14</span>         <span class="comment">// 创建新的文件</span></span><br><span class="line"><span class="number">15</span>         <span class="keyword">int</span> fp1 = <span class="built_in">open</span>(<span class="string">"english1.txt"</span>,O_CREAT | O_WRONLY ,<span class="number">0777</span>);</span><br><span class="line"><span class="number">16</span>         <span class="keyword">if</span>(fp1 == <span class="number">-1</span>){</span><br><span class="line"><span class="number">17</span>                 perror(<span class="string">"creat file"</span>);</span><br><span class="line"><span class="number">18</span>                 <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line"><span class="number">19</span>         }</span><br><span class="line"><span class="number">20</span>         <span class="comment">// read file</span></span><br><span class="line"><span class="number">21</span>         <span class="keyword">char</span> buf[<span class="number">1024</span>] = {<span class="number">0</span>};</span><br><span class="line"><span class="number">22</span>         <span class="keyword">int</span> count = <span class="built_in">read</span>(fp,buf,<span class="keyword">sizeof</span>(buf));</span><br><span class="line"><span class="number">23</span>         <span class="keyword">if</span>(count == <span class="number">-1</span>){</span><br><span class="line"><span class="number">24</span>                 perror(<span class="string">"raed file"</span>);</span><br><span class="line"><span class="number">25</span>                 <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line"><span class="number">26</span>         }</span><br><span class="line"><span class="number">27</span>         <span class="keyword">while</span>(count){</span><br><span class="line"><span class="number">28</span>                 <span class="keyword">int</span> ret = <span class="built_in">write</span>(fp1,buf,count);</span><br><span class="line"><span class="number">29</span>                 <span class="built_in">printf</span>(<span class="string">"write byte %d\n"</span>,ret);</span><br><span class="line"><span class="number">30</span>                 count = <span class="built_in">read</span>(fp,buf,<span class="keyword">sizeof</span>(buf));</span><br><span class="line"><span class="number">31</span>         }</span><br><span class="line"><span class="number">32</span>         <span class="comment">// close file</span></span><br><span class="line"><span class="number">33</span>         <span class="built_in">close</span>(fp);</span><br><span class="line"><span class="number">34</span>         <span class="built_in">close</span>(fp1);</span><br><span class="line"><span class="number">35</span> }</span><br></pre></td></tr></tbody></table></figure><p>lseek函数: 能够给文件扩展</p><p><img src="/2020/05/26/linux/linuxday2/image-20200628183100651.png" alt="image-20200628183100651"></p></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;linux&quot;&gt;&lt;a href=&quot;#linux&quot; class=&quot;headerlink&quot; title=&quot;linux&quot;&gt;&lt;/a&gt;linux&lt;/h1&gt;&lt;figure class=&quot;highlight plain&quot;&gt;&lt;fig
      
    
    </summary>
    
    
      <category term="linux" scheme="http://philxling.club/categories/linux/"/>
    
    
      <category term="linux" scheme="http://philxling.club/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>linux</title>
    <link href="http://philxling.club/2020/05/25/linux/linux/"/>
    <id>http://philxling.club/2020/05/25/linux/linux/</id>
    <published>2020-05-25T00:55:59.000Z</published>
    <updated>2020-10-15T04:26:41.909Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="linux"><a href="#linux" class="headerlink" title="linux"></a>linux</h1><p>day1</p><ol><li><p>tree 查看目录结构，需要安装 sudo apt-get install tree(ubuntu)</p></li><li><p>ls 查看指定目录下所有文件和目录信息 参数 -a 显示隐藏文件 -l 显示详细信息。</p></li><li><p>cd 非指令，在/bin目录下不能找到。</p></li><li><p>文件详细9个部分：</p><a id="more"></a><p><img src="/2020/05/25/linux/linux/image-20200525090438306.png" alt="image-20200525090438306"></p></li></ol><p>第一个字母表示文件类型，d：目录，-：普通目录，s：socket文件，p：管道，c：字符设备，l：链接目录 ，b:块设备。后面每三个字母表示文件所有者即：u，同组用户：g，其他人：o。w表示写权限数字2表示，r读权限数字4，x执行权限1.777表示所有者同组用户，其他人都有读写执行权限。后面的数字表示，文件节点，当文件节点为0，表示这块内存可以存放其他文件。</p><p>增加权限：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chmod u/g/o/a+/-/=rwx 文件名 权限的改变</span><br><span class="line">chown 改变文件所属组和文件所有者 如 chown alex:root Test.cpp</span><br><span class="line">chgrp 改变组</span><br></pre></td></tr></tbody></table></figure><p>which 查看命令所在目录<code>which cp</code></p><p>sudo apt-get  clean 清理文件安装包，所在目录<code>/var/cache/apt/archives/</code> </p><p>创建/删除目录  mkdir 目录名 创建多级 mkdir -r 目录名 如：<code>mkdir -r /aa/bb/cc</code>删除目录  rmdir  只能删除空目录或rm -r 递归删除目录以及下的文件。删除文件 rm file  参数 -i用于提示是否删除。</p><p>创建文件  touch  文件名。 </p><p>复制文件  cp file.txt file1.txt 将file的内容复制到file1 文件不存在则创建，文件存在覆盖，cp 复制目录 cp -r  dir1 dir2 递归复制，如果存在会放在dir2中。</p><p>查看文件 cat，more，less，head，tail如：<code>tail -5 Test.cpp</code></p><p>创建链接 软链接（快捷方式）文件路径是绝对路径 ，需要参数-s 如：<code>ln -s /home/a.txt a.test</code></p><p><img src="/2020/05/25/linux/linux/image-20200525093300101.png" alt="image-20200525093300101"></p><p>查找文件 find ，grep 语法： <code>find+路径+-type/-size/-name 类型/大小/名称</code>，如<code>find / -name hello;find /usr/ -name "Test.cpp";find /usr/ -size -10k ;find /usr/bin/ -size +10M -size -15M;find /usr/ -type p</code></p><p>grep 参数-r递归查找 语法：<code>grep -r "查找的关键字"+路径</code></p><p>u盘的挂载卸载：自动挂载在/media下面。手动挂载在/mnt下。<code>fdisk -l</code>查看磁盘 。<code>sudo mount /dev/sdb3 /mnt/</code>手动挂载。</p><p>卸载：不能在使用U盘的目录中卸载<code>umount /mnt</code></p><p>压缩工具：gzip，bzip2 语法：<code>gzip 文件名</code>。<code>bzip2 文件名</code>，bzip的参数-k可以保留文件。解压 <code>gunzip *.gz</code>,不能保留文件。解压：<code>bunzip2 *.bz2</code> 。两个都不能压缩目录。</p><p>tar 参数：c 创建，x释放（解压），v 查看，f 文件名，z使用gzip的方式生成.gz。j使用bzip生成.bz2。</p><p>压缩：<code>tar czvf 文件名.tar.gz+文件或目录；tar cjvf 文件名.tar.bz2+文件或目录</code>。解压缩: <code>tar zxvf  .gz的压缩包  -C（到指定目录）+路径;tar jxvf  .bz2的压缩包  -C（到指定目录）+路径;</code></p><p>rar压缩：需要安装sudo apt-get install rar. <code>rar a 压缩包名（不同后缀）+文件名或目录;rar x 压缩包+路径；</code></p><p>zip压缩：<code>zip 压缩包名（不要后缀）+文件名或目录(目录需要-r)；解压：unzip 压缩包名 -d(到指定目录) +路径;</code></p><p>进程：ps 参数a（列出当前所有用户的信息）u显示丰富，x查看没有终端的应用程序 <code>ps aux</code></p><p>使用管道管理进程：<code>ps aux | grep bash ;kill -l;kill -9 进程ID</code></p><p>查看当前的环境变量 env 并显示PATH <code>env | grep PATH</code> top显示进程滚动 <code>top</code></p><p>网络管理：<code>ifconfig</code> 通讯 ping 如：<code>ping 192.168.0.106 -c 4</code>-c表示回馈4条信息就cut。-i表示多少秒通信一次。</p><p>查看IP： nslookup 如：<code>nslookup www.baidu.com</code></p><p>用户管理：创建用户： <code>sudo adduser +用户名</code>,还可以使用<code>sudo useradd -s /bin/bash -g Robin -d /home/Robin -m Robin</code>会提示Robin组不存在。创建Robin组：<code>sudo groupadd Robin</code>,指定密码：<code>sudo passwd Robin</code>删除用户：<code>sudo deluser 用户名</code>未删除/home/用户名 的内容，需要自己删除。2 <code>sudo userdel -r 用户名</code>删除比较完全，推荐。查看所有用户：<code>vim /etc/passwd</code></p><p>ftp服务器：安装vsftpd 。<code>sudo apt-get install vsftpd;修改配置文件；vim /etc/vsftpd.conf ；listen=YES，anonymous_enable=YES，write_enable=YES，local_umask=022，anon_upload_enable=YES，anon_mkdir_write_enable=YES，重启服务： sudo service vsftpd restart,服务器配置完成</code>客户端的登录上传和下载：使用<code>ftp ip地址（ftp的服务器地址）</code>,上传(只能上传登录ftp服务器前的目录下的文件):put file;下载：get file。匿名用户登录：1 修改配置文件 增加 <code>anon_root=路径；重启服务。客户端登陆：ftp ip；name：anonymous;passwd:空；登录</code>匿名登录只会在anon_root的目录下切换。</p><p>lftp客户端：登录：<code>lftp IP地址;login；可以切换本地目录lcd，上传多个文件mput；下载目录：mirror 目录；上传目录mirror -R 多个目录及其子目录</code></p><p>nfs服务器（用于共享文件夹）：安装： <code>sudo apt-get install nfs-kernel-server;修改配置文件：vim /etc/exports;增加共享目录：/usr/nfsshare/ *(网段)（rw（可读可写）ro（read only）,ayns（同步到磁盘））；重启服务；客户端登陆挂载：mount ip：共享文件夹路径 /mnt；</code>取消挂载：<code>sudo umount /mnt</code></p><p>ssh服务器：<code>sudo apt-get install openssh-server;登陆：ssh 用户名称@ip</code></p><p>scp超级拷贝：<code>scp -r 目标用户名@目标ip：目标目录路径 /保存到本机的绝对路径</code></p></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;linux&quot;&gt;&lt;a href=&quot;#linux&quot; class=&quot;headerlink&quot; title=&quot;linux&quot;&gt;&lt;/a&gt;linux&lt;/h1&gt;&lt;p&gt;day1&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;tree 查看目录结构，需要安装 sudo apt-get install tree(ubuntu)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ls 查看指定目录下所有文件和目录信息 参数 -a 显示隐藏文件 -l 显示详细信息。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;cd 非指令，在/bin目录下不能找到。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;文件详细9个部分：&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;
    
    </summary>
    
    
      <category term="linux" scheme="http://philxling.club/categories/linux/"/>
    
    
      <category term="linux" scheme="http://philxling.club/tags/linux/"/>
    
  </entry>
  
  <entry>
    <title>mui框架</title>
    <link href="http://philxling.club/2020/05/22/%E5%89%8D%E7%AB%AF/mui%E6%A1%86%E6%9E%B6/"/>
    <id>http://philxling.club/2020/05/22/%E5%89%8D%E7%AB%AF/mui%E6%A1%86%E6%9E%B6/</id>
    <published>2020-05-22T15:17:02.000Z</published>
    <updated>2020-10-15T04:26:42.003Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="mui框架"><a href="#mui框架" class="headerlink" title="mui框架"></a>mui框架</h1><p>mui框架很坑。</p></body></html>]]></content>
    
    <summary type="html">
    
      
      
        &lt;html&gt;&lt;head&gt;&lt;/head&gt;&lt;body&gt;&lt;h1 id=&quot;mui框架&quot;&gt;&lt;a href=&quot;#mui框架&quot; class=&quot;headerlink&quot; title=&quot;mui框架&quot;&gt;&lt;/a&gt;mui框架&lt;/h1&gt;&lt;p&gt;mui框架很坑。&lt;/p&gt;
&lt;/body&gt;&lt;/html&gt;
      
    
    </summary>
    
    
      <category term="前端" scheme="http://philxling.club/categories/%E5%89%8D%E7%AB%AF/"/>
    
    
      <category term="前端" scheme="http://philxling.club/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>框架快速入门</title>
    <link href="http://philxling.club/2020/04/29/python%E7%88%AC%E8%99%AB/17-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/"/>
    <id>http://philxling.club/2020/04/29/python%E7%88%AC%E8%99%AB/17-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/</id>
    <published>2020-04-28T17:22:23.000Z</published>
    <updated>2020-10-15T04:26:41.928Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="2-快速入门"><a href="#2-快速入门" class="headerlink" title="2-快速入门"></a>2-快速入门</h1><h2 id="安装和文档："><a href="#安装和文档：" class="headerlink" title="安装和文档："></a>安装和文档：</h2><ol><li><p>安装：通过<code>pip install scrapy</code>即可安装。</p></li><li><p>Scrapy官方文档：<a href="http://doc.scrapy.org/en/latest" target="_blank" rel="noopener">http://doc.scrapy.org/en/latest</a></p></li><li><p>Scrapy中文文档：<a href="http://scrapy-chs.readthedocs.io/zh_CN/latest/index.html" target="_blank" rel="noopener">http://scrapy-chs.readthedocs.io/zh_CN/latest/index.html</a></p><a id="more"></a></li></ol><blockquote><p>注意：</p><ol><li>在<code>ubuntu</code>上安装<code>scrapy</code>之前，需要先安装以下依赖：<br><code>sudo apt-get install python3-dev build-essential python3-pip libxml2-dev libxslt1-dev zlib1g-dev libffi-dev libssl-dev</code>，然后再通过<code>pip install scrapy</code>安装。</li><li>如果在<code>windows</code>系统下，提示这个错误<code>ModuleNotFoundError: No module named 'win32api'</code>，那么使用以下命令可以解决：<code>pip install pypiwin32</code>。</li></ol></blockquote><h2 id="快速入门："><a href="#快速入门：" class="headerlink" title="快速入门："></a>快速入门：</h2><h3 id="创建项目："><a href="#创建项目：" class="headerlink" title="创建项目："></a>创建项目：</h3><p>要使用<code>Scrapy</code>框架创建项目，需要通过命令来创建。首先进入到你想把这个项目存放的目录。然后使用以下命令创建：</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy startproject [项目名称]</span><br></pre></td></tr></tbody></table></figure><h3 id="目录结构介绍："><a href="#目录结构介绍：" class="headerlink" title="目录结构介绍："></a>目录结构介绍：</h3><p><img src="/2020/04/29/python%E7%88%AC%E8%99%AB/17-%E5%BF%AB%E9%80%9F%E5%85%A5%E9%97%A8/assets/QQ%E6%88%AA%E5%9B%BE20171212213138.png" alt="img"><br>以下介绍下主要文件的作用：</p><ol><li>items.py：用来存放爬虫爬取下来数据的模型。</li><li>middlewares.py：用来存放各种中间件的文件。</li><li>pipelines.py：用来将<code>items</code>的模型存储到本地磁盘中。</li><li>settings.py：本爬虫的一些配置信息（比如请求头、多久发送一次请求、ip代理池等）。</li><li>scrapy.cfg：项目的配置文件。</li><li>spiders包：以后所有的爬虫，都是存放到这个里面。</li></ol><h3 id="使用Scrapy框架爬取糗事百科段子："><a href="#使用Scrapy框架爬取糗事百科段子：" class="headerlink" title="使用Scrapy框架爬取糗事百科段子："></a>使用Scrapy框架爬取糗事百科段子：</h3><h4 id="使用命令创建一个爬虫："><a href="#使用命令创建一个爬虫：" class="headerlink" title="使用命令创建一个爬虫："></a>使用命令创建一个爬虫：</h4><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scrapy gensipder qsbk "qiushibaike.com"</span><br></pre></td></tr></tbody></table></figure><p>创建了一个名字叫做<code>qsbk</code>的爬虫，并且能爬取的网页只会限制在<code>qiushibaike.com</code>这个域名下。</p><h4 id="爬虫代码解析："><a href="#爬虫代码解析：" class="headerlink" title="爬虫代码解析："></a>爬虫代码解析：</h4><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QsbkSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">'qsbk'</span></span><br><span class="line">    allowed_domains = [<span class="string">'qiushibaike.com'</span>]</span><br><span class="line">    start_urls = [<span class="string">'http://qiushibaike.com/'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        <span class="keyword">pass</span></span><br></pre></td></tr></tbody></table></figure><p>其实这些代码我们完全可以自己手动去写，而不用命令。只不过是不用命令，自己写这些代码比较麻烦。<br>要创建一个Spider，那么必须自定义一个类，继承自<code>scrapy.Spider</code>，然后在这个类中定义三个属性和一个方法。</p><ol><li>name：这个爬虫的名字，名字必须是唯一的。</li><li>allow_domains：允许的域名。爬虫只会爬取这个域名下的网页，其他不是这个域名下的网页会被自动忽略。</li><li>start_urls：爬虫从这个变量中的url开始。</li><li>parse：引擎会把下载器下载回来的数据扔给爬虫解析，爬虫再把数据传给这个<code>parse</code>方法。这个是个固定的写法。这个方法的作用有两个，第一个是提取想要的数据。第二个是生成下一个请求的url。</li></ol><h4 id="修改settings-py代码："><a href="#修改settings-py代码：" class="headerlink" title="修改settings.py代码："></a>修改<code>settings.py</code>代码：</h4><p>在做一个爬虫之前，一定要记得修改<code>setttings.py</code>中的设置。两个地方是强烈建议设置的。</p><ol><li><code>ROBOTSTXT_OBEY</code>设置为False。默认是True。即遵守机器协议，那么在爬虫的时候，scrapy首先去找robots.txt文件，如果没有找到。则直接停止爬取。</li><li><code>DEFAULT_REQUEST_HEADERS</code>添加<code>User-Agent</code>。这个也是告诉服务器，我这个请求是一个正常的请求，不是一个爬虫。</li></ol><h4 id="完成的爬虫代码："><a href="#完成的爬虫代码：" class="headerlink" title="完成的爬虫代码："></a>完成的爬虫代码：</h4><ol><li><p>爬虫部分代码：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="keyword">from</span> abcspider.items <span class="keyword">import</span> QsbkItem</span><br><span class="line">   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QsbkSpider</span><span class="params">(scrapy.Spider)</span>:</span></span><br><span class="line">    name = <span class="string">'qsbk'</span></span><br><span class="line">    allowed_domains = [<span class="string">'qiushibaike.com'</span>]</span><br><span class="line">    start_urls = [<span class="string">'https://www.qiushibaike.com/text/'</span>]</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, response)</span>:</span></span><br><span class="line">        outerbox = response.xpath(<span class="string">"//div[@id='content-left']/div"</span>)</span><br><span class="line">        items = []</span><br><span class="line">        <span class="keyword">for</span> box <span class="keyword">in</span> outerbox:</span><br><span class="line">            author = box.xpath(<span class="string">".//div[contains(@class,'author')]//h2/text()"</span>).extract_first().strip()</span><br><span class="line">            content = box.xpath(<span class="string">".//div[@class='content']/span/text()"</span>).extract_first().strip()</span><br><span class="line">            item = QsbkItem()</span><br><span class="line">            item[<span class="string">"author"</span>] = author</span><br><span class="line">            item[<span class="string">"content"</span>] = content</span><br><span class="line">            items.append(item)</span><br><span class="line">        <span class="keyword">return</span> items</span><br></pre></td></tr></tbody></table></figure></li><li><p>items.py部分代码：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> scrapy</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">QsbkItem</span><span class="params">(scrapy.Item)</span>:</span></span><br><span class="line">    author = scrapy.Field()</span><br><span class="line">    content = scrapy.Field()</span><br></pre></td></tr></tbody></table></figure></li><li><p>pipeline部分代码：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line">   </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AbcspiderPipeline</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">   </span><br><span class="line">        self.items = []</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">process_item</span><span class="params">(self, item, spider)</span>:</span></span><br><span class="line">        self.items.append(dict(item))</span><br><span class="line">        print(<span class="string">"="</span>*<span class="number">40</span>)</span><br><span class="line">        <span class="keyword">return</span> item</span><br><span class="line">   </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">close_spider</span><span class="params">(self,spider)</span>:</span></span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">'qsbk.json'</span>,<span class="string">'w'</span>,encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> fp:</span><br><span class="line">            json.dump(self.items,fp,ensure_ascii=<span class="literal">False</span>)</span><br></pre></td></tr></tbody></table></figure></li></ol><h4 id="运行scrapy项目："><a href="#运行scrapy项目：" class="headerlink" title="运行scrapy项目："></a>运行scrapy项目：</h4><p>运行scrapy项目。需要在终端，进入项目所在的路径，然后<code>scrapy crawl [爬虫名字]</code>即可运行指定的爬虫。如果不想每次都在命令行中运行，那么可以把这个命令写在一个文件中。以后就在pycharm中执行运行这个文件就可以了。比如现在新创建一个文件叫做<code>start.py</code>，然后在这个文件中填入以下代码：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> scrapy <span class="keyword">import</span> cmdline</span><br><span class="line"></span><br><span class="line">cmdline.execute(<span class="string">"scrapy cra</span></span><br></pre></td></tr></tbody></table></figure></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;2-快速入门&quot;&gt;&lt;a href=&quot;#2-快速入门&quot; class=&quot;headerlink&quot; title=&quot;2-快速入门&quot;&gt;&lt;/a&gt;2-快速入门&lt;/h1&gt;&lt;h2 id=&quot;安装和文档：&quot;&gt;&lt;a href=&quot;#安装和文档：&quot; class=&quot;headerlink&quot; title=&quot;安装和文档：&quot;&gt;&lt;/a&gt;安装和文档：&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;p&gt;安装：通过&lt;code&gt;pip install scrapy&lt;/code&gt;即可安装。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Scrapy官方文档：&lt;a href=&quot;http://doc.scrapy.org/en/latest&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://doc.scrapy.org/en/latest&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Scrapy中文文档：&lt;a href=&quot;http://scrapy-chs.readthedocs.io/zh_CN/latest/index.html&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://scrapy-chs.readthedocs.io/zh_CN/latest/index.html&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;&lt;/ol&gt;
    
    </summary>
    
    
      <category term="python爬虫" scheme="http://philxling.club/categories/python%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="python" scheme="http://philxling.club/tags/python/"/>
    
      <category term="python爬虫" scheme="http://philxling.club/tags/python%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>框架架构</title>
    <link href="http://philxling.club/2020/04/25/python%E7%88%AC%E8%99%AB/16-%E6%A1%86%E6%9E%B6%E6%9E%B6%E6%9E%84/"/>
    <id>http://philxling.club/2020/04/25/python%E7%88%AC%E8%99%AB/16-%E6%A1%86%E6%9E%B6%E6%9E%B6%E6%9E%84/</id>
    <published>2020-04-24T19:12:00.000Z</published>
    <updated>2020-10-15T04:26:41.927Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="框架架构"><a href="#框架架构" class="headerlink" title="框架架构"></a>框架架构</h1><h2 id="Scrapy框架介绍："><a href="#Scrapy框架介绍：" class="headerlink" title="Scrapy框架介绍："></a>Scrapy框架介绍：</h2><p>写一个爬虫，需要做很多的事情。比如：发送网络请求、数据解析、数据存储、反反爬虫机制（更换ip代理、设置请求头等）、异步请求等。这些工作如果每次都要自己从零开始写的话，比较浪费时间.<a id="more"></a>因此<code>Scrapy</code>把一些基础的东西封装好了，在他上面写爬虫可以变的更加的高效（爬取效率和开发效率）。因此真正在公司里，一些上了量的爬虫，都是使用<code>Scrapy</code>框架来解决。</p><h2 id="Scrapy架构图："><a href="#Scrapy架构图：" class="headerlink" title="Scrapy架构图："></a>Scrapy架构图：</h2><ol><li>流程图（1）：<br><img src="/2020/04/25/python%E7%88%AC%E8%99%AB/16-%E6%A1%86%E6%9E%B6%E6%9E%B6%E6%9E%84/assets/scrapy_all.png" alt="img"></li><li>流程图（2）：<br><img src="/2020/04/25/python%E7%88%AC%E8%99%AB/16-%E6%A1%86%E6%9E%B6%E6%9E%B6%E6%9E%84/assets/884863172-5985e0b48edf9.png" alt="img"></li></ol><h2 id="Scrapy框架模块功能："><a href="#Scrapy框架模块功能：" class="headerlink" title="Scrapy框架模块功能："></a>Scrapy框架模块功能：</h2><ol><li><code>Scrapy Engine（引擎）</code>：<code>Scrapy</code>框架的核心部分。负责在<code>Spider</code>和<code>ItemPipeline</code>、<code>Downloader</code>、<code>Scheduler</code>中间通信、传递数据等。</li><li><code>Spider（爬虫）</code>：发送需要爬取的链接给引擎，最后引擎把其他模块请求回来的数据再发送给爬虫，爬虫就去解析想要的数据。这个部分是我们开发者自己写的，因为要爬取哪些链接，页面中的哪些数据是我们需要的，都是由程序员自己决定。</li><li><code>Scheduler（调度器）</code>：负责接收引擎发送过来的请求，并按照一定的方式进行排列和整理，负责调度请求的顺序等。</li><li><code>Downloader（下载器）</code>：负责接收引擎传过来的下载请求，然后去网络上下载对应的数据再交还给引擎。</li><li><code>Item Pipeline（管道）</code>：负责将<code>Spider（爬虫）</code>传递过来的数据进行保存。具体保存在哪里，应该看开发者自己的需求。</li><li><code>Downloader Middlewares（下载中间件）</code>：可以扩展下载器和引擎之间通信功能的中间件。</li><li><code>Spider Middlewares（Spider中间件）</code>：可以扩展引擎和爬虫之间通信功能的中间件。</li></ol></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;框架架构&quot;&gt;&lt;a href=&quot;#框架架构&quot; class=&quot;headerlink&quot; title=&quot;框架架构&quot;&gt;&lt;/a&gt;框架架构&lt;/h1&gt;&lt;h2 id=&quot;Scrapy框架介绍：&quot;&gt;&lt;a href=&quot;#Scrapy框架介绍：&quot; class=&quot;headerlink&quot; title=&quot;Scrapy框架介绍：&quot;&gt;&lt;/a&gt;Scrapy框架介绍：&lt;/h2&gt;&lt;p&gt;写一个爬虫，需要做很多的事情。比如：发送网络请求、数据解析、数据存储、反反爬虫机制（更换ip代理、设置请求头等）、异步请求等。这些工作如果每次都要自己从零开始写的话，比较浪费时间.&lt;/p&gt;
    
    </summary>
    
    
      <category term="python爬虫" scheme="http://philxling.club/categories/python%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="python" scheme="http://philxling.club/tags/python/"/>
    
      <category term="python爬虫" scheme="http://philxling.club/tags/python%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>图形验证码识别</title>
    <link href="http://philxling.club/2020/04/22/python%E7%88%AC%E8%99%AB/15-%E5%9B%BE%E5%BD%A2%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB/"/>
    <id>http://philxling.club/2020/04/22/python%E7%88%AC%E8%99%AB/15-%E5%9B%BE%E5%BD%A2%E9%AA%8C%E8%AF%81%E7%A0%81%E8%AF%86%E5%88%AB/</id>
    <published>2020-04-21T17:32:23.000Z</published>
    <updated>2020-10-15T04:26:41.927Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="图形验证码识别"><a href="#图形验证码识别" class="headerlink" title="图形验证码识别"></a>图形验证码识别</h1><p>阻碍我们爬虫的。有时候正是在登录或者请求一些数据时候的图形验证码。因此这里我们讲解一种能将图片翻译成文字的技术。将图片翻译成文字一般被成为光学文字识别（Optical Character Recognition），简写为<code>OCR</code>。<a id="more"></a>实现<code>OCR</code>的库不是很多，特别是开源的。因为这块存在一定的技术壁垒（需要大量的数据、算法、机器学习、深度学习知识等），并且如果做好了具有很高的商业价值。因此开源的比较少。这里介绍一个比较优秀的图像识别开源库：Tesseract。</p><h2 id="Tesseract："><a href="#Tesseract：" class="headerlink" title="Tesseract："></a>Tesseract：</h2><p>Tesseract是一个OCR库，目前由谷歌赞助。Tesseract是目前公认最优秀、最准确的开源OCR库。Tesseract具有很高的识别度，也具有很高的灵活性，他可以通过训练识别任何字体。</p><h3 id="安装："><a href="#安装：" class="headerlink" title="安装："></a>安装：</h3><h4 id="Windows系统："><a href="#Windows系统：" class="headerlink" title="Windows系统："></a>Windows系统：</h4><p>在以下链接下载可执行文件，然后一顿点击下一步安装即可（放在不需要权限的纯英文路径下）：<br><a href="https://github.com/tesseract-ocr/" target="_blank" rel="noopener">https://github.com/tesseract-ocr/</a></p><h4 id="Linux系统："><a href="#Linux系统：" class="headerlink" title="Linux系统："></a>Linux系统：</h4><p>可以在以下链接下载源码自行编译。<br><a href="https://github.com/tesseract-ocr/tesseract/wiki/Compiling" target="_blank" rel="noopener">https://github.com/tesseract-ocr/tesseract/wiki/Compiling</a><br>或者在<code>ubuntu</code>下通过以下命令进行安装：</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install tesseract-ocr</span><br></pre></td></tr></tbody></table></figure><h4 id="Mac系统："><a href="#Mac系统：" class="headerlink" title="Mac系统："></a>Mac系统：</h4><p>用<code>Homebrew</code>即可方便安装：</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install tesseract</span><br></pre></td></tr></tbody></table></figure><h4 id="设置环境变量："><a href="#设置环境变量：" class="headerlink" title="设置环境变量："></a>设置环境变量：</h4><p>安装完成后，如果想要在命令行中使用<code>Tesseract</code>，那么应该设置环境变量。<code>Mac</code>和<code>Linux</code>在安装的时候就默认已经设置好了。在<code>Windows</code>下把<code>tesseract.exe</code>所在的路径添加到<code>PATH</code>环境变量中。</p><p>还有一个环境变量需要设置的是，要把训练的数据文件路径也放到环境变量中。<br>在环境变量中，添加一个<code>TESSDATA_PREFIX=C:\path_to_tesseractdata\teseractdata</code>。</p><h3 id="在命令行中使用tesseract识别图像："><a href="#在命令行中使用tesseract识别图像：" class="headerlink" title="在命令行中使用tesseract识别图像："></a>在命令行中使用tesseract识别图像：</h3><p>如果想要在<code>cmd</code>下能够使用<code>tesseract</code>命令，那么需要把<code>tesseract.exe</code>所在的目录放到<code>PATH</code>环境变量中。然后使用命令：<code>tesseract 图片路径 文件路径</code>。<br>示例：</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tesseract a.png a</span><br></pre></td></tr></tbody></table></figure><p>那么就会识别出<code>a.png</code>中的图片，并且把文字写入到<code>a.txt</code>中。如果不想写入文件直接想显示在终端，那么不要加文件名就可以了。</p><h3 id="在代码中使用tesseract识别图像："><a href="#在代码中使用tesseract识别图像：" class="headerlink" title="在代码中使用tesseract识别图像："></a>在代码中使用tesseract识别图像：</h3><p>在<code>Python</code>代码中操作<code>tesseract</code>。需要安装一个库，叫做<code>pytesseract</code>。通过<code>pip</code>的方式即可安装：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pytesseract</span><br></pre></td></tr></tbody></table></figure><p>并且，需要读取图片，需要借助一个第三方库叫做<code>PIL</code>。通过<code>pip list</code>看下是否安装。如果没有安装，通过<code>pip</code>的方式安装：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install PIL</span><br></pre></td></tr></tbody></table></figure><p>使用<code>pytesseract</code>将图片上的文字转换为文本文字的示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入pytesseract库</span></span><br><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"><span class="comment"># 导入Image库</span></span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定tesseract.exe所在的路径</span></span><br><span class="line">pytesseract.pytesseract.tesseract_cmd = <span class="string">r'D:\ProgramApp\TesseractOCR\tesseract.exe'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开图片</span></span><br><span class="line">image = Image.open(<span class="string">"a.png"</span>)</span><br><span class="line"><span class="comment"># 调用image_to_string将图片转换为文字</span></span><br><span class="line">text = pytesseract.image_to_string(image)</span><br><span class="line">print(text)</span><br></pre></td></tr></tbody></table></figure><h2 id="用pytesseract处理拉勾网图形验证码："><a href="#用pytesseract处理拉勾网图形验证码：" class="headerlink" title="用pytesseract处理拉勾网图形验证码："></a>用<code>pytesseract</code>处理拉勾网图形验证码：</h2><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pytesseract</span><br><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pytesseract.pytesseract.tesseract_cmd = <span class="string">r"D:\ProgramApp\TesseractOCR\tesseract.exe"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    captchaUrl = <span class="string">"https://passport.lagou.com/vcode/create?from=register&refresh=1513081451891"</span></span><br><span class="line">    request.urlretrieve(captchaUrl,<span class="string">'captcha.png'</span>)</span><br><span class="line">    image = Image.open(<span class="string">'captcha.png'</span>)</span><br><span class="line">    text = pytesseract.image_to_string(image,lang=<span class="string">'eng'</span>)</span><br><span class="line">    print(text)</span><br><span class="line">    time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;图形验证码识别&quot;&gt;&lt;a href=&quot;#图形验证码识别&quot; class=&quot;headerlink&quot; title=&quot;图形验证码识别&quot;&gt;&lt;/a&gt;图形验证码识别&lt;/h1&gt;&lt;p&gt;阻碍我们爬虫的。有时候正是在登录或者请求一些数据时候的图形验证码。因此这里我们讲解一种能将图片翻译成文字的技术。将图片翻译成文字一般被成为光学文字识别（Optical Character Recognition），简写为&lt;code&gt;OCR&lt;/code&gt;。&lt;/p&gt;
    
    </summary>
    
    
      <category term="python爬虫" scheme="http://philxling.club/categories/python%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="python" scheme="http://philxling.club/tags/python/"/>
    
      <category term="python爬虫" scheme="http://philxling.club/tags/python%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
  <entry>
    <title>常用算法和排序</title>
    <link href="http://philxling.club/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/"/>
    <id>http://philxling.club/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/</id>
    <published>2020-04-20T15:27:01.000Z</published>
    <updated>2020-10-15T05:42:56.537Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><p>函数对象</p><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200325053739130.png" alt="image-20200325053739130"></p><a id="more"></a><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><iostream></span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myAdd</span>{</span> <span class="comment">// 函数对象 </span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">myAdd(){</span><br><span class="line"><span class="keyword">this</span>->count=<span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{</span><br><span class="line"><span class="keyword">this</span>->count++;</span><br><span class="line"><span class="keyword">return</span> a+b;</span><br><span class="line">} </span><br><span class="line"><span class="comment">//使用属性记录对象调用次数</span></span><br><span class="line"><span class="keyword">int</span> count; </span><br><span class="line">};</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>{</span><br><span class="line">myAdd myadd;</span><br><span class="line"><span class="built_in">cout</span><< myadd(<span class="number">12</span>,<span class="number">43</span>) <<<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span><< myadd(<span class="number">12</span>,<span class="number">43</span>) <<<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span><<myadd.count<<<span class="built_in">endl</span>; <span class="comment">// 2</span></span><br><span class="line">}</span><br><span class="line"> <span class="comment">// 可以作为参数传递</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">doAdd</span><span class="params">(myAdd &myadd,<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{</span><br><span class="line"><span class="built_in">cout</span><<myadd(a,b)<<<span class="built_in">endl</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">test2</span><span class="params">()</span></span>{</span><br><span class="line">myAdd myadd;</span><br><span class="line">doAdd(myadd,<span class="number">12</span>,<span class="number">44</span>);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"><span class="comment">//test1();</span></span><br><span class="line">test2();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>谓词</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><iostream></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><algorithm></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><vector></span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 仿函数 返回值是bool类型, 成为谓词 </span></span><br><span class="line"><span class="comment">// 一元谓词 ,接收一个参数 </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GreatorFind</span>{</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> val)</span></span>{ <span class="comment">// 一元谓词 </span></span><br><span class="line"><span class="keyword">return</span> val><span class="number">5</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">}; </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">myCompare</span>{</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span></span>{ <span class="comment">// 二元谓词 谓词指的是返回bool 二元指的是参数</span></span><br><span class="line"><span class="keyword">return</span> a>b;</span><br><span class="line">}</span><br><span class="line">}; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>{</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i<<span class="number">10</span>;i++){</span><br><span class="line">v.push_back(i);</span><br><span class="line">}</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>>::iterator it=find_if(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),GreatorFind());</span><br><span class="line"><span class="built_in">cout</span><<*it<<<span class="built_in">endl</span>;</span><br><span class="line">sort(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),myCompare());</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">vector</span><<span class="keyword">int</span>>::iterator it=v.<span class="built_in">begin</span>();it!=v.<span class="built_in">end</span>();it++){</span><br><span class="line"><span class="built_in">cout</span><<*it<<<span class="string">" "</span>;</span><br><span class="line">} </span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">9 8 7 6 5 4 3 2 1 0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">test();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>内建仿函数</p><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200325062750741.png" alt="image-20200325062750741"></p><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200325063143207.png" alt="image-20200325063143207"></p><p>关系仿函数</p><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200325063930278.png" alt="image-20200325063930278"></p><p>逻辑仿函数</p><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200325064755552.png" alt="image-20200325064755552"></p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><iostream></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><functional> // 算数仿函数头文件</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><vector></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><algorithm> </span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>{</span><br><span class="line">plus<<span class="keyword">int</span>> p;</span><br><span class="line">negate<<span class="keyword">int</span>> n; </span><br><span class="line"><span class="built_in">cout</span><<p(<span class="number">12</span>,<span class="number">43</span>)<<<span class="built_in">endl</span>; <span class="comment">// 不支持匿名 </span></span><br><span class="line"><span class="built_in">cout</span><<n(<span class="number">129</span>)<<<span class="built_in">endl</span>; <span class="comment">//取反 </span></span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i<<span class="number">9</span>;i++){</span><br><span class="line">v.push_back(i);</span><br><span class="line">}</span><br><span class="line">sort(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),greater<<span class="keyword">int</span>>()); <span class="comment">//关系仿函数  </span></span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">vector</span><<span class="keyword">int</span>>::iterator it=v.<span class="built_in">begin</span>();it!=v.<span class="built_in">end</span>();it++){</span><br><span class="line"><span class="built_in">cout</span><<*it<<<span class="string">" "</span>;  </span><br><span class="line">}</span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>; </span><br><span class="line"><span class="comment">// 逻辑运算符</span></span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">bool</span>> v1;</span><br><span class="line">v1.push_back(<span class="literal">true</span>);</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">bool</span>> v2;</span><br><span class="line">v2.resize(v1.<span class="built_in">size</span>());</span><br><span class="line">transform(v1.<span class="built_in">begin</span>(),v1.<span class="built_in">end</span>(),v2.<span class="built_in">begin</span>(),logical_not<<span class="keyword">bool</span>>());</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">vector</span><<span class="keyword">bool</span>>::iterator it=v2.<span class="built_in">begin</span>();it!=v2.<span class="built_in">end</span>();it++){</span><br><span class="line"><span class="built_in">cout</span><<*it<<<span class="string">" "</span>;  </span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">55</span></span><br><span class="line"><span class="comment">-129</span></span><br><span class="line"><span class="comment">8 7 6 5 4 3 2 1 0</span></span><br><span class="line"><span class="comment">0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">test1();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>常用算法</p><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200325070307861.png" alt="image-20200325070307861"></p><p>常用的遍历算法</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">for_each(begin,end,func)</span><br><span class="line">transform()</span><br></pre></td></tr></tbody></table></figure><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200325072344750.png" alt="image-20200325072344750"></p><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200325090358265.png" alt="image-20200325090358265"></p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><iostream></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><algorithm></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><vector></span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">print1</span>{</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">int</span> val)</span></span>{</span><br><span class="line"><span class="built_in">cout</span><<val<<<span class="string">" "</span>;</span><br><span class="line">}</span><br><span class="line">};</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>{</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">string</span> name;</span><br><span class="line"><span class="keyword">int</span> age;</span><br><span class="line">Person(<span class="built_in">string</span> name,<span class="keyword">int</span> age){</span><br><span class="line"><span class="keyword">this</span>->age=age;</span><br><span class="line"><span class="keyword">this</span>->name=name;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> Person&p){ <span class="comment">//比较规则 </span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">this</span>->name==p.name&&<span class="keyword">this</span>->age==p.age){</span><br><span class="line"><span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">}<span class="keyword">else</span>{</span><br><span class="line"><span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">}; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> val)</span></span>{</span><br><span class="line"><span class="built_in">cout</span><< val <<<span class="string">" "</span>; </span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span></span>{</span><br><span class="line"><span class="comment">// for_each</span></span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i<<span class="number">9</span>;i++){</span><br><span class="line">v.push_back(i);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">for_each(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),<span class="built_in">print</span>); <span class="comment">//遍历</span></span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>;</span><br><span class="line">for_each(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),print1()); <span class="comment">//遍历</span></span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">//常用的查找算法</span></span><br><span class="line"><span class="comment">// find</span></span><br><span class="line"><span class="built_in">vector</span><Person> p;</span><br><span class="line"><span class="function">Person <span class="title">p1</span><span class="params">(<span class="string">"12"</span>,<span class="number">32</span>)</span></span>;</span><br><span class="line"><span class="function">Person <span class="title">p2</span><span class="params">(<span class="string">"43"</span>,<span class="number">32</span>)</span></span>;</span><br><span class="line"><span class="function">Person <span class="title">p3</span><span class="params">(<span class="string">"45"</span>,<span class="number">32</span>)</span></span>;</span><br><span class="line">p.push_back(p1);</span><br><span class="line">p.push_back(p2);</span><br><span class="line">p.push_back(p3);</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>>::iterator it=<span class="built_in">find</span>(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),<span class="number">5</span>); <span class="comment">// 必返回一个迭代器,如果没找到,就返回end </span></span><br><span class="line"><span class="built_in">cout</span><<*it<<<span class="built_in">endl</span>; </span><br><span class="line"><span class="built_in">vector</span><Person>::iterator itp=<span class="built_in">find</span>(p.<span class="built_in">begin</span>(),p.<span class="built_in">end</span>(),p1); <span class="comment">//查找自定义数据类型 </span></span><br><span class="line"><span class="built_in">cout</span><<itp->name<<<span class="string">" "</span><<itp->age<<<span class="built_in">endl</span>;</span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">// find_if</span></span><br><span class="line"><span class="comment">// adjacent_find 查找相邻重复的元素</span></span><br><span class="line"><span class="comment">// binary_search 二分查找 返回值是true 和false  查找的元素必须为有序序列 </span></span><br><span class="line"><span class="built_in">cout</span><<binary_search(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),<span class="number">6</span>)<<<span class="built_in">endl</span>; </span><br><span class="line"><span class="comment">// count 统计 </span></span><br><span class="line"><span class="built_in">cout</span><<count(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),<span class="number">1</span>)<<<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">// count_if</span></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">test1();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200327005701055.png" alt="image-20200327005701055"></p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><iostream></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><vector></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><algorithm></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><ctime></span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> val)</span></span>{</span><br><span class="line"><span class="built_in">cout</span><<val<<<span class="string">" "</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>{</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i<<span class="number">9</span>;i++){</span><br><span class="line">v.push_back(i);</span><br><span class="line">}</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>>  v2;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i<<span class="number">4</span>;i++){</span><br><span class="line">v2.push_back(i);</span><br><span class="line">}</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v3;</span><br><span class="line">v3.resize(v.<span class="built_in">size</span>()+v2.<span class="built_in">size</span>());</span><br><span class="line">merge(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),v2.<span class="built_in">begin</span>(),v2.<span class="built_in">end</span>(),v3.<span class="built_in">begin</span>()); <span class="comment">// merge 合并, 将两个容器合并放到第三个容器中. 且两个容器是有序的,合并后也是有序的 </span></span><br><span class="line">for_each(v3.<span class="built_in">begin</span>(),v3.<span class="built_in">end</span>(),<span class="built_in">print</span>);  </span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>;</span><br><span class="line">reverse(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>());</span><br><span class="line">for_each(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),<span class="built_in">print</span>);</span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>;</span><br><span class="line">random_shuffle(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>()); <span class="comment">// random_shuffle 洗牌,将有序变无序 </span></span><br><span class="line">for_each(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),<span class="built_in">print</span>);</span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>; </span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">srand((<span class="keyword">unsigned</span> <span class="keyword">int</span>)time(<span class="literal">NULL</span>));</span><br><span class="line">test();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200327163741378.png" alt="image-20200327163741378"></p><p>copy算法</p><p>replace替换,将所有相同的都替换</p><p>swap交换同种类型的容器</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// copy(v.begin(),v.end(),v2.begin()); copy </span></span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v;</span><br><span class="line">v.push_back(<span class="number">10</span>);</span><br><span class="line">v.push_back(<span class="number">23</span>);</span><br><span class="line">v.push_back(<span class="number">23</span>);</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v2;</span><br><span class="line">v2.resize(v.<span class="built_in">size</span>());</span><br><span class="line">copy(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),v2.<span class="built_in">begin</span>());</span><br><span class="line">for_each(v2.<span class="built_in">begin</span>(),v2.<span class="built_in">end</span>(),<span class="built_in">print</span>);</span><br><span class="line"><span class="comment">// replace;</span></span><br><span class="line">replace(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),<span class="number">23</span>,<span class="number">2000</span>);</span><br><span class="line">copy(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),v2.<span class="built_in">begin</span>());</span><br><span class="line">for_each(v2.<span class="built_in">begin</span>(),v2.<span class="built_in">end</span>(),<span class="built_in">print</span>);</span><br></pre></td></tr></tbody></table></figure><p>算术生成算法</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><iostream></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><vector></span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><numeric> // 头文件 </span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>{</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>>v;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i<=<span class="number">100</span>;i++){</span><br><span class="line">v.push_back(i);</span><br><span class="line">}</span><br><span class="line"><span class="comment">// 第三个参数是累加起始值. </span></span><br><span class="line"><span class="built_in">cout</span><<accumulate(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),<span class="number">0</span>)<<<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">// fill() 填充新值</span></span><br><span class="line"><span class="comment">//fill()</span></span><br><span class="line"> </span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">test();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>集合算法</p><p><img src="/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200327181910889.png" alt="image-20200327181910889"></p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><iostream></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><vector></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><algorithm></span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="keyword">int</span> val)</span></span>{</span><br><span class="line"><span class="built_in">cout</span><<val<<<span class="string">" "</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>{</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v;</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v2;</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>> v3;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i<<span class="number">10</span>;i++){</span><br><span class="line">v.push_back(i);</span><br><span class="line">v2.push_back(i+<span class="number">5</span>);</span><br><span class="line">} </span><br><span class="line">v3.resize(<span class="built_in">min</span>(v.<span class="built_in">size</span>(),v2.<span class="built_in">size</span>()));</span><br><span class="line"><span class="comment">// 交集 </span></span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>>::iterator it=set_intersection(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),v2.<span class="built_in">begin</span>(),v2.<span class="built_in">end</span>(),v3.<span class="built_in">begin</span>());</span><br><span class="line">for_each(v3.<span class="built_in">begin</span>(),it,<span class="built_in">print</span>); <span class="comment">// 注意 </span></span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>; </span><br><span class="line"><span class="comment">// 并集</span></span><br><span class="line">v3.resize(v.<span class="built_in">size</span>()+v2.<span class="built_in">size</span>());</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>>::iterator vit=set_union(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),v2.<span class="built_in">begin</span>(),v2.<span class="built_in">end</span>(),v3.<span class="built_in">begin</span>());</span><br><span class="line">for_each(v3.<span class="built_in">begin</span>(),vit,<span class="built_in">print</span>); <span class="comment">// 注意 </span></span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>;</span><br><span class="line"><span class="comment">// 补集</span></span><br><span class="line">v3.resize(<span class="built_in">max</span>(v.<span class="built_in">size</span>(),v2.<span class="built_in">size</span>()));</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>>::iterator vdit=set_difference(v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),v2.<span class="built_in">begin</span>(),v2.<span class="built_in">end</span>(),v3.<span class="built_in">begin</span>());</span><br><span class="line">for_each(v3.<span class="built_in">begin</span>(),vdit,<span class="built_in">print</span>); <span class="comment">// 注意 </span></span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>;</span><br><span class="line">v3.resize(<span class="built_in">max</span>(v.<span class="built_in">size</span>(),v2.<span class="built_in">size</span>()));</span><br><span class="line"><span class="built_in">vector</span><<span class="keyword">int</span>>::iterator vmaxit=set_difference(v2.<span class="built_in">begin</span>(),v2.<span class="built_in">end</span>(),v.<span class="built_in">begin</span>(),v.<span class="built_in">end</span>(),v3.<span class="built_in">begin</span>());</span><br><span class="line">for_each(v3.<span class="built_in">begin</span>(),vmaxit,<span class="built_in">print</span>); <span class="comment">// 注意 </span></span><br><span class="line"><span class="built_in">cout</span><<<span class="built_in">endl</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">5 6 7 8 9</span></span><br><span class="line"><span class="comment">0 1 2 3 4 5 6 7 8 9 10 11 12 13 14</span></span><br><span class="line"><span class="comment">0 1 2 3 4</span></span><br><span class="line"><span class="comment">10 11 12 13 14</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">test();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure></body></html>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;函数对象&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/2020/04/20/c++/7-%E5%B8%B8%E7%94%A8%E7%AE%97%E6%B3%95%E5%92%8C%E6%8E%92%E5%BA%8F/image-20200325053739130.png&quot; alt=&quot;image-20200325053739130&quot;&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="c++" scheme="http://philxling.club/categories/c/"/>
    
    
      <category term="c++" scheme="http://philxling.club/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>员工分类案例</title>
    <link href="http://philxling.club/2020/04/17/c++/6-%E5%91%98%E5%B7%A5%E5%88%86%E7%B1%BB%E6%A1%88%E4%BE%8B/"/>
    <id>http://philxling.club/2020/04/17/c++/6-%E5%91%98%E5%B7%A5%E5%88%86%E7%B1%BB%E6%A1%88%E4%BE%8B/</id>
    <published>2020-04-17T15:24:57.000Z</published>
    <updated>2020-10-15T04:26:41.897Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h3 id="员工分类案例"><a href="#员工分类案例" class="headerlink" title="员工分类案例"></a>员工分类案例</h3><a id="more"></a><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><iostream></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><vector></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><map> </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string"><cstdio></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string"><cstdlib></span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string"><ctime></span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">有十个员工,将这些员工随机分配到每个岗位,然后输出每个岗位的人员信息</span></span><br><span class="line"><span class="comment">将10个人放在vector中,然后遍历vector将人随机分配到multimap的容器中</span></span><br><span class="line"><span class="comment">分部门显示员工信息</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Worker</span>{</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"><span class="built_in">string</span> name;</span><br><span class="line"><span class="keyword">int</span> Salary;</span><br><span class="line"><span class="comment">//Worker(string name,int Salary){</span></span><br><span class="line"><span class="comment">//this->name=name;</span></span><br><span class="line"><span class="comment">//this->Salary=Salary;</span></span><br><span class="line"><span class="comment">//}</span></span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">createWorker</span><span class="params">(<span class="built_in">vector</span><Worker> &worker)</span></span>{</span><br><span class="line"><span class="built_in">string</span> name_seed = <span class="string">"ABCDEFGHIJ"</span>; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i<<span class="number">10</span>;i++){</span><br><span class="line">Worker w;</span><br><span class="line">w.name=<span class="string">"员工"</span>;</span><br><span class="line">w.name+=name_seed[i];</span><br><span class="line">w.Salary= rand()%<span class="number">10000</span>+<span class="number">10000</span>; <span class="comment">// 坑 , 一句还执行不了  worker.push_back(Worker("员工"+name_seed[i],rand()%10000+10000));</span></span><br><span class="line">worker.push_back(w); <span class="comment">// 10000-19999</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//for(vector<Worker>::iterator it=worker.begin();it!=Worker.end();it++){</span></span><br><span class="line"><span class="comment">//itWorker()</span></span><br><span class="line"><span class="comment">//}</span></span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printVector</span><span class="params">(<span class="built_in">vector</span><Worker> &worker)</span></span>{</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">vector</span><Worker>::iterator it=worker.<span class="built_in">begin</span>();it!=worker.<span class="built_in">end</span>();it++){</span><br><span class="line"><span class="built_in">cout</span><<<span class="string">"姓名:"</span><< it->name<<<span class="string">" "</span><<<span class="string">"工资:"</span><<it->Salary<<<span class="built_in">endl</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">setGroup</span><span class="params">(<span class="built_in">vector</span><Worker> &worker,<span class="built_in">multimap</span><<span class="keyword">int</span>,Worker> &mworker)</span></span>{</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">vector</span><Worker>::iterator it=worker.<span class="built_in">begin</span>();it!=worker.<span class="built_in">end</span>();it++){</span><br><span class="line"><span class="keyword">int</span> dept = rand()%<span class="number">3</span>; <span class="comment">// 0 1 2 </span></span><br><span class="line">mworker.insert(make_pair(dept,*it));</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printMworker</span><span class="params">(<span class="built_in">multimap</span><<span class="keyword">int</span>,Worker>&worker)</span></span>{ <span class="comment">//  0 A B C  1 F G  2 D E </span></span><br><span class="line"><span class="built_in">cout</span><<<span class="string">"美术--------------"</span><<<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">multimap</span><<span class="keyword">int</span>,Worker>::iterator it=worker.<span class="built_in">begin</span>();it!=worker.<span class="built_in">end</span>();it++){</span><br><span class="line"><span class="keyword">if</span>((*it).first==<span class="number">0</span>){</span><br><span class="line"><span class="built_in">cout</span><<<span class="string">"姓名:"</span><< it->second.name<<<span class="string">" "</span><<<span class="string">"工资:"</span><< it->second.Salary<<<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">} </span><br><span class="line"><span class="built_in">cout</span><<<span class="string">"设计--------------"</span><<<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">multimap</span><<span class="keyword">int</span>,Worker>::iterator it=worker.<span class="built_in">begin</span>();it!=worker.<span class="built_in">end</span>();it++){</span><br><span class="line"><span class="keyword">if</span>((*it).first==<span class="number">1</span>){</span><br><span class="line"><span class="built_in">cout</span><<<span class="string">"姓名:"</span><< it->second.name<<<span class="string">" "</span><<<span class="string">"工资:"</span><< it->second.Salary<<<span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">} </span><br><span class="line"><span class="built_in">cout</span><<<span class="string">"开发---------------"</span><<<span class="built_in">endl</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="built_in">multimap</span><<span class="keyword">int</span>,Worker>::iterator it=worker.<span class="built_in">begin</span>();it!=worker.<span class="built_in">end</span>();it++){</span><br><span class="line"><span class="keyword">if</span>((*it).first==<span class="number">2</span>){</span><br><span class="line"><span class="built_in">cout</span><<<span class="string">"姓名:"</span><< it->second.name<<<span class="string">" "</span><<<span class="string">"工资:"</span><< it->second.Salary<<<span class="built_in">endl</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line">srand((<span class="keyword">unsigned</span> <span class="keyword">int</span> )time(<span class="literal">NULL</span>));</span><br><span class="line"><span class="built_in">vector</span><Worker> vWorker;</span><br><span class="line">createWorker(vWorker);</span><br><span class="line">printVector(vWorker);</span><br><span class="line"><span class="comment">// 员工分组</span></span><br><span class="line"><span class="built_in">multimap</span><<span class="keyword">int</span>,Worker> mWorker;</span><br><span class="line">setGroup(vWorker,mWorker);</span><br><span class="line">printMworker(mWorker);</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">姓名:员工A 工资:15799</span></span><br><span class="line"><span class="comment">姓名:员工B 工资:19029</span></span><br><span class="line"><span class="comment">姓名:员工C 工资:14589</span></span><br><span class="line"><span class="comment">姓名:员工D 工资:11870</span></span><br><span class="line"><span class="comment">姓名:员工E 工资:11106</span></span><br><span class="line"><span class="comment">姓名:员工F 工资:16145</span></span><br><span class="line"><span class="comment">姓名:员工G 工资:12290</span></span><br><span class="line"><span class="comment">姓名:员工H 工资:15171</span></span><br><span class="line"><span class="comment">姓名:员工I 工资:13026</span></span><br><span class="line"><span class="comment">姓名:员工J 工资:19923</span></span><br><span class="line"><span class="comment">美术--------------</span></span><br><span class="line"><span class="comment">姓名:员工B 工资:19029</span></span><br><span class="line"><span class="comment">姓名:员工C 工资:14589</span></span><br><span class="line"><span class="comment">姓名:员工D 工资:11870</span></span><br><span class="line"><span class="comment">姓名:员工F 工资:16145</span></span><br><span class="line"><span class="comment">设计--------------</span></span><br><span class="line"><span class="comment">姓名:员工A 工资:15799</span></span><br><span class="line"><span class="comment">姓名:员工E 工资:11106</span></span><br><span class="line"><span class="comment">姓名:员工J 工资:19923</span></span><br><span class="line"><span class="comment">开发---------------</span></span><br><span class="line"><span class="comment">姓名:员工G 工资:12290</span></span><br><span class="line"><span class="comment">姓名:员工H 工资:15171</span></span><br><span class="line"><span class="comment">姓名:员工I 工资:13026</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></tbody></table></figure></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h3 id=&quot;员工分类案例&quot;&gt;&lt;a href=&quot;#员工分类案例&quot; class=&quot;headerlink&quot; title=&quot;员工分类案例&quot;&gt;&lt;/a&gt;员工分类案例&lt;/h3&gt;
    
    </summary>
    
    
      <category term="c++" scheme="http://philxling.club/categories/c/"/>
    
    
      <category term="c++" scheme="http://philxling.club/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>动态网页爬虫</title>
    <link href="http://philxling.club/2020/04/17/python%E7%88%AC%E8%99%AB/14-%E5%8A%A8%E6%80%81%E7%BD%91%E9%A1%B5%E7%88%AC%E8%99%AB/"/>
    <id>http://philxling.club/2020/04/17/python%E7%88%AC%E8%99%AB/14-%E5%8A%A8%E6%80%81%E7%BD%91%E9%A1%B5%E7%88%AC%E8%99%AB/</id>
    <published>2020-04-17T15:23:12.000Z</published>
    <updated>2020-10-15T04:26:41.926Z</updated>
    
    <content type="html"><![CDATA[<html><head></head><body><h1 id="动态网页爬虫"><a href="#动态网页爬虫" class="headerlink" title="动态网页爬虫"></a>动态网页爬虫</h1><h2 id="什么是AJAX："><a href="#什么是AJAX：" class="headerlink" title="什么是AJAX："></a>什么是AJAX：</h2><p>AJAX（Asynchronouse JavaScript And XML）异步JavaScript和XML。过在后台与服务器进行少量数据交换，Ajax 可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。传统的网页（不使用Ajax）如果需要更新内容，必须重载整个网页页面。<a id="more"></a>因为传统的在传输数据格式方面，使用的是<code>XML</code>语法。因此叫做<code>AJAX</code>，其实现在数据交互基本上都是使用<code>JSON</code>。使用AJAX加载的数据，即使使用了JS，将数据渲染到了浏览器中，在<code>右键->查看网页源代码</code>还是不能看到通过ajax加载的数据，只能看到使用这个url加载的html代码。</p><h2 id="获取ajax数据的方式："><a href="#获取ajax数据的方式：" class="headerlink" title="获取ajax数据的方式："></a>获取ajax数据的方式：</h2><ol><li>直接分析ajax调用的接口。然后通过代码请求这个接口。</li><li>使用Selenium+chromedriver模拟浏览器行为获取数据。</li></ol><table><thead><tr><th>方式</th><th>优点</th><th>缺点</th></tr></thead><tbody><tr><td>分析接口</td><td>直接可以请求到数据。不需要做一些解析工作。代码量少，性能高。</td><td>分析接口比较复杂，特别是一些通过js混淆的接口，要有一定的js功底。容易被发现是爬虫。</td></tr><tr><td>selenium</td><td>直接模拟浏览器的行为。浏览器能请求到的，使用selenium也能请求到。爬虫更稳定。</td><td>代码量多。性能低。</td></tr></tbody></table><h2 id="Selenium-chromedriver获取动态数据："><a href="#Selenium-chromedriver获取动态数据：" class="headerlink" title="Selenium+chromedriver获取动态数据："></a>Selenium+chromedriver获取动态数据：</h2><p><code>Selenium</code>相当于是一个机器人。可以模拟人类在浏览器上的一些行为，自动处理浏览器上的一些行为，比如点击，填充数据，删除cookie等。<code>chromedriver</code>是一个驱动<code>Chrome</code>浏览器的驱动程序，使用他才可以驱动浏览器。当然针对不同的浏览器有不同的driver。以下列出了不同浏览器及其对应的driver：</p><ol><li>Chrome：<a href="https://sites.google.com/a/chromium.org/chromedriver/downloads" target="_blank" rel="noopener">https://sites.google.com/a/chromium.org/chromedriver/downloads</a></li><li>Firefox：<a href="https://github.com/mozilla/geckodriver/releases" target="_blank" rel="noopener">https://github.com/mozilla/geckodriver/releases</a></li><li>Edge：<a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/" target="_blank" rel="noopener">https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/</a></li><li>Safari：<a href="https://webkit.org/blog/6900/webdriver-support-in-safari-10/" target="_blank" rel="noopener">https://webkit.org/blog/6900/webdriver-support-in-safari-10/</a></li></ol><h2 id="安装Selenium和chromedriver："><a href="#安装Selenium和chromedriver：" class="headerlink" title="安装Selenium和chromedriver："></a>安装Selenium和chromedriver：</h2><ol><li><p>安装</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Selenium</span><br></pre></td></tr></tbody></table></figure><p>：</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Selenium</span><br></pre></td></tr></tbody></table></figure><p>有很多语言的版本，有java、ruby、python等。我们下载python版本的就可以了。</p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install selenium</span><br></pre></td></tr></tbody></table></figure></li><li><p>安装<code>chromedriver</code>：下载完成后，放到不需要权限的纯英文目录下就可以了。</p></li></ol><h3 id="快速入门："><a href="#快速入门：" class="headerlink" title="快速入门："></a>快速入门：</h3><p>现在以一个简单的获取百度首页的例子来讲下<code>Selenium</code>和<code>chromedriver</code>如何快速入门：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line"><span class="comment"># chromedriver的绝对路径</span></span><br><span class="line">driver_path = <span class="string">r'D:\ProgramApp\chromedriver\chromedriver.exe'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化一个driver，并且指定chromedriver的路径</span></span><br><span class="line">driver = webdriver.Chrome(executable_path=driver_path)</span><br><span class="line"><span class="comment"># 请求网页</span></span><br><span class="line">driver.get(<span class="string">"https://www.baidu.com/"</span>)</span><br><span class="line"><span class="comment"># 通过page_source获取网页源代码</span></span><br><span class="line">print(driver.page_source)</span><br></pre></td></tr></tbody></table></figure><h3 id="selenium常用操作："><a href="#selenium常用操作：" class="headerlink" title="selenium常用操作："></a>selenium常用操作：</h3><p>更多教程请参考：<a href="http://selenium-python.readthedocs.io/installation.html#introduction" target="_blank" rel="noopener">http://selenium-python.readthedocs.io/installation.html#introduction</a></p><h4 id="关闭页面："><a href="#关闭页面：" class="headerlink" title="关闭页面："></a>关闭页面：</h4><ol><li><code>driver.close()</code>：关闭当前页面。</li><li><code>driver.quit()</code>：退出整个浏览器。</li></ol><h4 id="定位元素："><a href="#定位元素：" class="headerlink" title="定位元素："></a>定位元素：</h4><ol><li><pre><code>find_element_by_id<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">：根据id来查找某个元素。等价于：</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"> submitTag = driver.find_element_by_id('su')</span><br><span class="line"> submitTag1 = driver.find_element(By.ID,'su')</span><br></pre></td></tr></tbody></table></figure></code></pre></li><li><pre><code>find_element_by_class_name<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">：根据类名查找元素。 等价于：</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"> submitTag = driver.find_element_by_class_name('su')</span><br><span class="line"> submitTag1 = driver.find_element(By.CLASS_NAME,'su')</span><br></pre></td></tr></tbody></table></figure></code></pre></li><li><pre><code>find_element_by_name<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">：根据name属性的值来查找元素。等价于：</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"> submitTag = driver.find_element_by_name('email')</span><br><span class="line"> submitTag1 = driver.find_element(By.NAME,'email')</span><br></pre></td></tr></tbody></table></figure></code></pre></li><li><pre><code>find_element_by_tag_name<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">：根据标签名来查找元素。等价于：</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"> submitTag = driver.find_element_by_tag_name('div')</span><br><span class="line"> submitTag1 = driver.find_element(By.TAG_NAME,'div')</span><br></pre></td></tr></tbody></table></figure></code></pre></li><li><pre><code>find_element_by_xpath<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">：根据xpath语法来获取元素。等价于：</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line"> submitTag = driver.find_element_by_xpath('//div')</span><br><span class="line"> submitTag1 = driver.find_element(By.XPATH,'//div')</span><br></pre></td></tr></tbody></table></figure></code></pre></li><li><p><code>find_element_by_css_selector</code>：根据css选择器选择元素。等价于：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">submitTag = driver.find_element_by_css_selector(<span class="string">'//div'</span>)</span><br><span class="line">submitTag1 = driver.find_element(By.CSS_SELECTOR,<span class="string">'//div'</span>)</span><br></pre></td></tr></tbody></table></figure><p>要注意，<code>find_element</code>是获取第一个满足条件的元素。<code>find_elements</code>是获取所有满足条件的元素。</p></li></ol><h4 id="操作表单元素："><a href="#操作表单元素：" class="headerlink" title="操作表单元素："></a>操作表单元素：</h4><ol><li><p>操作输入框：分为两步。第一步：找到这个元素。第二步：使用<code>send_keys(value)</code>，将数据填充进去。示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inputTag = driver.find_element_by_id(<span class="string">'kw'</span>)</span><br><span class="line">inputTag.send_keys(<span class="string">'python'</span>)</span><br></pre></td></tr></tbody></table></figure><p>使用<code>clear</code>方法可以清除输入框中的内容。示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">inputTag.clear()</span><br></pre></td></tr></tbody></table></figure></li><li><p>操作checkbox：因为要选中<code>checkbox</code>标签，在网页中是通过鼠标点击的。因此想要选中<code>checkbox</code>标签，那么先选中这个标签，然后执行<code>click</code>事件。示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rememberTag = driver.find_element_by_name(<span class="string">"rememberMe"</span>)</span><br><span class="line">rememberTag.click()</span><br></pre></td></tr></tbody></table></figure></li><li><p>选择select：select元素不能直接点击。因为点击后还需要选中元素。这时候selenium就专门为select标签提供了一个类<code>selenium.webdriver.support.ui.Select</code>。将获取到的元素当成参数传到这个类中，创建这个对象。以后就可以使用这个对象进行选择了。示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> Select</span><br><span class="line"><span class="comment"># 选中这个标签，然后使用Select创建对象</span></span><br><span class="line">selectTag = Select(driver.find_element_by_name(<span class="string">"jumpMenu"</span>))</span><br><span class="line"><span class="comment"># 根据索引选择</span></span><br><span class="line">selectTag.select_by_index(<span class="number">1</span>)</span><br><span class="line"><span class="comment"># 根据值选择</span></span><br><span class="line">selectTag.select_by_value(<span class="string">"http://www.95yueba.com"</span>)</span><br><span class="line"><span class="comment"># 根据可视的文本选择</span></span><br><span class="line">selectTag.select_by_visible_text(<span class="string">"95秀客户端"</span>)</span><br><span class="line"><span class="comment"># 取消选中所有选项</span></span><br><span class="line">selectTag.deselect_all()</span><br></pre></td></tr></tbody></table></figure></li><li><p>操作按钮：操作按钮有很多种方式。比如单击、右击、双击等。这里讲一个最常用的。就是点击。直接调用<code>click</code>函数就可以了。示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inputTag = driver.find_element_by_id(<span class="string">'su'</span>)</span><br><span class="line">inputTag.click()</span><br></pre></td></tr></tbody></table></figure></li></ol><h4 id="行为链："><a href="#行为链：" class="headerlink" title="行为链："></a>行为链：</h4><p>有时候在页面中的操作可能要有很多步，那么这时候可以使用鼠标行为链类<code>ActionChains</code>来完成。比如现在要将鼠标移动到某个元素上并执行点击事件。那么示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">inputTag = driver.find_element_by_id(<span class="string">'kw'</span>)</span><br><span class="line">submitTag = driver.find_element_by_id(<span class="string">'su'</span>)</span><br><span class="line"></span><br><span class="line">actions = ActionChains(driver)</span><br><span class="line">actions.move_to_element(inputTag)</span><br><span class="line">actions.send_keys_to_element(inputTag,<span class="string">'python'</span>)</span><br><span class="line">actions.move_to_element(submitTag)</span><br><span class="line">actions.click(submitTag)</span><br><span class="line">actions.perform()</span><br></pre></td></tr></tbody></table></figure><p>还有更多的鼠标相关的操作。</p><ul><li>click_and_hold(element)：点击但不松开鼠标。</li><li>context_click(element)：右键点击。</li><li>double_click(element)：双击。 更多方法请参考：<a href="http://selenium-python.readthedocs.io/api.html" target="_blank" rel="noopener">http://selenium-python.readthedocs.io/api.html</a></li></ul><h4 id="Cookie操作："><a href="#Cookie操作：" class="headerlink" title="Cookie操作："></a>Cookie操作：</h4><ol><li><p>获取所有的</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cookie</span><br></pre></td></tr></tbody></table></figure><p>：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> cookie <span class="keyword">in</span> driver.get_cookies():</span><br><span class="line">    print(cookie)</span><br></pre></td></tr></tbody></table></figure></li><li><p>根据cookie的key获取value：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value = driver.get_cookie(key)</span><br></pre></td></tr></tbody></table></figure></li><li><p>删除所有的cookie：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.delete_all_cookies()</span><br></pre></td></tr></tbody></table></figure></li><li><p>删除某个</p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cookie</span><br></pre></td></tr></tbody></table></figure><p>：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">driver.delete_cookie(key)</span><br></pre></td></tr></tbody></table></figure></li></ol><h4 id="页面等待："><a href="#页面等待：" class="headerlink" title="页面等待："></a>页面等待：</h4><p>现在的网页越来越多采用了 Ajax 技术，这样程序便不能确定何时某个元素完全加载出来了。如果实际页面等待时间过长导致某个dom元素还没出来，但是你的代码直接使用了这个WebElement，那么就会抛出NullPointer的异常。为了解决这个问题。所以 Selenium 提供了两种等待方式：一种是隐式等待、一种是显式等待。</p><ol><li><p>隐式等待：调用<code>driver.implicitly_wait</code>。那么在获取不可用的元素之前，会先等待10秒中的时间。示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">driver = webdriver.Chrome(executable_path=driver_path)</span><br><span class="line">driver.implicitly_wait(<span class="number">10</span>)</span><br><span class="line"><span class="comment"># 请求网页</span></span><br><span class="line">driver.get(<span class="string">"https://www.douban.com/"</span>)</span><br></pre></td></tr></tbody></table></figure></li><li><p>显示等待：显示等待是表明某个条件成立后才执行获取元素的操作。也可以在等待的时候指定一个最大的时间，如果超过这个时间那么就抛出一个异常。显示等待应该使用<code>selenium.webdriver.support.excepted_conditions</code>期望的条件和<code>selenium.webdriver.support.ui.WebDriverWait</code>来配合完成。示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> WebDriverWait</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support <span class="keyword">import</span> expected_conditions <span class="keyword">as</span> EC</span><br><span class="line">   </span><br><span class="line">driver = webdriver.Firefox()</span><br><span class="line">driver.get(<span class="string">"http://somedomain/url_that_delays_loading"</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    element = WebDriverWait(driver, <span class="number">10</span>).until(</span><br><span class="line">        EC.presence_of_element_located((By.ID, <span class="string">"myDynamicElement"</span>))</span><br><span class="line">    )</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    driver.quit()</span><br></pre></td></tr></tbody></table></figure></li><li><p>一些其他的等待条件：</p><ul><li><p>presence_of_element_located：某个元素已经加载完毕了。</p></li><li><p>presence_of_all_emement_located：网页中所有满足条件的元素都加载完毕了。</p></li><li><p>element_to_be_cliable：某个元素是可以点击了。</p><p>更多条件请参考：<a href="http://selenium-python.readthedocs.io/waits.html" target="_blank" rel="noopener">http://selenium-python.readthedocs.io/waits.html</a></p></li></ul></li></ol><h4 id="切换页面："><a href="#切换页面：" class="headerlink" title="切换页面："></a>切换页面：</h4><p>有时候窗口中有很多子tab页面。这时候肯定是需要进行切换的。<code>selenium</code>提供了一个叫做<code>switch_to_window</code>来进行切换，具体切换到哪个页面，可以从<code>driver.window_handles</code>中找到。示例代码如下：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 打开一个新的页面</span></span><br><span class="line">self.driver.execute_script(<span class="string">"window.open('"</span>+url+<span class="string">"')"</span>)</span><br><span class="line"><span class="comment"># 切换到这个新的页面中</span></span><br><span class="line">self.driver.switch_to_window(self.driver.window_handles[<span class="number">1</span>])</span><br></pre></td></tr></tbody></table></figure><h4 id="设置代理ip："><a href="#设置代理ip：" class="headerlink" title="设置代理ip："></a>设置代理ip：</h4><p>有时候频繁爬取一些网页。服务器发现你是爬虫后会封掉你的ip地址。这时候我们可以更改代理ip。更改代理ip，不同的浏览器有不同的实现方式。这里以<code>Chrome</code>浏览器为例来讲解：</p><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">options = webdriver.ChromeOptions()</span><br><span class="line">options.add_argument(<span class="string">"--proxy-server=http://110.73.2.248:8123"</span>)</span><br><span class="line">driver_path = <span class="string">r"D:\ProgramApp\chromedriver\chromedriver.exe"</span></span><br><span class="line">driver = webdriver.Chrome(executable_path=driver_path,chrome_options=options)</span><br><span class="line"></span><br><span class="line">driver.get(<span class="string">'http://httpbin.org/ip'</span>)</span><br></pre></td></tr></tbody></table></figure><h4 id="WebElement元素："><a href="#WebElement元素：" class="headerlink" title="WebElement元素："></a><code>WebElement</code>元素：</h4><p><code>from selenium.webdriver.remote.webelement import WebElement</code>类是每个获取出来的元素的所属类。<br>有一些常用的属性：</p><ol><li>get_attribute：这个标签的某个属性的值。</li><li>screentshot：获取当前页面的截图。这个方法只能在<code>driver</code>上使用。<br><code>driver</code>的对象类，也是继承自<code>WebElement</code>。<br>更多请阅读相关源代码。</li></ol></body></html>]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;动态网页爬虫&quot;&gt;&lt;a href=&quot;#动态网页爬虫&quot; class=&quot;headerlink&quot; title=&quot;动态网页爬虫&quot;&gt;&lt;/a&gt;动态网页爬虫&lt;/h1&gt;&lt;h2 id=&quot;什么是AJAX：&quot;&gt;&lt;a href=&quot;#什么是AJAX：&quot; class=&quot;headerlink&quot; title=&quot;什么是AJAX：&quot;&gt;&lt;/a&gt;什么是AJAX：&lt;/h2&gt;&lt;p&gt;AJAX（Asynchronouse JavaScript And XML）异步JavaScript和XML。过在后台与服务器进行少量数据交换，Ajax 可以使网页实现异步更新。这意味着可以在不重新加载整个网页的情况下，对网页的某部分进行更新。传统的网页（不使用Ajax）如果需要更新内容，必须重载整个网页页面。&lt;/p&gt;
    
    </summary>
    
    
      <category term="python爬虫" scheme="http://philxling.club/categories/python%E7%88%AC%E8%99%AB/"/>
    
    
      <category term="python" scheme="http://philxling.club/tags/python/"/>
    
      <category term="python爬虫" scheme="http://philxling.club/tags/python%E7%88%AC%E8%99%AB/"/>
    
  </entry>
  
</feed>
